"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_codesandbox_sandpack-client_dist_clients_node_index_mjs"],{

/***/ "(app-pages-browser)/./node_modules/@codesandbox/nodebox/build/index.mjs":
/*!***********************************************************!*\
  !*** ./node_modules/@codesandbox/nodebox/build/index.mjs ***!
  \***********************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   INJECT_MESSAGE_TYPE: function() { return /* binding */ INJECT_MESSAGE_TYPE; },\n/* harmony export */   MessageReceiver: function() { return /* binding */ MessageReceiver; },\n/* harmony export */   MessageSender: function() { return /* binding */ MessageSender; },\n/* harmony export */   Nodebox: function() { return /* binding */ Nodebox; },\n/* harmony export */   PREVIEW_LOADED_MESSAGE_TYPE: function() { return /* binding */ PREVIEW_LOADED_MESSAGE_TYPE; }\n/* harmony export */ });\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(\n  isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", { value: mod, enumerable: true }) : target,\n  mod\n));\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nvar __accessCheck = (obj, member, msg) => {\n  if (!member.has(obj))\n    throw TypeError(\"Cannot \" + msg);\n};\nvar __privateGet = (obj, member, getter) => {\n  __accessCheck(obj, member, \"read from private field\");\n  return getter ? getter.call(obj) : member.get(obj);\n};\nvar __privateAdd = (obj, member, value) => {\n  if (member.has(obj))\n    throw TypeError(\"Cannot add the same private member more than once\");\n  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n};\nvar __privateSet = (obj, member, value, setter) => {\n  __accessCheck(obj, member, \"write to private field\");\n  setter ? setter.call(obj, value) : member.set(obj, value);\n  return value;\n};\nvar __privateMethod = (obj, member, method) => {\n  __accessCheck(obj, member, \"access private method\");\n  return method;\n};\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js\nvar require_pad = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js\"(exports, module) {\n    module.exports = function pad(num, size) {\n      var s = \"000000000\" + num;\n      return s.substr(s.length - size);\n    };\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js\nvar require_fingerprint_browser = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js\"(exports, module) {\n    var pad = require_pad();\n    var env = typeof window === \"object\" ? window : self;\n    var globalCount = Object.keys(env).length;\n    var mimeTypesLength = navigator.mimeTypes ? navigator.mimeTypes.length : 0;\n    var clientId = pad((mimeTypesLength + navigator.userAgent.length).toString(36) + globalCount.toString(36), 4);\n    module.exports = function fingerprint() {\n      return clientId;\n    };\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js\nvar require_getRandomValue_browser = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js\"(exports, module) {\n    var getRandomValue;\n    var crypto = typeof window !== \"undefined\" && (window.crypto || window.msCrypto) || typeof self !== \"undefined\" && self.crypto;\n    if (crypto) {\n      lim = Math.pow(2, 32) - 1;\n      getRandomValue = function() {\n        return Math.abs(crypto.getRandomValues(new Uint32Array(1))[0] / lim);\n      };\n    } else {\n      getRandomValue = Math.random;\n    }\n    var lim;\n    module.exports = getRandomValue;\n  }\n});\n\n// ../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js\nvar require_cuid = __commonJS({\n  \"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js\"(exports, module) {\n    var fingerprint = require_fingerprint_browser();\n    var pad = require_pad();\n    var getRandomValue = require_getRandomValue_browser();\n    var c = 0;\n    var blockSize = 4;\n    var base = 36;\n    var discreteValues = Math.pow(base, blockSize);\n    function randomBlock() {\n      return pad((getRandomValue() * discreteValues << 0).toString(base), blockSize);\n    }\n    function safeCounter() {\n      c = c < discreteValues ? c : 0;\n      c++;\n      return c - 1;\n    }\n    function cuid3() {\n      var letter = \"c\", timestamp = new Date().getTime().toString(base), counter = pad(safeCounter().toString(base), blockSize), print = fingerprint(), random = randomBlock() + randomBlock();\n      return letter + timestamp + counter + print + random;\n    }\n    cuid3.slug = function slug() {\n      var date = new Date().getTime().toString(36), counter = safeCounter().toString(36).slice(-4), print = fingerprint().slice(0, 1) + fingerprint().slice(-1), random = randomBlock().slice(-2);\n      return date.slice(-2) + counter + print + random;\n    };\n    cuid3.isCuid = function isCuid(stringToCheck) {\n      if (typeof stringToCheck !== \"string\")\n        return false;\n      if (stringToCheck.startsWith(\"c\"))\n        return true;\n      return false;\n    };\n    cuid3.isSlug = function isSlug(stringToCheck) {\n      if (typeof stringToCheck !== \"string\")\n        return false;\n      var stringLength = stringToCheck.length;\n      if (stringLength >= 7 && stringLength <= 10)\n        return true;\n      return false;\n    };\n    cuid3.fingerprint = fingerprint;\n    module.exports = cuid3;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js\nvar require_createDeferredExecutor = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.createDeferredExecutor = void 0;\n    function createDeferredExecutor() {\n      const executor = (resolve, reject) => {\n        executor.state = \"pending\";\n        executor.resolve = (data) => {\n          if (executor.state !== \"pending\") {\n            return;\n          }\n          executor.result = data;\n          const onFulfilled = (value) => {\n            executor.state = \"fulfilled\";\n            return value;\n          };\n          return resolve(data instanceof Promise ? data : Promise.resolve(data).then(onFulfilled));\n        };\n        executor.reject = (reason) => {\n          if (executor.state !== \"pending\") {\n            return;\n          }\n          queueMicrotask(() => {\n            executor.state = \"rejected\";\n          });\n          return reject(executor.rejectionReason = reason);\n        };\n      };\n      return executor;\n    }\n    exports.createDeferredExecutor = createDeferredExecutor;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js\nvar require_DeferredPromise = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.DeferredPromise = void 0;\n    var createDeferredExecutor_1 = require_createDeferredExecutor();\n    var DeferredPromise4 = class extends Promise {\n      #executor;\n      resolve;\n      reject;\n      constructor(executor = null) {\n        const deferredExecutor = (0, createDeferredExecutor_1.createDeferredExecutor)();\n        super((originalResolve, originalReject) => {\n          deferredExecutor(originalResolve, originalReject);\n          executor?.(deferredExecutor.resolve, deferredExecutor.reject);\n        });\n        this.#executor = deferredExecutor;\n        this.resolve = this.#executor.resolve;\n        this.reject = this.#executor.reject;\n      }\n      get state() {\n        return this.#executor.state;\n      }\n      get rejectionReason() {\n        return this.#executor.rejectionReason;\n      }\n      then(onFulfilled, onRejected) {\n        return this.#decorate(super.then(onFulfilled, onRejected));\n      }\n      catch(onRejected) {\n        return this.#decorate(super.catch(onRejected));\n      }\n      finally(onfinally) {\n        return this.#decorate(super.finally(onfinally));\n      }\n      #decorate(promise) {\n        return Object.defineProperties(promise, {\n          resolve: { configurable: true, value: this.resolve },\n          reject: { configurable: true, value: this.reject }\n        });\n      }\n    };\n    exports.DeferredPromise = DeferredPromise4;\n  }\n});\n\n// ../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js\nvar require_build = __commonJS({\n  \"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js\"(exports) {\n    \"use strict\";\n    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      var desc = Object.getOwnPropertyDescriptor(m, k);\n      if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n        desc = { enumerable: true, get: function() {\n          return m[k];\n        } };\n      }\n      Object.defineProperty(o, k2, desc);\n    } : function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      o[k2] = m[k];\n    });\n    var __exportStar = exports && exports.__exportStar || function(m, exports2) {\n      for (var p in m)\n        if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports2, p))\n          __createBinding(exports2, m, p);\n    };\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    __exportStar(require_createDeferredExecutor(), exports);\n    __exportStar(require_DeferredPromise(), exports);\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js\nvar require_MemoryLeakError = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.MemoryLeakError = void 0;\n    var MemoryLeakError = class extends Error {\n      emitter;\n      type;\n      count;\n      constructor(emitter, type, count) {\n        super(`Possible EventEmitter memory leak detected. ${count} ${type.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`);\n        this.emitter = emitter;\n        this.type = type;\n        this.count = count;\n        this.name = \"MaxListenersExceededWarning\";\n      }\n    };\n    exports.MemoryLeakError = MemoryLeakError;\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js\nvar require_Emitter = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js\"(exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.Emitter = void 0;\n    var MemoryLeakError_1 = require_MemoryLeakError();\n    var _events, _maxListeners, _hasWarnedAboutPotentialMemortyLeak, _getListeners, getListeners_fn, _removeListener, removeListener_fn, _wrapOnceListener, wrapOnceListener_fn, _internalEmit, internalEmit_fn;\n    var _Emitter = class {\n      constructor() {\n        __privateAdd(this, _getListeners);\n        __privateAdd(this, _removeListener);\n        __privateAdd(this, _wrapOnceListener);\n        __privateAdd(this, _internalEmit);\n        __privateAdd(this, _events, void 0);\n        __privateAdd(this, _maxListeners, void 0);\n        __privateAdd(this, _hasWarnedAboutPotentialMemortyLeak, void 0);\n        __privateSet(this, _events, /* @__PURE__ */ new Map());\n        __privateSet(this, _maxListeners, _Emitter.defaultMaxListeners);\n        __privateSet(this, _hasWarnedAboutPotentialMemortyLeak, false);\n      }\n      static listenerCount(emitter, eventName) {\n        return emitter.listenerCount(eventName);\n      }\n      setMaxListeners(maxListeners) {\n        __privateSet(this, _maxListeners, maxListeners);\n        return this;\n      }\n      getMaxListeners() {\n        return __privateGet(this, _maxListeners);\n      }\n      eventNames() {\n        return Array.from(__privateGet(this, _events).keys());\n      }\n      emit(eventName, ...data) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        listeners.forEach((listener) => {\n          listener.apply(this, data);\n        });\n        return listeners.length > 0;\n      }\n      addListener(eventName, listener) {\n        __privateMethod(this, _internalEmit, internalEmit_fn).call(this, \"newListener\", eventName, listener);\n        const nextListeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName).concat(listener);\n        __privateGet(this, _events).set(eventName, nextListeners);\n        if (__privateGet(this, _maxListeners) > 0 && this.listenerCount(eventName) > __privateGet(this, _maxListeners) && !__privateGet(this, _hasWarnedAboutPotentialMemortyLeak)) {\n          __privateSet(this, _hasWarnedAboutPotentialMemortyLeak, true);\n          const memoryLeakWarning = new MemoryLeakError_1.MemoryLeakError(this, eventName, this.listenerCount(eventName));\n          console.warn(memoryLeakWarning);\n        }\n        return this;\n      }\n      on(eventName, listener) {\n        return this.addListener(eventName, listener);\n      }\n      once(eventName, listener) {\n        return this.addListener(eventName, __privateMethod(this, _wrapOnceListener, wrapOnceListener_fn).call(this, eventName, listener));\n      }\n      prependListener(eventName, listener) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        if (listeners.length > 0) {\n          const nextListeners = [listener].concat(listeners);\n          __privateGet(this, _events).set(eventName, nextListeners);\n        } else {\n          __privateGet(this, _events).set(eventName, listeners.concat(listener));\n        }\n        return this;\n      }\n      prependOnceListener(eventName, listener) {\n        return this.prependListener(eventName, __privateMethod(this, _wrapOnceListener, wrapOnceListener_fn).call(this, eventName, listener));\n      }\n      removeListener(eventName, listener) {\n        const listeners = __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName);\n        if (listeners.length > 0) {\n          __privateMethod(this, _removeListener, removeListener_fn).call(this, listeners, listener);\n          __privateGet(this, _events).set(eventName, listeners);\n          __privateMethod(this, _internalEmit, internalEmit_fn).call(this, \"removeListener\", eventName, listener);\n        }\n        return this;\n      }\n      off(eventName, listener) {\n        return this.removeListener(eventName, listener);\n      }\n      removeAllListeners(eventName) {\n        if (eventName) {\n          __privateGet(this, _events).delete(eventName);\n        } else {\n          __privateGet(this, _events).clear();\n        }\n        return this;\n      }\n      listeners(eventName) {\n        return Array.from(__privateMethod(this, _getListeners, getListeners_fn).call(this, eventName));\n      }\n      listenerCount(eventName) {\n        return __privateMethod(this, _getListeners, getListeners_fn).call(this, eventName).length;\n      }\n      rawListeners(eventName) {\n        return this.listeners(eventName);\n      }\n    };\n    var Emitter2 = _Emitter;\n    _events = new WeakMap();\n    _maxListeners = new WeakMap();\n    _hasWarnedAboutPotentialMemortyLeak = new WeakMap();\n    _getListeners = new WeakSet();\n    getListeners_fn = function(eventName) {\n      return __privateGet(this, _events).get(eventName) || [];\n    };\n    _removeListener = new WeakSet();\n    removeListener_fn = function(listeners, listener) {\n      const index = listeners.indexOf(listener);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n      return [];\n    };\n    _wrapOnceListener = new WeakSet();\n    wrapOnceListener_fn = function(eventName, listener) {\n      const onceListener = (...data) => {\n        this.removeListener(eventName, onceListener);\n        listener.apply(this, data);\n      };\n      return onceListener;\n    };\n    _internalEmit = new WeakSet();\n    internalEmit_fn = function(internalEventName, eventName, listener) {\n      this.emit(\n        internalEventName,\n        ...[eventName, listener]\n      );\n    };\n    __publicField(Emitter2, \"defaultMaxListeners\", 10);\n    exports.Emitter = Emitter2;\n  }\n});\n\n// ../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js\nvar require_lib = __commonJS({\n  \"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js\"(exports) {\n    \"use strict\";\n    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      var desc = Object.getOwnPropertyDescriptor(m, k);\n      if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n        desc = { enumerable: true, get: function() {\n          return m[k];\n        } };\n      }\n      Object.defineProperty(o, k2, desc);\n    } : function(o, m, k, k2) {\n      if (k2 === void 0)\n        k2 = k;\n      o[k2] = m[k];\n    });\n    var __exportStar = exports && exports.__exportStar || function(m, exports2) {\n      for (var p in m)\n        if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports2, p))\n          __createBinding(exports2, m, p);\n    };\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    __exportStar(require_Emitter(), exports);\n    __exportStar(require_MemoryLeakError(), exports);\n  }\n});\n\n// src/messages.ts\nvar import_cuid = __toESM(require_cuid());\n\n// ../../node_modules/.pnpm/outvariant@1.4.0/node_modules/outvariant/lib/index.mjs\nvar POSITIONALS_EXP = /(%?)(%([sdjo]))/g;\nfunction serializePositional(positional, flag) {\n  switch (flag) {\n    case \"s\":\n      return positional;\n    case \"d\":\n    case \"i\":\n      return Number(positional);\n    case \"j\":\n      return JSON.stringify(positional);\n    case \"o\": {\n      if (typeof positional === \"string\") {\n        return positional;\n      }\n      const json = JSON.stringify(positional);\n      if (json === \"{}\" || json === \"[]\" || /^\\[object .+?\\]$/.test(json)) {\n        return positional;\n      }\n      return json;\n    }\n  }\n}\nfunction format(message, ...positionals) {\n  if (positionals.length === 0) {\n    return message;\n  }\n  let positionalIndex = 0;\n  let formattedMessage = message.replace(\n    POSITIONALS_EXP,\n    (match, isEscaped, _, flag) => {\n      const positional = positionals[positionalIndex];\n      const value = serializePositional(positional, flag);\n      if (!isEscaped) {\n        positionalIndex++;\n        return value;\n      }\n      return match;\n    }\n  );\n  if (positionalIndex < positionals.length) {\n    formattedMessage += ` ${positionals.slice(positionalIndex).join(\" \")}`;\n  }\n  formattedMessage = formattedMessage.replace(/%{2,2}/g, \"%\");\n  return formattedMessage;\n}\nvar STACK_FRAMES_TO_IGNORE = 2;\nfunction cleanErrorStack(error) {\n  if (!error.stack) {\n    return;\n  }\n  const nextStack = error.stack.split(\"\\n\");\n  nextStack.splice(1, STACK_FRAMES_TO_IGNORE);\n  error.stack = nextStack.join(\"\\n\");\n}\nvar InvariantError = class extends Error {\n  constructor(message, ...positionals) {\n    super(message);\n    this.message = message;\n    this.name = \"Invariant Violation\";\n    this.message = format(message, ...positionals);\n    cleanErrorStack(this);\n  }\n};\nvar invariant = (predicate, message, ...positionals) => {\n  if (!predicate) {\n    throw new InvariantError(message, ...positionals);\n  }\n};\ninvariant.as = (ErrorConstructor, predicate, message, ...positionals) => {\n  if (!predicate) {\n    const isConstructor = ErrorConstructor.prototype.name != null;\n    const error = isConstructor ? new ErrorConstructor(format(message, positionals)) : ErrorConstructor(format(message, positionals));\n    throw error;\n  }\n};\n\n// src/messages.ts\nvar import_deferred_promise = __toESM(require_build());\n\n// src/logger.ts\nvar FLAG = window.localStorage[\"CSB_EMULATOR_DEBUG\"];\nvar DEFAULT = \"\\x1B[0m\";\nvar GREEN = \"\\x1B[32;1m\";\nvar RED = \"\\x1B[31m\";\nvar BLUE = \"\\x1B[34m\";\nvar YELLOW = \"\\x1B[33;1m\";\nvar MAGENTA = \"\\x1B[35;1m\";\nvar CYAN = \"\\x1B[36;1m\";\nvar COLOR_SCOPE = {\n  preview: YELLOW,\n  emulator: MAGENTA,\n  runtime: CYAN,\n  bridge: BLUE,\n  \"runtime:worker\": CYAN\n};\nfunction createDebug(scope) {\n  return function debug3(message, ...data) {\n    if (FLAG === \"true\") {\n      const direction = () => {\n        if (message.includes(\"sender\"))\n          return `${GREEN}sender`;\n        if (message.includes(\"receiver\"))\n          return `${RED}receiver`;\n        return \"\";\n      };\n      const cleanMessage = message.replace(/\\[.+\\]:/, \"\");\n      console.debug(`${COLOR_SCOPE[scope]}${scope}:${direction()}${DEFAULT}:${cleanMessage}`, ...data);\n    }\n  };\n}\n\n// src/messages.ts\nvar debug = createDebug(\"emulator\");\nvar MessageReceiver = class {\n  emitter;\n  senderPort = null;\n  constructor() {\n    this.emitter = new EventTarget();\n    this.waitForHandshake();\n  }\n  waitForHandshake() {\n    const handshakePromise = new import_deferred_promise.DeferredPromise();\n    const handshakeListener = (message) => {\n      const { data } = message;\n      debug(\"[message-receiver]: incoming\", message);\n      if (data.type === \"internal/handshake\") {\n        invariant(\n          message.ports.length > 0,\n          \"Failed to confirm a MessageReceiver handshake: received event has no ports\"\n        );\n        this.senderPort = message.ports[0];\n        this.addMessageListener();\n        debug(\"[message-receiver]: handshake received!\", this.senderPort);\n        this.send(\"internal/handshake/done\");\n        debug(\"[message-receiver]: finish handshake\");\n      }\n    };\n    window.addEventListener(\"message\", handshakeListener);\n    handshakePromise.then(() => {\n      window.removeEventListener(\"message\", handshakeListener);\n    });\n    window.parent.postMessage({ type: \"internal/ready\" }, \"*\");\n    return handshakePromise;\n  }\n  addMessageListener() {\n    invariant(\n      this.senderPort,\n      \"[MessageReceiver] Failed to add a message listener: sender port is not defined. Did you forget to await a handshake?\"\n    );\n    this.senderPort.onmessage = (evt) => {\n      const data = evt.data;\n      if (data.type == null) {\n        return;\n      }\n      this.emitter.dispatchEvent(\n        new MessageEvent(data.type, {\n          data: data.payload\n        })\n      );\n    };\n  }\n  on(event, listener, options) {\n    this.emitter.addEventListener(\n      event,\n      async (message) => {\n        if (!(message instanceof MessageEvent)) {\n          return;\n        }\n        const { operationId, payload } = message.data;\n        try {\n          const listenerPayload = await listener(payload);\n          this.send(\"internal/operation/done\", { operationId, listenerPayload });\n        } catch (error) {\n          if (error instanceof Error) {\n            this.send(\"internal/operation/failed\", { operationId, error });\n          }\n        }\n      },\n      options\n    );\n  }\n  send(event, ...data) {\n    invariant(\n      this.senderPort,\n      '[MessageReceiver] Failed to send a message \"%j\": sender port is not defined. Did you forget to await a handshake?',\n      event\n    );\n    const payload = data[0] || {};\n    debug('[message-receiver]: send \"%s\"', event, payload);\n    this.senderPort.postMessage({ type: event, payload });\n  }\n};\nvar MessageSender = class {\n  constructor(target) {\n    this.target = target;\n    this.emitter = new EventTarget();\n    this.channel = new MessageChannel();\n    this.receiverPort = this.channel.port1;\n    const receiverReadyPromise = new import_deferred_promise.DeferredPromise();\n    const handshakeListener = (message) => {\n      if (message.data.type === \"internal/ready\") {\n        debug(\"[message-sender]: runtime is ready\");\n        receiverReadyPromise.resolve();\n      }\n    };\n    window.addEventListener(\"message\", handshakeListener);\n    receiverReadyPromise.then(() => {\n      window.removeEventListener(\"message\", handshakeListener);\n    });\n    this.receiverReadyPromise = receiverReadyPromise;\n    this.receiverPort.onmessage = (evt) => {\n      const data = evt.data;\n      if (data.type != null) {\n        debug('[message-sender]: emitting \"%s\" event...', data.type, data.payload);\n        this.emitter.dispatchEvent(new MessageEvent(data.type, { data: data.payload }));\n      }\n    };\n  }\n  emitter;\n  channel;\n  receiverPort;\n  receiverReadyPromise;\n  async handshake() {\n    const handshakePromise = new import_deferred_promise.DeferredPromise();\n    await this.receiverReadyPromise;\n    debug(\"[message-sender]: sending handshake\");\n    this.target.postMessage(\n      {\n        type: \"internal/handshake\"\n      },\n      \"*\",\n      [this.channel.port2]\n    );\n    this.on(\"internal/handshake/done\", () => {\n      handshakePromise.resolve();\n      clearTimeout(rejectionTimeout);\n    });\n    const rejectionTimeout = setTimeout(() => {\n      handshakePromise.reject(new Error(\"MessageSender: Handshake timeout\"));\n    }, 5e3);\n    return handshakePromise;\n  }\n  on(event, listener, options) {\n    debug('[message-sender]: add listener \"%s\"', event);\n    this.emitter.addEventListener(\n      event,\n      (message) => {\n        if (message instanceof MessageEvent) {\n          listener(message);\n        }\n      },\n      options\n    );\n  }\n  off(event, listener, options) {\n    this.emitter.removeEventListener(event, listener, options);\n  }\n  async send(event, ...data) {\n    const operationPromise = new import_deferred_promise.DeferredPromise();\n    const operationId = (0, import_cuid.default)();\n    const payload = data[0] || {};\n    debug('[message-sender]: send \"%s\" (%s)', event, operationId, payload);\n    this.receiverPort.postMessage({ type: event, payload: { operationId, payload } });\n    debug('[message-sender]: adding done listener for \"%s\" (%s)', event, operationId);\n    const handleOperationDone = (doneEvent) => {\n      const { data: data2 } = doneEvent;\n      if (data2.operationId === operationId) {\n        const listenerPayload = data2.listenerPayload || {};\n        debug('[message-sender]: resolving \"%s (%s) promise!', event, operationId);\n        operationPromise.resolve({\n          ...listenerPayload,\n          operationId: data2.operationId\n        });\n      }\n    };\n    const handleOperationFailed = (failEvent) => {\n      const { data: data2 } = failEvent;\n      if (data2.operationId === operationId) {\n        debug('[message-sender]: rejecting \"%s (%s) promise!', event, operationId);\n        operationPromise.reject(data2.error);\n      }\n    };\n    this.on(\"internal/operation/done\", handleOperationDone);\n    this.on(\"internal/operation/failed\", handleOperationFailed);\n    return operationPromise.finally(() => {\n      this.emitter.removeEventListener(\"internal/operation/done\", handleOperationDone);\n      this.emitter.removeEventListener(\"internal/operation/failed\", handleOperationFailed);\n    });\n  }\n};\n\n// src/Nodebox.ts\nvar import_deferred_promise3 = __toESM(require_build());\n\n// src/modules/fs.ts\nvar import_cuid2 = __toESM(require_cuid());\nvar FileSystemApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  async init(files) {\n    await this.channel.send(\"fs/init\", { files });\n  }\n  async readFile(path, encoding) {\n    const response = await this.channel.send(\"fs/readFile\", { path, encoding }).catch((error) => {\n      throw new Error(format('Failed to read file at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"File not found\");\n    }\n    return response.data;\n  }\n  async writeFile(path, content, options) {\n    let encoding = void 0;\n    let recursive = false;\n    if (typeof options === \"object\") {\n      encoding = options.encoding;\n      recursive = !!options.recursive;\n    } else if (typeof options === \"string\") {\n      encoding = options;\n    }\n    await this.channel.send(\"fs/writeFile\", { path, content, encoding, recursive }).catch((error) => {\n      throw new Error(format('Failed to write file at path \"%s\"', path), { cause: error });\n    });\n  }\n  async readdir(path) {\n    const response = await this.channel.send(\"fs/readdir\", { path }).catch((error) => {\n      throw new Error(format('Failed to read directory at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"Directory not found\");\n    }\n    return response.data;\n  }\n  async mkdir(path, options) {\n    const recursive = !!options?.recursive;\n    await this.channel.send(\"fs/mkdir\", { path, recursive }).catch((error) => {\n      throw new Error(format('Failed to make directory at path \"%s\"', path), { cause: error });\n    });\n  }\n  async stat(path) {\n    const response = await this.channel.send(\"fs/stat\", { path }).catch((error) => {\n      throw new Error(format('Failed to stat file at path \"%s\"', path), { cause: error });\n    });\n    if (!response) {\n      throw new Error(\"File not found\");\n    }\n    return response.data;\n  }\n  async rm(path, options) {\n    const { force, recursive } = options || {};\n    await this.channel.send(\"fs/rm\", { path, force, recursive }).catch((error) => {\n      throw new Error(format('Failed to remove file at path \"%s\"', path), { cause: error });\n    });\n  }\n  async watch(includes, excludes, listener) {\n    const watcherId = (0, import_cuid2.default)();\n    await this.channel.send(\"fs/watch\", { watcherId, includes, excludes });\n    this.channel.on(\"fs/watch-event\", ({ data }) => {\n      if (data.watcherId === watcherId && listener) {\n        const evt = { ...data };\n        delete evt.watcherId;\n        listener(evt);\n      }\n    });\n    return {\n      dispose: () => this.channel.send(\"fs/unwatch\", { watcherId })\n    };\n  }\n};\n\n// src/modules/shell.ts\nvar import_strict_event_emitter = __toESM(require_lib());\nvar ShellApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  create() {\n    return new ShellProcess(this.channel);\n  }\n};\nvar ShellProcess = class {\n  constructor(channel) {\n    this.channel = channel;\n    this.state = \"running\";\n    this.stdout = new import_strict_event_emitter.Emitter();\n    this.stderr = new import_strict_event_emitter.Emitter();\n    this.stdin = {\n      write: (data) => {\n        if (!this.id) {\n          throw new Error(\"Failed to write to stdin, no process is currently running\");\n        }\n        return this.channel.send(\"shell/stdin\", { data, workerId: this.id });\n      }\n    };\n    this.forwardStdEvents();\n  }\n  id;\n  state;\n  stdout;\n  stderr;\n  stdin;\n  forwardStdEvents() {\n    this.channel.on(\"worker/tty\", (message) => {\n      const { data } = message;\n      if (data.workerId !== this.id) {\n        return;\n      }\n      switch (data.payload.type) {\n        case \"out\": {\n          this.stdout.emit(\"data\", data.payload.data);\n          break;\n        }\n        case \"err\": {\n          this.stderr.emit(\"data\", data.payload.data);\n          break;\n        }\n      }\n    });\n  }\n  async runCommand(command, args, options = {}) {\n    invariant(!this.id, 'Failed to run \"runCommand\" on a ShellProcess: there is already a process running.');\n    const shellInfo = await this.channel.send(\"shell/runCommand\", { command, args, options });\n    invariant(shellInfo, 'Failed to run \"runCommand\" on a ShellProcess: was not able to retrieve a running process.');\n    this.id = shellInfo.id;\n    this.state = \"running\";\n    return shellInfo;\n  }\n  async on(message, listener) {\n    switch (message) {\n      case \"progress\": {\n        this.channel.on(\"worker/progress\", ({ data }) => {\n          listener(data.status);\n        });\n        return;\n      }\n      case \"exit\": {\n        this.channel.on(\"worker/exit\", ({ data }) => {\n          if (data.workerId === this.id) {\n            listener(data.exitCode, data.error);\n          }\n        });\n        return;\n      }\n    }\n  }\n  async kill() {\n    invariant(\n      this.id,\n      'Failed to run \"kill\" on a ShellProcess: there is no process running. Did you forget to run it?'\n    );\n    this.state = \"idle\";\n    await this.channel.send(\"shell/exit\", { id: this.id }).catch((error) => {\n      throw new Error(format('Failed to kill shell with ID \"%s\"', this.id), { cause: error });\n    });\n    this.id = void 0;\n  }\n};\n\n// src/modules/preview.ts\nvar import_deferred_promise2 = __toESM(require_build());\nvar TIMEOUT = 2e4;\nvar PreviewApi = class {\n  constructor(channel) {\n    this.channel = channel;\n  }\n  async waitFor(payload, predicate, timeout = TIMEOUT) {\n    const readyPromise = new import_deferred_promise2.DeferredPromise();\n    const rejectTimeout = setTimeout(() => {\n      readyPromise.reject();\n    }, timeout);\n    const previewInformation = await this.channel.send(\"preview/get/info\", payload).catch((error) => {\n      readyPromise.reject(\n        new Error(\n          format(\n            'Failed to look up preview information for shell ID \"%s\" (port: %d)',\n            payload.sourceShellId,\n            payload.port\n          )\n        )\n      );\n    });\n    const foundPreview = previewInformation && predicate(previewInformation);\n    if (foundPreview) {\n      readyPromise.resolve({\n        url: previewInformation.url,\n        port: previewInformation.port,\n        sourceShellId: previewInformation.sourceShellId\n      });\n    }\n    this.channel.on(\"preview/port/ready\", ({ data }) => {\n      if (!foundPreview && predicate(data)) {\n        readyPromise.resolve({\n          url: data.url,\n          port: data.port,\n          sourceShellId: data.sourceShellId\n        });\n      }\n    });\n    return readyPromise.finally(() => {\n      clearTimeout(rejectTimeout);\n    });\n  }\n  async getByShellId(sourceShellId, timeout) {\n    return this.waitFor({ sourceShellId }, (data) => data.sourceShellId === sourceShellId, timeout).catch((error) => {\n      throw new Error(format('Failed to get shell by ID \"%s\"', sourceShellId), { cause: error });\n    });\n  }\n  async waitForPort(port, timeout) {\n    return this.waitFor({ port }, (data) => data.port === port, timeout).catch((error) => {\n      throw new Error(format(\"Failed to await port %d\", port), { cause: error });\n    });\n  }\n};\n\n// src/Nodebox.ts\nvar DEFAULT_RUNTIME_URL = \"https://nodebox-runtime.codesandbox.io\";\nvar debug2 = createDebug(\"emulator\");\nvar Nodebox = class {\n  constructor(options) {\n    this.options = options;\n    invariant(\n      this.options.iframe,\n      'Failed to create a Nodebox: expected \"iframe\" argument to be a reference to an <iframe> element but got %j',\n      this.options.iframe\n    );\n    this.url = this.options.runtimeUrl || DEFAULT_RUNTIME_URL;\n    this.isConnected = false;\n  }\n  channel = null;\n  isConnected;\n  url;\n  fileSystemApi = null;\n  shellApi = null;\n  previewApi = null;\n  async connect() {\n    const { iframe, cdnUrl } = this.options;\n    debug2(\"[message-sender]: Connecting to node emulator...\");\n    const connectionPromise = new import_deferred_promise3.DeferredPromise();\n    if (!this.url) {\n      connectionPromise.reject(\n        new Error(\"Nodebox URL is missing. Did you forget to provide it when creating this Nodebox instance?\")\n      );\n    }\n    invariant(\n      iframe.contentWindow,\n      \"Failed to create a MessageChannel with the Nodebox iframe: no content window found\"\n    );\n    this.channel = new MessageSender(iframe.contentWindow);\n    const frameLoadPromise = new import_deferred_promise3.DeferredPromise();\n    iframe.setAttribute(\"src\", this.url);\n    iframe.addEventListener(\n      \"load\",\n      () => {\n        frameLoadPromise.resolve();\n      },\n      { once: true }\n    );\n    iframe.addEventListener(\n      \"error\",\n      (event) => {\n        frameLoadPromise.reject(event.error);\n      },\n      { once: true }\n    );\n    await frameLoadPromise;\n    debug2(\"[message-sender]: IFrame loaded...\");\n    await this.channel.handshake();\n    debug2(\"[message-sender]: Handshake completed...\");\n    this.channel.send(\"connect\", {\n      cdnUrl\n    });\n    this.channel.on(\"runtime/ready\", () => {\n      connectionPromise.resolve();\n    });\n    return connectionPromise.then(() => {\n      debug2(\"[message-sender]: Connected to runtime...\");\n      this.isConnected = true;\n    });\n  }\n  get fs() {\n    invariant(\n      this.isConnected,\n      'Failed to access the File System API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.fileSystemApi) {\n      return this.fileSystemApi;\n    }\n    this.fileSystemApi = new FileSystemApi(this.channel);\n    return this.fileSystemApi;\n  }\n  get shell() {\n    invariant(\n      this.isConnected,\n      'Failed to access the Shell API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.shellApi) {\n      return this.shellApi;\n    }\n    this.shellApi = new ShellApi(this.channel);\n    return this.shellApi;\n  }\n  get preview() {\n    invariant(\n      this.isConnected,\n      'Failed to access the Preview API: consumer is not connected. Did you forget to run \"connect()\"?'\n    );\n    if (this.previewApi) {\n      return this.previewApi;\n    }\n    this.previewApi = new PreviewApi(this.channel);\n    return this.previewApi;\n  }\n};\n\n// src/runtime-protocol.types.ts\nvar INJECT_MESSAGE_TYPE = \"INJECT_AND_INVOKE\";\nvar PREVIEW_LOADED_MESSAGE_TYPE = \"PREVIEW_LOADED\";\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvbm9kZWJveC9idWlsZC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RUFBOEUsNkRBQTZEO0FBQzNJO0FBQ0EsMkRBQTJELGFBQWE7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw0RkFBNEY7QUFDekg7QUFDQTtBQUNBO0FBQ0EsbUdBQW1HO0FBQ25HLHlFQUF5RSw4QkFBOEI7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix5Q0FBeUM7QUFDOUQsb0JBQW9CO0FBQ3BCLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGFBQWE7QUFDaEU7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxPQUFPLEVBQUUsaUJBQWlCO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGFBQWE7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxhQUFhO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFD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QUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBT0UiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0Bjb2Rlc2FuZGJveC9ub2RlYm94L2J1aWxkL2luZGV4Lm1qcz9kMGYzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2NyZWF0ZSA9IE9iamVjdC5jcmVhdGU7XG52YXIgX19kZWZQcm9wID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xudmFyIF9fZ2V0T3duUHJvcERlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xudmFyIF9fZ2V0T3duUHJvcE5hbWVzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXM7XG52YXIgX19nZXRQcm90b09mID0gT2JqZWN0LmdldFByb3RvdHlwZU9mO1xudmFyIF9faGFzT3duUHJvcCA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgX19kZWZOb3JtYWxQcm9wID0gKG9iaiwga2V5LCB2YWx1ZSkgPT4ga2V5IGluIG9iaiA/IF9fZGVmUHJvcChvYmosIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZSB9KSA6IG9ialtrZXldID0gdmFsdWU7XG52YXIgX19jb21tb25KUyA9IChjYiwgbW9kKSA9PiBmdW5jdGlvbiBfX3JlcXVpcmUoKSB7XG4gIHJldHVybiBtb2QgfHwgKDAsIGNiW19fZ2V0T3duUHJvcE5hbWVzKGNiKVswXV0pKChtb2QgPSB7IGV4cG9ydHM6IHt9IH0pLmV4cG9ydHMsIG1vZCksIG1vZC5leHBvcnRzO1xufTtcbnZhciBfX2NvcHlQcm9wcyA9ICh0bywgZnJvbSwgZXhjZXB0LCBkZXNjKSA9PiB7XG4gIGlmIChmcm9tICYmIHR5cGVvZiBmcm9tID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBmcm9tID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBmb3IgKGxldCBrZXkgb2YgX19nZXRPd25Qcm9wTmFtZXMoZnJvbSkpXG4gICAgICBpZiAoIV9faGFzT3duUHJvcC5jYWxsKHRvLCBrZXkpICYmIGtleSAhPT0gZXhjZXB0KVxuICAgICAgICBfX2RlZlByb3AodG8sIGtleSwgeyBnZXQ6ICgpID0+IGZyb21ba2V5XSwgZW51bWVyYWJsZTogIShkZXNjID0gX19nZXRPd25Qcm9wRGVzYyhmcm9tLCBrZXkpKSB8fCBkZXNjLmVudW1lcmFibGUgfSk7XG4gIH1cbiAgcmV0dXJuIHRvO1xufTtcbnZhciBfX3RvRVNNID0gKG1vZCwgaXNOb2RlTW9kZSwgdGFyZ2V0KSA9PiAodGFyZ2V0ID0gbW9kICE9IG51bGwgPyBfX2NyZWF0ZShfX2dldFByb3RvT2YobW9kKSkgOiB7fSwgX19jb3B5UHJvcHMoXG4gIGlzTm9kZU1vZGUgfHwgIW1vZCB8fCAhbW9kLl9fZXNNb2R1bGUgPyBfX2RlZlByb3AodGFyZ2V0LCBcImRlZmF1bHRcIiwgeyB2YWx1ZTogbW9kLCBlbnVtZXJhYmxlOiB0cnVlIH0pIDogdGFyZ2V0LFxuICBtb2RcbikpO1xudmFyIF9fcHVibGljRmllbGQgPSAob2JqLCBrZXksIHZhbHVlKSA9PiB7XG4gIF9fZGVmTm9ybWFsUHJvcChvYmosIHR5cGVvZiBrZXkgIT09IFwic3ltYm9sXCIgPyBrZXkgKyBcIlwiIDoga2V5LCB2YWx1ZSk7XG4gIHJldHVybiB2YWx1ZTtcbn07XG52YXIgX19hY2Nlc3NDaGVjayA9IChvYmosIG1lbWJlciwgbXNnKSA9PiB7XG4gIGlmICghbWVtYmVyLmhhcyhvYmopKVxuICAgIHRocm93IFR5cGVFcnJvcihcIkNhbm5vdCBcIiArIG1zZyk7XG59O1xudmFyIF9fcHJpdmF0ZUdldCA9IChvYmosIG1lbWJlciwgZ2V0dGVyKSA9PiB7XG4gIF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwicmVhZCBmcm9tIHByaXZhdGUgZmllbGRcIik7XG4gIHJldHVybiBnZXR0ZXIgPyBnZXR0ZXIuY2FsbChvYmopIDogbWVtYmVyLmdldChvYmopO1xufTtcbnZhciBfX3ByaXZhdGVBZGQgPSAob2JqLCBtZW1iZXIsIHZhbHVlKSA9PiB7XG4gIGlmIChtZW1iZXIuaGFzKG9iaikpXG4gICAgdGhyb3cgVHlwZUVycm9yKFwiQ2Fubm90IGFkZCB0aGUgc2FtZSBwcml2YXRlIG1lbWJlciBtb3JlIHRoYW4gb25jZVwiKTtcbiAgbWVtYmVyIGluc3RhbmNlb2YgV2Vha1NldCA/IG1lbWJlci5hZGQob2JqKSA6IG1lbWJlci5zZXQob2JqLCB2YWx1ZSk7XG59O1xudmFyIF9fcHJpdmF0ZVNldCA9IChvYmosIG1lbWJlciwgdmFsdWUsIHNldHRlcikgPT4ge1xuICBfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcIndyaXRlIHRvIHByaXZhdGUgZmllbGRcIik7XG4gIHNldHRlciA/IHNldHRlci5jYWxsKG9iaiwgdmFsdWUpIDogbWVtYmVyLnNldChvYmosIHZhbHVlKTtcbiAgcmV0dXJuIHZhbHVlO1xufTtcbnZhciBfX3ByaXZhdGVNZXRob2QgPSAob2JqLCBtZW1iZXIsIG1ldGhvZCkgPT4ge1xuICBfX2FjY2Vzc0NoZWNrKG9iaiwgbWVtYmVyLCBcImFjY2VzcyBwcml2YXRlIG1ldGhvZFwiKTtcbiAgcmV0dXJuIG1ldGhvZDtcbn07XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9jdWlkQDIuMS44L25vZGVfbW9kdWxlcy9jdWlkL2xpYi9wYWQuanNcbnZhciByZXF1aXJlX3BhZCA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9jdWlkQDIuMS44L25vZGVfbW9kdWxlcy9jdWlkL2xpYi9wYWQuanNcIihleHBvcnRzLCBtb2R1bGUpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHBhZChudW0sIHNpemUpIHtcbiAgICAgIHZhciBzID0gXCIwMDAwMDAwMDBcIiArIG51bTtcbiAgICAgIHJldHVybiBzLnN1YnN0cihzLmxlbmd0aCAtIHNpemUpO1xuICAgIH07XG4gIH1cbn0pO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3VpZEAyLjEuOC9ub2RlX21vZHVsZXMvY3VpZC9saWIvZmluZ2VycHJpbnQuYnJvd3Nlci5qc1xudmFyIHJlcXVpcmVfZmluZ2VycHJpbnRfYnJvd3NlciA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9jdWlkQDIuMS44L25vZGVfbW9kdWxlcy9jdWlkL2xpYi9maW5nZXJwcmludC5icm93c2VyLmpzXCIoZXhwb3J0cywgbW9kdWxlKSB7XG4gICAgdmFyIHBhZCA9IHJlcXVpcmVfcGFkKCk7XG4gICAgdmFyIGVudiA9IHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgPyB3aW5kb3cgOiBzZWxmO1xuICAgIHZhciBnbG9iYWxDb3VudCA9IE9iamVjdC5rZXlzKGVudikubGVuZ3RoO1xuICAgIHZhciBtaW1lVHlwZXNMZW5ndGggPSBuYXZpZ2F0b3IubWltZVR5cGVzID8gbmF2aWdhdG9yLm1pbWVUeXBlcy5sZW5ndGggOiAwO1xuICAgIHZhciBjbGllbnRJZCA9IHBhZCgobWltZVR5cGVzTGVuZ3RoICsgbmF2aWdhdG9yLnVzZXJBZ2VudC5sZW5ndGgpLnRvU3RyaW5nKDM2KSArIGdsb2JhbENvdW50LnRvU3RyaW5nKDM2KSwgNCk7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBmaW5nZXJwcmludCgpIHtcbiAgICAgIHJldHVybiBjbGllbnRJZDtcbiAgICB9O1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2N1aWRAMi4xLjgvbm9kZV9tb2R1bGVzL2N1aWQvbGliL2dldFJhbmRvbVZhbHVlLmJyb3dzZXIuanNcbnZhciByZXF1aXJlX2dldFJhbmRvbVZhbHVlX2Jyb3dzZXIgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3VpZEAyLjEuOC9ub2RlX21vZHVsZXMvY3VpZC9saWIvZ2V0UmFuZG9tVmFsdWUuYnJvd3Nlci5qc1wiKGV4cG9ydHMsIG1vZHVsZSkge1xuICAgIHZhciBnZXRSYW5kb21WYWx1ZTtcbiAgICB2YXIgY3J5cHRvID0gdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiAod2luZG93LmNyeXB0byB8fCB3aW5kb3cubXNDcnlwdG8pIHx8IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYuY3J5cHRvO1xuICAgIGlmIChjcnlwdG8pIHtcbiAgICAgIGxpbSA9IE1hdGgucG93KDIsIDMyKSAtIDE7XG4gICAgICBnZXRSYW5kb21WYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5hYnMoY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDMyQXJyYXkoMSkpWzBdIC8gbGltKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGdldFJhbmRvbVZhbHVlID0gTWF0aC5yYW5kb207XG4gICAgfVxuICAgIHZhciBsaW07XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBnZXRSYW5kb21WYWx1ZTtcbiAgfVxufSk7XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9jdWlkQDIuMS44L25vZGVfbW9kdWxlcy9jdWlkL2luZGV4LmpzXG52YXIgcmVxdWlyZV9jdWlkID0gX19jb21tb25KUyh7XG4gIFwiLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2N1aWRAMi4xLjgvbm9kZV9tb2R1bGVzL2N1aWQvaW5kZXguanNcIihleHBvcnRzLCBtb2R1bGUpIHtcbiAgICB2YXIgZmluZ2VycHJpbnQgPSByZXF1aXJlX2ZpbmdlcnByaW50X2Jyb3dzZXIoKTtcbiAgICB2YXIgcGFkID0gcmVxdWlyZV9wYWQoKTtcbiAgICB2YXIgZ2V0UmFuZG9tVmFsdWUgPSByZXF1aXJlX2dldFJhbmRvbVZhbHVlX2Jyb3dzZXIoKTtcbiAgICB2YXIgYyA9IDA7XG4gICAgdmFyIGJsb2NrU2l6ZSA9IDQ7XG4gICAgdmFyIGJhc2UgPSAzNjtcbiAgICB2YXIgZGlzY3JldGVWYWx1ZXMgPSBNYXRoLnBvdyhiYXNlLCBibG9ja1NpemUpO1xuICAgIGZ1bmN0aW9uIHJhbmRvbUJsb2NrKCkge1xuICAgICAgcmV0dXJuIHBhZCgoZ2V0UmFuZG9tVmFsdWUoKSAqIGRpc2NyZXRlVmFsdWVzIDw8IDApLnRvU3RyaW5nKGJhc2UpLCBibG9ja1NpemUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzYWZlQ291bnRlcigpIHtcbiAgICAgIGMgPSBjIDwgZGlzY3JldGVWYWx1ZXMgPyBjIDogMDtcbiAgICAgIGMrKztcbiAgICAgIHJldHVybiBjIC0gMTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY3VpZDMoKSB7XG4gICAgICB2YXIgbGV0dGVyID0gXCJjXCIsIHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpLnRvU3RyaW5nKGJhc2UpLCBjb3VudGVyID0gcGFkKHNhZmVDb3VudGVyKCkudG9TdHJpbmcoYmFzZSksIGJsb2NrU2l6ZSksIHByaW50ID0gZmluZ2VycHJpbnQoKSwgcmFuZG9tID0gcmFuZG9tQmxvY2soKSArIHJhbmRvbUJsb2NrKCk7XG4gICAgICByZXR1cm4gbGV0dGVyICsgdGltZXN0YW1wICsgY291bnRlciArIHByaW50ICsgcmFuZG9tO1xuICAgIH1cbiAgICBjdWlkMy5zbHVnID0gZnVuY3Rpb24gc2x1ZygpIHtcbiAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKS5nZXRUaW1lKCkudG9TdHJpbmcoMzYpLCBjb3VudGVyID0gc2FmZUNvdW50ZXIoKS50b1N0cmluZygzNikuc2xpY2UoLTQpLCBwcmludCA9IGZpbmdlcnByaW50KCkuc2xpY2UoMCwgMSkgKyBmaW5nZXJwcmludCgpLnNsaWNlKC0xKSwgcmFuZG9tID0gcmFuZG9tQmxvY2soKS5zbGljZSgtMik7XG4gICAgICByZXR1cm4gZGF0ZS5zbGljZSgtMikgKyBjb3VudGVyICsgcHJpbnQgKyByYW5kb207XG4gICAgfTtcbiAgICBjdWlkMy5pc0N1aWQgPSBmdW5jdGlvbiBpc0N1aWQoc3RyaW5nVG9DaGVjaykge1xuICAgICAgaWYgKHR5cGVvZiBzdHJpbmdUb0NoZWNrICE9PSBcInN0cmluZ1wiKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICBpZiAoc3RyaW5nVG9DaGVjay5zdGFydHNXaXRoKFwiY1wiKSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBjdWlkMy5pc1NsdWcgPSBmdW5jdGlvbiBpc1NsdWcoc3RyaW5nVG9DaGVjaykge1xuICAgICAgaWYgKHR5cGVvZiBzdHJpbmdUb0NoZWNrICE9PSBcInN0cmluZ1wiKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB2YXIgc3RyaW5nTGVuZ3RoID0gc3RyaW5nVG9DaGVjay5sZW5ndGg7XG4gICAgICBpZiAoc3RyaW5nTGVuZ3RoID49IDcgJiYgc3RyaW5nTGVuZ3RoIDw9IDEwKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIGN1aWQzLmZpbmdlcnByaW50ID0gZmluZ2VycHJpbnQ7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBjdWlkMztcbiAgfVxufSk7XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ab3Blbi1kcmFmdCtkZWZlcnJlZC1wcm9taXNlQDIuMS4wL25vZGVfbW9kdWxlcy9Ab3Blbi1kcmFmdC9kZWZlcnJlZC1wcm9taXNlL2J1aWxkL2NyZWF0ZURlZmVycmVkRXhlY3V0b3IuanNcbnZhciByZXF1aXJlX2NyZWF0ZURlZmVycmVkRXhlY3V0b3IgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW4tZHJhZnQrZGVmZXJyZWQtcHJvbWlzZUAyLjEuMC9ub2RlX21vZHVsZXMvQG9wZW4tZHJhZnQvZGVmZXJyZWQtcHJvbWlzZS9idWlsZC9jcmVhdGVEZWZlcnJlZEV4ZWN1dG9yLmpzXCIoZXhwb3J0cykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBleHBvcnRzLmNyZWF0ZURlZmVycmVkRXhlY3V0b3IgPSB2b2lkIDA7XG4gICAgZnVuY3Rpb24gY3JlYXRlRGVmZXJyZWRFeGVjdXRvcigpIHtcbiAgICAgIGNvbnN0IGV4ZWN1dG9yID0gKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBleGVjdXRvci5zdGF0ZSA9IFwicGVuZGluZ1wiO1xuICAgICAgICBleGVjdXRvci5yZXNvbHZlID0gKGRhdGEpID0+IHtcbiAgICAgICAgICBpZiAoZXhlY3V0b3Iuc3RhdGUgIT09IFwicGVuZGluZ1wiKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGV4ZWN1dG9yLnJlc3VsdCA9IGRhdGE7XG4gICAgICAgICAgY29uc3Qgb25GdWxmaWxsZWQgPSAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIGV4ZWN1dG9yLnN0YXRlID0gXCJmdWxmaWxsZWRcIjtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiByZXNvbHZlKGRhdGEgaW5zdGFuY2VvZiBQcm9taXNlID8gZGF0YSA6IFByb21pc2UucmVzb2x2ZShkYXRhKS50aGVuKG9uRnVsZmlsbGVkKSk7XG4gICAgICAgIH07XG4gICAgICAgIGV4ZWN1dG9yLnJlamVjdCA9IChyZWFzb24pID0+IHtcbiAgICAgICAgICBpZiAoZXhlY3V0b3Iuc3RhdGUgIT09IFwicGVuZGluZ1wiKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHF1ZXVlTWljcm90YXNrKCgpID0+IHtcbiAgICAgICAgICAgIGV4ZWN1dG9yLnN0YXRlID0gXCJyZWplY3RlZFwiO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiByZWplY3QoZXhlY3V0b3IucmVqZWN0aW9uUmVhc29uID0gcmVhc29uKTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gZXhlY3V0b3I7XG4gICAgfVxuICAgIGV4cG9ydHMuY3JlYXRlRGVmZXJyZWRFeGVjdXRvciA9IGNyZWF0ZURlZmVycmVkRXhlY3V0b3I7XG4gIH1cbn0pO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW4tZHJhZnQrZGVmZXJyZWQtcHJvbWlzZUAyLjEuMC9ub2RlX21vZHVsZXMvQG9wZW4tZHJhZnQvZGVmZXJyZWQtcHJvbWlzZS9idWlsZC9EZWZlcnJlZFByb21pc2UuanNcbnZhciByZXF1aXJlX0RlZmVycmVkUHJvbWlzZSA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ab3Blbi1kcmFmdCtkZWZlcnJlZC1wcm9taXNlQDIuMS4wL25vZGVfbW9kdWxlcy9Ab3Blbi1kcmFmdC9kZWZlcnJlZC1wcm9taXNlL2J1aWxkL0RlZmVycmVkUHJvbWlzZS5qc1wiKGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZXhwb3J0cy5EZWZlcnJlZFByb21pc2UgPSB2b2lkIDA7XG4gICAgdmFyIGNyZWF0ZURlZmVycmVkRXhlY3V0b3JfMSA9IHJlcXVpcmVfY3JlYXRlRGVmZXJyZWRFeGVjdXRvcigpO1xuICAgIHZhciBEZWZlcnJlZFByb21pc2U0ID0gY2xhc3MgZXh0ZW5kcyBQcm9taXNlIHtcbiAgICAgICNleGVjdXRvcjtcbiAgICAgIHJlc29sdmU7XG4gICAgICByZWplY3Q7XG4gICAgICBjb25zdHJ1Y3RvcihleGVjdXRvciA9IG51bGwpIHtcbiAgICAgICAgY29uc3QgZGVmZXJyZWRFeGVjdXRvciA9ICgwLCBjcmVhdGVEZWZlcnJlZEV4ZWN1dG9yXzEuY3JlYXRlRGVmZXJyZWRFeGVjdXRvcikoKTtcbiAgICAgICAgc3VwZXIoKG9yaWdpbmFsUmVzb2x2ZSwgb3JpZ2luYWxSZWplY3QpID0+IHtcbiAgICAgICAgICBkZWZlcnJlZEV4ZWN1dG9yKG9yaWdpbmFsUmVzb2x2ZSwgb3JpZ2luYWxSZWplY3QpO1xuICAgICAgICAgIGV4ZWN1dG9yPy4oZGVmZXJyZWRFeGVjdXRvci5yZXNvbHZlLCBkZWZlcnJlZEV4ZWN1dG9yLnJlamVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLiNleGVjdXRvciA9IGRlZmVycmVkRXhlY3V0b3I7XG4gICAgICAgIHRoaXMucmVzb2x2ZSA9IHRoaXMuI2V4ZWN1dG9yLnJlc29sdmU7XG4gICAgICAgIHRoaXMucmVqZWN0ID0gdGhpcy4jZXhlY3V0b3IucmVqZWN0O1xuICAgICAgfVxuICAgICAgZ2V0IHN0YXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jZXhlY3V0b3Iuc3RhdGU7XG4gICAgICB9XG4gICAgICBnZXQgcmVqZWN0aW9uUmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jZXhlY3V0b3IucmVqZWN0aW9uUmVhc29uO1xuICAgICAgfVxuICAgICAgdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jZGVjb3JhdGUoc3VwZXIudGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkpO1xuICAgICAgfVxuICAgICAgY2F0Y2gob25SZWplY3RlZCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jZGVjb3JhdGUoc3VwZXIuY2F0Y2gob25SZWplY3RlZCkpO1xuICAgICAgfVxuICAgICAgZmluYWxseShvbmZpbmFsbHkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI2RlY29yYXRlKHN1cGVyLmZpbmFsbHkob25maW5hbGx5KSk7XG4gICAgICB9XG4gICAgICAjZGVjb3JhdGUocHJvbWlzZSkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMocHJvbWlzZSwge1xuICAgICAgICAgIHJlc29sdmU6IHsgY29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogdGhpcy5yZXNvbHZlIH0sXG4gICAgICAgICAgcmVqZWN0OiB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRoaXMucmVqZWN0IH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBleHBvcnRzLkRlZmVycmVkUHJvbWlzZSA9IERlZmVycmVkUHJvbWlzZTQ7XG4gIH1cbn0pO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW4tZHJhZnQrZGVmZXJyZWQtcHJvbWlzZUAyLjEuMC9ub2RlX21vZHVsZXMvQG9wZW4tZHJhZnQvZGVmZXJyZWQtcHJvbWlzZS9idWlsZC9pbmRleC5qc1xudmFyIHJlcXVpcmVfYnVpbGQgPSBfX2NvbW1vbkpTKHtcbiAgXCIuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vQG9wZW4tZHJhZnQrZGVmZXJyZWQtcHJvbWlzZUAyLjEuMC9ub2RlX21vZHVsZXMvQG9wZW4tZHJhZnQvZGVmZXJyZWQtcHJvbWlzZS9idWlsZC9pbmRleC5qc1wiKGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgX19jcmVhdGVCaW5kaW5nID0gZXhwb3J0cyAmJiBleHBvcnRzLl9fY3JlYXRlQmluZGluZyB8fCAoT2JqZWN0LmNyZWF0ZSA/IGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgICBpZiAoazIgPT09IHZvaWQgMClcbiAgICAgICAgazIgPSBrO1xuICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICAgICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gbVtrXTtcbiAgICAgICAgfSB9O1xuICAgICAgfVxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcbiAgICB9IDogZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICAgIGlmIChrMiA9PT0gdm9pZCAwKVxuICAgICAgICBrMiA9IGs7XG4gICAgICBvW2syXSA9IG1ba107XG4gICAgfSk7XG4gICAgdmFyIF9fZXhwb3J0U3RhciA9IGV4cG9ydHMgJiYgZXhwb3J0cy5fX2V4cG9ydFN0YXIgfHwgZnVuY3Rpb24obSwgZXhwb3J0czIpIHtcbiAgICAgIGZvciAodmFyIHAgaW4gbSlcbiAgICAgICAgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0czIsIHApKVxuICAgICAgICAgIF9fY3JlYXRlQmluZGluZyhleHBvcnRzMiwgbSwgcCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgX19leHBvcnRTdGFyKHJlcXVpcmVfY3JlYXRlRGVmZXJyZWRFeGVjdXRvcigpLCBleHBvcnRzKTtcbiAgICBfX2V4cG9ydFN0YXIocmVxdWlyZV9EZWZlcnJlZFByb21pc2UoKSwgZXhwb3J0cyk7XG4gIH1cbn0pO1xuXG4vLyAuLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vc3RyaWN0LWV2ZW50LWVtaXR0ZXJAMC40LjMvbm9kZV9tb2R1bGVzL3N0cmljdC1ldmVudC1lbWl0dGVyL2xpYi9NZW1vcnlMZWFrRXJyb3IuanNcbnZhciByZXF1aXJlX01lbW9yeUxlYWtFcnJvciA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHJpY3QtZXZlbnQtZW1pdHRlckAwLjQuMy9ub2RlX21vZHVsZXMvc3RyaWN0LWV2ZW50LWVtaXR0ZXIvbGliL01lbW9yeUxlYWtFcnJvci5qc1wiKGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZXhwb3J0cy5NZW1vcnlMZWFrRXJyb3IgPSB2b2lkIDA7XG4gICAgdmFyIE1lbW9yeUxlYWtFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICAgICAgZW1pdHRlcjtcbiAgICAgIHR5cGU7XG4gICAgICBjb3VudDtcbiAgICAgIGNvbnN0cnVjdG9yKGVtaXR0ZXIsIHR5cGUsIGNvdW50KSB7XG4gICAgICAgIHN1cGVyKGBQb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5IGxlYWsgZGV0ZWN0ZWQuICR7Y291bnR9ICR7dHlwZS50b1N0cmluZygpfSBsaXN0ZW5lcnMgYWRkZWQuIFVzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0YCk7XG4gICAgICAgIHRoaXMuZW1pdHRlciA9IGVtaXR0ZXI7XG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMuY291bnQgPSBjb3VudDtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJNYXhMaXN0ZW5lcnNFeGNlZWRlZFdhcm5pbmdcIjtcbiAgICAgIH1cbiAgICB9O1xuICAgIGV4cG9ydHMuTWVtb3J5TGVha0Vycm9yID0gTWVtb3J5TGVha0Vycm9yO1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0cmljdC1ldmVudC1lbWl0dGVyQDAuNC4zL25vZGVfbW9kdWxlcy9zdHJpY3QtZXZlbnQtZW1pdHRlci9saWIvRW1pdHRlci5qc1xudmFyIHJlcXVpcmVfRW1pdHRlciA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHJpY3QtZXZlbnQtZW1pdHRlckAwLjQuMy9ub2RlX21vZHVsZXMvc3RyaWN0LWV2ZW50LWVtaXR0ZXIvbGliL0VtaXR0ZXIuanNcIihleHBvcnRzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIGV4cG9ydHMuRW1pdHRlciA9IHZvaWQgMDtcbiAgICB2YXIgTWVtb3J5TGVha0Vycm9yXzEgPSByZXF1aXJlX01lbW9yeUxlYWtFcnJvcigpO1xuICAgIHZhciBfZXZlbnRzLCBfbWF4TGlzdGVuZXJzLCBfaGFzV2FybmVkQWJvdXRQb3RlbnRpYWxNZW1vcnR5TGVhaywgX2dldExpc3RlbmVycywgZ2V0TGlzdGVuZXJzX2ZuLCBfcmVtb3ZlTGlzdGVuZXIsIHJlbW92ZUxpc3RlbmVyX2ZuLCBfd3JhcE9uY2VMaXN0ZW5lciwgd3JhcE9uY2VMaXN0ZW5lcl9mbiwgX2ludGVybmFsRW1pdCwgaW50ZXJuYWxFbWl0X2ZuO1xuICAgIHZhciBfRW1pdHRlciA9IGNsYXNzIHtcbiAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBfX3ByaXZhdGVBZGQodGhpcywgX2dldExpc3RlbmVycyk7XG4gICAgICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcmVtb3ZlTGlzdGVuZXIpO1xuICAgICAgICBfX3ByaXZhdGVBZGQodGhpcywgX3dyYXBPbmNlTGlzdGVuZXIpO1xuICAgICAgICBfX3ByaXZhdGVBZGQodGhpcywgX2ludGVybmFsRW1pdCk7XG4gICAgICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfZXZlbnRzLCB2b2lkIDApO1xuICAgICAgICBfX3ByaXZhdGVBZGQodGhpcywgX21heExpc3RlbmVycywgdm9pZCAwKTtcbiAgICAgICAgX19wcml2YXRlQWRkKHRoaXMsIF9oYXNXYXJuZWRBYm91dFBvdGVudGlhbE1lbW9ydHlMZWFrLCB2b2lkIDApO1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX2V2ZW50cywgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSk7XG4gICAgICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfbWF4TGlzdGVuZXJzLCBfRW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzKTtcbiAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9oYXNXYXJuZWRBYm91dFBvdGVudGlhbE1lbW9ydHlMZWFrLCBmYWxzZSk7XG4gICAgICB9XG4gICAgICBzdGF0aWMgbGlzdGVuZXJDb3VudChlbWl0dGVyLCBldmVudE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGVtaXR0ZXIubGlzdGVuZXJDb3VudChldmVudE5hbWUpO1xuICAgICAgfVxuICAgICAgc2V0TWF4TGlzdGVuZXJzKG1heExpc3RlbmVycykge1xuICAgICAgICBfX3ByaXZhdGVTZXQodGhpcywgX21heExpc3RlbmVycywgbWF4TGlzdGVuZXJzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBnZXRNYXhMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX21heExpc3RlbmVycyk7XG4gICAgICB9XG4gICAgICBldmVudE5hbWVzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50cykua2V5cygpKTtcbiAgICAgIH1cbiAgICAgIGVtaXQoZXZlbnROYW1lLCAuLi5kYXRhKSB7XG4gICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0TGlzdGVuZXJzLCBnZXRMaXN0ZW5lcnNfZm4pLmNhbGwodGhpcywgZXZlbnROYW1lKTtcbiAgICAgICAgbGlzdGVuZXJzLmZvckVhY2goKGxpc3RlbmVyKSA9PiB7XG4gICAgICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbGlzdGVuZXJzLmxlbmd0aCA+IDA7XG4gICAgICB9XG4gICAgICBhZGRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfaW50ZXJuYWxFbWl0LCBpbnRlcm5hbEVtaXRfZm4pLmNhbGwodGhpcywgXCJuZXdMaXN0ZW5lclwiLCBldmVudE5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgY29uc3QgbmV4dExpc3RlbmVycyA9IF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0TGlzdGVuZXJzLCBnZXRMaXN0ZW5lcnNfZm4pLmNhbGwodGhpcywgZXZlbnROYW1lKS5jb25jYXQobGlzdGVuZXIpO1xuICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50cykuc2V0KGV2ZW50TmFtZSwgbmV4dExpc3RlbmVycyk7XG4gICAgICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX21heExpc3RlbmVycykgPiAwICYmIHRoaXMubGlzdGVuZXJDb3VudChldmVudE5hbWUpID4gX19wcml2YXRlR2V0KHRoaXMsIF9tYXhMaXN0ZW5lcnMpICYmICFfX3ByaXZhdGVHZXQodGhpcywgX2hhc1dhcm5lZEFib3V0UG90ZW50aWFsTWVtb3J0eUxlYWspKSB7XG4gICAgICAgICAgX19wcml2YXRlU2V0KHRoaXMsIF9oYXNXYXJuZWRBYm91dFBvdGVudGlhbE1lbW9ydHlMZWFrLCB0cnVlKTtcbiAgICAgICAgICBjb25zdCBtZW1vcnlMZWFrV2FybmluZyA9IG5ldyBNZW1vcnlMZWFrRXJyb3JfMS5NZW1vcnlMZWFrRXJyb3IodGhpcywgZXZlbnROYW1lLCB0aGlzLmxpc3RlbmVyQ291bnQoZXZlbnROYW1lKSk7XG4gICAgICAgICAgY29uc29sZS53YXJuKG1lbW9yeUxlYWtXYXJuaW5nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIG9uKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgICBvbmNlKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkTGlzdGVuZXIoZXZlbnROYW1lLCBfX3ByaXZhdGVNZXRob2QodGhpcywgX3dyYXBPbmNlTGlzdGVuZXIsIHdyYXBPbmNlTGlzdGVuZXJfZm4pLmNhbGwodGhpcywgZXZlbnROYW1lLCBsaXN0ZW5lcikpO1xuICAgICAgfVxuICAgICAgcHJlcGVuZExpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gX19wcml2YXRlTWV0aG9kKHRoaXMsIF9nZXRMaXN0ZW5lcnMsIGdldExpc3RlbmVyc19mbikuY2FsbCh0aGlzLCBldmVudE5hbWUpO1xuICAgICAgICBpZiAobGlzdGVuZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBuZXh0TGlzdGVuZXJzID0gW2xpc3RlbmVyXS5jb25jYXQobGlzdGVuZXJzKTtcbiAgICAgICAgICBfX3ByaXZhdGVHZXQodGhpcywgX2V2ZW50cykuc2V0KGV2ZW50TmFtZSwgbmV4dExpc3RlbmVycyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9ldmVudHMpLnNldChldmVudE5hbWUsIGxpc3RlbmVycy5jb25jYXQobGlzdGVuZXIpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIHByZXBlbmRPbmNlTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmVwZW5kTGlzdGVuZXIoZXZlbnROYW1lLCBfX3ByaXZhdGVNZXRob2QodGhpcywgX3dyYXBPbmNlTGlzdGVuZXIsIHdyYXBPbmNlTGlzdGVuZXJfZm4pLmNhbGwodGhpcywgZXZlbnROYW1lLCBsaXN0ZW5lcikpO1xuICAgICAgfVxuICAgICAgcmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSBfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldExpc3RlbmVycywgZ2V0TGlzdGVuZXJzX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSk7XG4gICAgICAgIGlmIChsaXN0ZW5lcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfcmVtb3ZlTGlzdGVuZXIsIHJlbW92ZUxpc3RlbmVyX2ZuKS5jYWxsKHRoaXMsIGxpc3RlbmVycywgbGlzdGVuZXIpO1xuICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfZXZlbnRzKS5zZXQoZXZlbnROYW1lLCBsaXN0ZW5lcnMpO1xuICAgICAgICAgIF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfaW50ZXJuYWxFbWl0LCBpbnRlcm5hbEVtaXRfZm4pLmNhbGwodGhpcywgXCJyZW1vdmVMaXN0ZW5lclwiLCBldmVudE5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICAgIG9mZihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuZXIpO1xuICAgICAgfVxuICAgICAgcmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50TmFtZSkge1xuICAgICAgICBpZiAoZXZlbnROYW1lKSB7XG4gICAgICAgICAgX19wcml2YXRlR2V0KHRoaXMsIF9ldmVudHMpLmRlbGV0ZShldmVudE5hbWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIF9fcHJpdmF0ZUdldCh0aGlzLCBfZXZlbnRzKS5jbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgbGlzdGVuZXJzKGV2ZW50TmFtZSkge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShfX3ByaXZhdGVNZXRob2QodGhpcywgX2dldExpc3RlbmVycywgZ2V0TGlzdGVuZXJzX2ZuKS5jYWxsKHRoaXMsIGV2ZW50TmFtZSkpO1xuICAgICAgfVxuICAgICAgbGlzdGVuZXJDb3VudChldmVudE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIF9fcHJpdmF0ZU1ldGhvZCh0aGlzLCBfZ2V0TGlzdGVuZXJzLCBnZXRMaXN0ZW5lcnNfZm4pLmNhbGwodGhpcywgZXZlbnROYW1lKS5sZW5ndGg7XG4gICAgICB9XG4gICAgICByYXdMaXN0ZW5lcnMoZXZlbnROYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVycyhldmVudE5hbWUpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIEVtaXR0ZXIyID0gX0VtaXR0ZXI7XG4gICAgX2V2ZW50cyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgX21heExpc3RlbmVycyA9IG5ldyBXZWFrTWFwKCk7XG4gICAgX2hhc1dhcm5lZEFib3V0UG90ZW50aWFsTWVtb3J0eUxlYWsgPSBuZXcgV2Vha01hcCgpO1xuICAgIF9nZXRMaXN0ZW5lcnMgPSBuZXcgV2Vha1NldCgpO1xuICAgIGdldExpc3RlbmVyc19mbiA9IGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xuICAgICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfZXZlbnRzKS5nZXQoZXZlbnROYW1lKSB8fCBbXTtcbiAgICB9O1xuICAgIF9yZW1vdmVMaXN0ZW5lciA9IG5ldyBXZWFrU2V0KCk7XG4gICAgcmVtb3ZlTGlzdGVuZXJfZm4gPSBmdW5jdGlvbihsaXN0ZW5lcnMsIGxpc3RlbmVyKSB7XG4gICAgICBjb25zdCBpbmRleCA9IGxpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgX3dyYXBPbmNlTGlzdGVuZXIgPSBuZXcgV2Vha1NldCgpO1xuICAgIHdyYXBPbmNlTGlzdGVuZXJfZm4gPSBmdW5jdGlvbihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICBjb25zdCBvbmNlTGlzdGVuZXIgPSAoLi4uZGF0YSkgPT4ge1xuICAgICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgb25jZUxpc3RlbmVyKTtcbiAgICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgZGF0YSk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIG9uY2VMaXN0ZW5lcjtcbiAgICB9O1xuICAgIF9pbnRlcm5hbEVtaXQgPSBuZXcgV2Vha1NldCgpO1xuICAgIGludGVybmFsRW1pdF9mbiA9IGZ1bmN0aW9uKGludGVybmFsRXZlbnROYW1lLCBldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgICB0aGlzLmVtaXQoXG4gICAgICAgIGludGVybmFsRXZlbnROYW1lLFxuICAgICAgICAuLi5bZXZlbnROYW1lLCBsaXN0ZW5lcl1cbiAgICAgICk7XG4gICAgfTtcbiAgICBfX3B1YmxpY0ZpZWxkKEVtaXR0ZXIyLCBcImRlZmF1bHRNYXhMaXN0ZW5lcnNcIiwgMTApO1xuICAgIGV4cG9ydHMuRW1pdHRlciA9IEVtaXR0ZXIyO1xuICB9XG59KTtcblxuLy8gLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0cmljdC1ldmVudC1lbWl0dGVyQDAuNC4zL25vZGVfbW9kdWxlcy9zdHJpY3QtZXZlbnQtZW1pdHRlci9saWIvaW5kZXguanNcbnZhciByZXF1aXJlX2xpYiA9IF9fY29tbW9uSlMoe1xuICBcIi4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHJpY3QtZXZlbnQtZW1pdHRlckAwLjQuMy9ub2RlX21vZHVsZXMvc3RyaWN0LWV2ZW50LWVtaXR0ZXIvbGliL2luZGV4LmpzXCIoZXhwb3J0cykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBleHBvcnRzICYmIGV4cG9ydHMuX19jcmVhdGVCaW5kaW5nIHx8IChPYmplY3QuY3JlYXRlID8gZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICAgIGlmIChrMiA9PT0gdm9pZCAwKVxuICAgICAgICBrMiA9IGs7XG4gICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBtW2tdO1xuICAgICAgICB9IH07XG4gICAgICB9XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xuICAgIH0gOiBmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgICAgaWYgKGsyID09PSB2b2lkIDApXG4gICAgICAgIGsyID0gaztcbiAgICAgIG9bazJdID0gbVtrXTtcbiAgICB9KTtcbiAgICB2YXIgX19leHBvcnRTdGFyID0gZXhwb3J0cyAmJiBleHBvcnRzLl9fZXhwb3J0U3RhciB8fCBmdW5jdGlvbihtLCBleHBvcnRzMikge1xuICAgICAgZm9yICh2YXIgcCBpbiBtKVxuICAgICAgICBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChleHBvcnRzMiwgcCkpXG4gICAgICAgICAgX19jcmVhdGVCaW5kaW5nKGV4cG9ydHMyLCBtLCBwKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBfX2V4cG9ydFN0YXIocmVxdWlyZV9FbWl0dGVyKCksIGV4cG9ydHMpO1xuICAgIF9fZXhwb3J0U3RhcihyZXF1aXJlX01lbW9yeUxlYWtFcnJvcigpLCBleHBvcnRzKTtcbiAgfVxufSk7XG5cbi8vIHNyYy9tZXNzYWdlcy50c1xudmFyIGltcG9ydF9jdWlkID0gX190b0VTTShyZXF1aXJlX2N1aWQoKSk7XG5cbi8vIC4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9vdXR2YXJpYW50QDEuNC4wL25vZGVfbW9kdWxlcy9vdXR2YXJpYW50L2xpYi9pbmRleC5tanNcbnZhciBQT1NJVElPTkFMU19FWFAgPSAvKCU/KSglKFtzZGpvXSkpL2c7XG5mdW5jdGlvbiBzZXJpYWxpemVQb3NpdGlvbmFsKHBvc2l0aW9uYWwsIGZsYWcpIHtcbiAgc3dpdGNoIChmbGFnKSB7XG4gICAgY2FzZSBcInNcIjpcbiAgICAgIHJldHVybiBwb3NpdGlvbmFsO1xuICAgIGNhc2UgXCJkXCI6XG4gICAgY2FzZSBcImlcIjpcbiAgICAgIHJldHVybiBOdW1iZXIocG9zaXRpb25hbCk7XG4gICAgY2FzZSBcImpcIjpcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShwb3NpdGlvbmFsKTtcbiAgICBjYXNlIFwib1wiOiB7XG4gICAgICBpZiAodHlwZW9mIHBvc2l0aW9uYWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uYWw7XG4gICAgICB9XG4gICAgICBjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkocG9zaXRpb25hbCk7XG4gICAgICBpZiAoanNvbiA9PT0gXCJ7fVwiIHx8IGpzb24gPT09IFwiW11cIiB8fCAvXlxcW29iamVjdCAuKz9cXF0kLy50ZXN0KGpzb24pKSB7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbmFsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGpzb247XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBmb3JtYXQobWVzc2FnZSwgLi4ucG9zaXRpb25hbHMpIHtcbiAgaWYgKHBvc2l0aW9uYWxzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG4gIGxldCBwb3NpdGlvbmFsSW5kZXggPSAwO1xuICBsZXQgZm9ybWF0dGVkTWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShcbiAgICBQT1NJVElPTkFMU19FWFAsXG4gICAgKG1hdGNoLCBpc0VzY2FwZWQsIF8sIGZsYWcpID0+IHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uYWwgPSBwb3NpdGlvbmFsc1twb3NpdGlvbmFsSW5kZXhdO1xuICAgICAgY29uc3QgdmFsdWUgPSBzZXJpYWxpemVQb3NpdGlvbmFsKHBvc2l0aW9uYWwsIGZsYWcpO1xuICAgICAgaWYgKCFpc0VzY2FwZWQpIHtcbiAgICAgICAgcG9zaXRpb25hbEluZGV4Kys7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXRjaDtcbiAgICB9XG4gICk7XG4gIGlmIChwb3NpdGlvbmFsSW5kZXggPCBwb3NpdGlvbmFscy5sZW5ndGgpIHtcbiAgICBmb3JtYXR0ZWRNZXNzYWdlICs9IGAgJHtwb3NpdGlvbmFscy5zbGljZShwb3NpdGlvbmFsSW5kZXgpLmpvaW4oXCIgXCIpfWA7XG4gIH1cbiAgZm9ybWF0dGVkTWVzc2FnZSA9IGZvcm1hdHRlZE1lc3NhZ2UucmVwbGFjZSgvJXsyLDJ9L2csIFwiJVwiKTtcbiAgcmV0dXJuIGZvcm1hdHRlZE1lc3NhZ2U7XG59XG52YXIgU1RBQ0tfRlJBTUVTX1RPX0lHTk9SRSA9IDI7XG5mdW5jdGlvbiBjbGVhbkVycm9yU3RhY2soZXJyb3IpIHtcbiAgaWYgKCFlcnJvci5zdGFjaykge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBuZXh0U3RhY2sgPSBlcnJvci5zdGFjay5zcGxpdChcIlxcblwiKTtcbiAgbmV4dFN0YWNrLnNwbGljZSgxLCBTVEFDS19GUkFNRVNfVE9fSUdOT1JFKTtcbiAgZXJyb3Iuc3RhY2sgPSBuZXh0U3RhY2suam9pbihcIlxcblwiKTtcbn1cbnZhciBJbnZhcmlhbnRFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlLCAuLi5wb3NpdGlvbmFscykge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5uYW1lID0gXCJJbnZhcmlhbnQgVmlvbGF0aW9uXCI7XG4gICAgdGhpcy5tZXNzYWdlID0gZm9ybWF0KG1lc3NhZ2UsIC4uLnBvc2l0aW9uYWxzKTtcbiAgICBjbGVhbkVycm9yU3RhY2sodGhpcyk7XG4gIH1cbn07XG52YXIgaW52YXJpYW50ID0gKHByZWRpY2F0ZSwgbWVzc2FnZSwgLi4ucG9zaXRpb25hbHMpID0+IHtcbiAgaWYgKCFwcmVkaWNhdGUpIHtcbiAgICB0aHJvdyBuZXcgSW52YXJpYW50RXJyb3IobWVzc2FnZSwgLi4ucG9zaXRpb25hbHMpO1xuICB9XG59O1xuaW52YXJpYW50LmFzID0gKEVycm9yQ29uc3RydWN0b3IsIHByZWRpY2F0ZSwgbWVzc2FnZSwgLi4ucG9zaXRpb25hbHMpID0+IHtcbiAgaWYgKCFwcmVkaWNhdGUpIHtcbiAgICBjb25zdCBpc0NvbnN0cnVjdG9yID0gRXJyb3JDb25zdHJ1Y3Rvci5wcm90b3R5cGUubmFtZSAhPSBudWxsO1xuICAgIGNvbnN0IGVycm9yID0gaXNDb25zdHJ1Y3RvciA/IG5ldyBFcnJvckNvbnN0cnVjdG9yKGZvcm1hdChtZXNzYWdlLCBwb3NpdGlvbmFscykpIDogRXJyb3JDb25zdHJ1Y3Rvcihmb3JtYXQobWVzc2FnZSwgcG9zaXRpb25hbHMpKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuLy8gc3JjL21lc3NhZ2VzLnRzXG52YXIgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UgPSBfX3RvRVNNKHJlcXVpcmVfYnVpbGQoKSk7XG5cbi8vIHNyYy9sb2dnZXIudHNcbnZhciBGTEFHID0gd2luZG93LmxvY2FsU3RvcmFnZVtcIkNTQl9FTVVMQVRPUl9ERUJVR1wiXTtcbnZhciBERUZBVUxUID0gXCJcXHgxQlswbVwiO1xudmFyIEdSRUVOID0gXCJcXHgxQlszMjsxbVwiO1xudmFyIFJFRCA9IFwiXFx4MUJbMzFtXCI7XG52YXIgQkxVRSA9IFwiXFx4MUJbMzRtXCI7XG52YXIgWUVMTE9XID0gXCJcXHgxQlszMzsxbVwiO1xudmFyIE1BR0VOVEEgPSBcIlxceDFCWzM1OzFtXCI7XG52YXIgQ1lBTiA9IFwiXFx4MUJbMzY7MW1cIjtcbnZhciBDT0xPUl9TQ09QRSA9IHtcbiAgcHJldmlldzogWUVMTE9XLFxuICBlbXVsYXRvcjogTUFHRU5UQSxcbiAgcnVudGltZTogQ1lBTixcbiAgYnJpZGdlOiBCTFVFLFxuICBcInJ1bnRpbWU6d29ya2VyXCI6IENZQU5cbn07XG5mdW5jdGlvbiBjcmVhdGVEZWJ1ZyhzY29wZSkge1xuICByZXR1cm4gZnVuY3Rpb24gZGVidWczKG1lc3NhZ2UsIC4uLmRhdGEpIHtcbiAgICBpZiAoRkxBRyA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9ICgpID0+IHtcbiAgICAgICAgaWYgKG1lc3NhZ2UuaW5jbHVkZXMoXCJzZW5kZXJcIikpXG4gICAgICAgICAgcmV0dXJuIGAke0dSRUVOfXNlbmRlcmA7XG4gICAgICAgIGlmIChtZXNzYWdlLmluY2x1ZGVzKFwicmVjZWl2ZXJcIikpXG4gICAgICAgICAgcmV0dXJuIGAke1JFRH1yZWNlaXZlcmA7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgfTtcbiAgICAgIGNvbnN0IGNsZWFuTWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZSgvXFxbLitcXF06LywgXCJcIik7XG4gICAgICBjb25zb2xlLmRlYnVnKGAke0NPTE9SX1NDT1BFW3Njb3BlXX0ke3Njb3BlfToke2RpcmVjdGlvbigpfSR7REVGQVVMVH06JHtjbGVhbk1lc3NhZ2V9YCwgLi4uZGF0YSk7XG4gICAgfVxuICB9O1xufVxuXG4vLyBzcmMvbWVzc2FnZXMudHNcbnZhciBkZWJ1ZyA9IGNyZWF0ZURlYnVnKFwiZW11bGF0b3JcIik7XG52YXIgTWVzc2FnZVJlY2VpdmVyID0gY2xhc3Mge1xuICBlbWl0dGVyO1xuICBzZW5kZXJQb3J0ID0gbnVsbDtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5lbWl0dGVyID0gbmV3IEV2ZW50VGFyZ2V0KCk7XG4gICAgdGhpcy53YWl0Rm9ySGFuZHNoYWtlKCk7XG4gIH1cbiAgd2FpdEZvckhhbmRzaGFrZSgpIHtcbiAgICBjb25zdCBoYW5kc2hha2VQcm9taXNlID0gbmV3IGltcG9ydF9kZWZlcnJlZF9wcm9taXNlLkRlZmVycmVkUHJvbWlzZSgpO1xuICAgIGNvbnN0IGhhbmRzaGFrZUxpc3RlbmVyID0gKG1lc3NhZ2UpID0+IHtcbiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gbWVzc2FnZTtcbiAgICAgIGRlYnVnKFwiW21lc3NhZ2UtcmVjZWl2ZXJdOiBpbmNvbWluZ1wiLCBtZXNzYWdlKTtcbiAgICAgIGlmIChkYXRhLnR5cGUgPT09IFwiaW50ZXJuYWwvaGFuZHNoYWtlXCIpIHtcbiAgICAgICAgaW52YXJpYW50KFxuICAgICAgICAgIG1lc3NhZ2UucG9ydHMubGVuZ3RoID4gMCxcbiAgICAgICAgICBcIkZhaWxlZCB0byBjb25maXJtIGEgTWVzc2FnZVJlY2VpdmVyIGhhbmRzaGFrZTogcmVjZWl2ZWQgZXZlbnQgaGFzIG5vIHBvcnRzXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5zZW5kZXJQb3J0ID0gbWVzc2FnZS5wb3J0c1swXTtcbiAgICAgICAgdGhpcy5hZGRNZXNzYWdlTGlzdGVuZXIoKTtcbiAgICAgICAgZGVidWcoXCJbbWVzc2FnZS1yZWNlaXZlcl06IGhhbmRzaGFrZSByZWNlaXZlZCFcIiwgdGhpcy5zZW5kZXJQb3J0KTtcbiAgICAgICAgdGhpcy5zZW5kKFwiaW50ZXJuYWwvaGFuZHNoYWtlL2RvbmVcIik7XG4gICAgICAgIGRlYnVnKFwiW21lc3NhZ2UtcmVjZWl2ZXJdOiBmaW5pc2ggaGFuZHNoYWtlXCIpO1xuICAgICAgfVxuICAgIH07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRzaGFrZUxpc3RlbmVyKTtcbiAgICBoYW5kc2hha2VQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRzaGFrZUxpc3RlbmVyKTtcbiAgICB9KTtcbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogXCJpbnRlcm5hbC9yZWFkeVwiIH0sIFwiKlwiKTtcbiAgICByZXR1cm4gaGFuZHNoYWtlUHJvbWlzZTtcbiAgfVxuICBhZGRNZXNzYWdlTGlzdGVuZXIoKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5zZW5kZXJQb3J0LFxuICAgICAgXCJbTWVzc2FnZVJlY2VpdmVyXSBGYWlsZWQgdG8gYWRkIGEgbWVzc2FnZSBsaXN0ZW5lcjogc2VuZGVyIHBvcnQgaXMgbm90IGRlZmluZWQuIERpZCB5b3UgZm9yZ2V0IHRvIGF3YWl0IGEgaGFuZHNoYWtlP1wiXG4gICAgKTtcbiAgICB0aGlzLnNlbmRlclBvcnQub25tZXNzYWdlID0gKGV2dCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IGV2dC5kYXRhO1xuICAgICAgaWYgKGRhdGEudHlwZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuZW1pdHRlci5kaXNwYXRjaEV2ZW50KFxuICAgICAgICBuZXcgTWVzc2FnZUV2ZW50KGRhdGEudHlwZSwge1xuICAgICAgICAgIGRhdGE6IGRhdGEucGF5bG9hZFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9O1xuICB9XG4gIG9uKGV2ZW50LCBsaXN0ZW5lciwgb3B0aW9ucykge1xuICAgIHRoaXMuZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgZXZlbnQsXG4gICAgICBhc3luYyAobWVzc2FnZSkgPT4ge1xuICAgICAgICBpZiAoIShtZXNzYWdlIGluc3RhbmNlb2YgTWVzc2FnZUV2ZW50KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IG9wZXJhdGlvbklkLCBwYXlsb2FkIH0gPSBtZXNzYWdlLmRhdGE7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgbGlzdGVuZXJQYXlsb2FkID0gYXdhaXQgbGlzdGVuZXIocGF5bG9hZCk7XG4gICAgICAgICAgdGhpcy5zZW5kKFwiaW50ZXJuYWwvb3BlcmF0aW9uL2RvbmVcIiwgeyBvcGVyYXRpb25JZCwgbGlzdGVuZXJQYXlsb2FkIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLnNlbmQoXCJpbnRlcm5hbC9vcGVyYXRpb24vZmFpbGVkXCIsIHsgb3BlcmF0aW9uSWQsIGVycm9yIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9wdGlvbnNcbiAgICApO1xuICB9XG4gIHNlbmQoZXZlbnQsIC4uLmRhdGEpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICB0aGlzLnNlbmRlclBvcnQsXG4gICAgICAnW01lc3NhZ2VSZWNlaXZlcl0gRmFpbGVkIHRvIHNlbmQgYSBtZXNzYWdlIFwiJWpcIjogc2VuZGVyIHBvcnQgaXMgbm90IGRlZmluZWQuIERpZCB5b3UgZm9yZ2V0IHRvIGF3YWl0IGEgaGFuZHNoYWtlPycsXG4gICAgICBldmVudFxuICAgICk7XG4gICAgY29uc3QgcGF5bG9hZCA9IGRhdGFbMF0gfHwge307XG4gICAgZGVidWcoJ1ttZXNzYWdlLXJlY2VpdmVyXTogc2VuZCBcIiVzXCInLCBldmVudCwgcGF5bG9hZCk7XG4gICAgdGhpcy5zZW5kZXJQb3J0LnBvc3RNZXNzYWdlKHsgdHlwZTogZXZlbnQsIHBheWxvYWQgfSk7XG4gIH1cbn07XG52YXIgTWVzc2FnZVNlbmRlciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IodGFyZ2V0KSB7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5lbWl0dGVyID0gbmV3IEV2ZW50VGFyZ2V0KCk7XG4gICAgdGhpcy5jaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gICAgdGhpcy5yZWNlaXZlclBvcnQgPSB0aGlzLmNoYW5uZWwucG9ydDE7XG4gICAgY29uc3QgcmVjZWl2ZXJSZWFkeVByb21pc2UgPSBuZXcgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UuRGVmZXJyZWRQcm9taXNlKCk7XG4gICAgY29uc3QgaGFuZHNoYWtlTGlzdGVuZXIgPSAobWVzc2FnZSkgPT4ge1xuICAgICAgaWYgKG1lc3NhZ2UuZGF0YS50eXBlID09PSBcImludGVybmFsL3JlYWR5XCIpIHtcbiAgICAgICAgZGVidWcoXCJbbWVzc2FnZS1zZW5kZXJdOiBydW50aW1lIGlzIHJlYWR5XCIpO1xuICAgICAgICByZWNlaXZlclJlYWR5UHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgaGFuZHNoYWtlTGlzdGVuZXIpO1xuICAgIHJlY2VpdmVyUmVhZHlQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRzaGFrZUxpc3RlbmVyKTtcbiAgICB9KTtcbiAgICB0aGlzLnJlY2VpdmVyUmVhZHlQcm9taXNlID0gcmVjZWl2ZXJSZWFkeVByb21pc2U7XG4gICAgdGhpcy5yZWNlaXZlclBvcnQub25tZXNzYWdlID0gKGV2dCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IGV2dC5kYXRhO1xuICAgICAgaWYgKGRhdGEudHlwZSAhPSBudWxsKSB7XG4gICAgICAgIGRlYnVnKCdbbWVzc2FnZS1zZW5kZXJdOiBlbWl0dGluZyBcIiVzXCIgZXZlbnQuLi4nLCBkYXRhLnR5cGUsIGRhdGEucGF5bG9hZCk7XG4gICAgICAgIHRoaXMuZW1pdHRlci5kaXNwYXRjaEV2ZW50KG5ldyBNZXNzYWdlRXZlbnQoZGF0YS50eXBlLCB7IGRhdGE6IGRhdGEucGF5bG9hZCB9KSk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBlbWl0dGVyO1xuICBjaGFubmVsO1xuICByZWNlaXZlclBvcnQ7XG4gIHJlY2VpdmVyUmVhZHlQcm9taXNlO1xuICBhc3luYyBoYW5kc2hha2UoKSB7XG4gICAgY29uc3QgaGFuZHNoYWtlUHJvbWlzZSA9IG5ldyBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZS5EZWZlcnJlZFByb21pc2UoKTtcbiAgICBhd2FpdCB0aGlzLnJlY2VpdmVyUmVhZHlQcm9taXNlO1xuICAgIGRlYnVnKFwiW21lc3NhZ2Utc2VuZGVyXTogc2VuZGluZyBoYW5kc2hha2VcIik7XG4gICAgdGhpcy50YXJnZXQucG9zdE1lc3NhZ2UoXG4gICAgICB7XG4gICAgICAgIHR5cGU6IFwiaW50ZXJuYWwvaGFuZHNoYWtlXCJcbiAgICAgIH0sXG4gICAgICBcIipcIixcbiAgICAgIFt0aGlzLmNoYW5uZWwucG9ydDJdXG4gICAgKTtcbiAgICB0aGlzLm9uKFwiaW50ZXJuYWwvaGFuZHNoYWtlL2RvbmVcIiwgKCkgPT4ge1xuICAgICAgaGFuZHNoYWtlUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICBjbGVhclRpbWVvdXQocmVqZWN0aW9uVGltZW91dCk7XG4gICAgfSk7XG4gICAgY29uc3QgcmVqZWN0aW9uVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaGFuZHNoYWtlUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiTWVzc2FnZVNlbmRlcjogSGFuZHNoYWtlIHRpbWVvdXRcIikpO1xuICAgIH0sIDVlMyk7XG4gICAgcmV0dXJuIGhhbmRzaGFrZVByb21pc2U7XG4gIH1cbiAgb24oZXZlbnQsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgZGVidWcoJ1ttZXNzYWdlLXNlbmRlcl06IGFkZCBsaXN0ZW5lciBcIiVzXCInLCBldmVudCk7XG4gICAgdGhpcy5lbWl0dGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBldmVudCxcbiAgICAgIChtZXNzYWdlKSA9PiB7XG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgTWVzc2FnZUV2ZW50KSB7XG4gICAgICAgICAgbGlzdGVuZXIobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgfVxuICBvZmYoZXZlbnQsIGxpc3RlbmVyLCBvcHRpb25zKSB7XG4gICAgdGhpcy5lbWl0dGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgfVxuICBhc3luYyBzZW5kKGV2ZW50LCAuLi5kYXRhKSB7XG4gICAgY29uc3Qgb3BlcmF0aW9uUHJvbWlzZSA9IG5ldyBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZS5EZWZlcnJlZFByb21pc2UoKTtcbiAgICBjb25zdCBvcGVyYXRpb25JZCA9ICgwLCBpbXBvcnRfY3VpZC5kZWZhdWx0KSgpO1xuICAgIGNvbnN0IHBheWxvYWQgPSBkYXRhWzBdIHx8IHt9O1xuICAgIGRlYnVnKCdbbWVzc2FnZS1zZW5kZXJdOiBzZW5kIFwiJXNcIiAoJXMpJywgZXZlbnQsIG9wZXJhdGlvbklkLCBwYXlsb2FkKTtcbiAgICB0aGlzLnJlY2VpdmVyUG9ydC5wb3N0TWVzc2FnZSh7IHR5cGU6IGV2ZW50LCBwYXlsb2FkOiB7IG9wZXJhdGlvbklkLCBwYXlsb2FkIH0gfSk7XG4gICAgZGVidWcoJ1ttZXNzYWdlLXNlbmRlcl06IGFkZGluZyBkb25lIGxpc3RlbmVyIGZvciBcIiVzXCIgKCVzKScsIGV2ZW50LCBvcGVyYXRpb25JZCk7XG4gICAgY29uc3QgaGFuZGxlT3BlcmF0aW9uRG9uZSA9IChkb25lRXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgZGF0YTogZGF0YTIgfSA9IGRvbmVFdmVudDtcbiAgICAgIGlmIChkYXRhMi5vcGVyYXRpb25JZCA9PT0gb3BlcmF0aW9uSWQpIHtcbiAgICAgICAgY29uc3QgbGlzdGVuZXJQYXlsb2FkID0gZGF0YTIubGlzdGVuZXJQYXlsb2FkIHx8IHt9O1xuICAgICAgICBkZWJ1ZygnW21lc3NhZ2Utc2VuZGVyXTogcmVzb2x2aW5nIFwiJXMgKCVzKSBwcm9taXNlIScsIGV2ZW50LCBvcGVyYXRpb25JZCk7XG4gICAgICAgIG9wZXJhdGlvblByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgLi4ubGlzdGVuZXJQYXlsb2FkLFxuICAgICAgICAgIG9wZXJhdGlvbklkOiBkYXRhMi5vcGVyYXRpb25JZFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZU9wZXJhdGlvbkZhaWxlZCA9IChmYWlsRXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgZGF0YTogZGF0YTIgfSA9IGZhaWxFdmVudDtcbiAgICAgIGlmIChkYXRhMi5vcGVyYXRpb25JZCA9PT0gb3BlcmF0aW9uSWQpIHtcbiAgICAgICAgZGVidWcoJ1ttZXNzYWdlLXNlbmRlcl06IHJlamVjdGluZyBcIiVzICglcykgcHJvbWlzZSEnLCBldmVudCwgb3BlcmF0aW9uSWQpO1xuICAgICAgICBvcGVyYXRpb25Qcm9taXNlLnJlamVjdChkYXRhMi5lcnJvcik7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLm9uKFwiaW50ZXJuYWwvb3BlcmF0aW9uL2RvbmVcIiwgaGFuZGxlT3BlcmF0aW9uRG9uZSk7XG4gICAgdGhpcy5vbihcImludGVybmFsL29wZXJhdGlvbi9mYWlsZWRcIiwgaGFuZGxlT3BlcmF0aW9uRmFpbGVkKTtcbiAgICByZXR1cm4gb3BlcmF0aW9uUHJvbWlzZS5maW5hbGx5KCgpID0+IHtcbiAgICAgIHRoaXMuZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKFwiaW50ZXJuYWwvb3BlcmF0aW9uL2RvbmVcIiwgaGFuZGxlT3BlcmF0aW9uRG9uZSk7XG4gICAgICB0aGlzLmVtaXR0ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImludGVybmFsL29wZXJhdGlvbi9mYWlsZWRcIiwgaGFuZGxlT3BlcmF0aW9uRmFpbGVkKTtcbiAgICB9KTtcbiAgfVxufTtcblxuLy8gc3JjL05vZGVib3gudHNcbnZhciBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZTMgPSBfX3RvRVNNKHJlcXVpcmVfYnVpbGQoKSk7XG5cbi8vIHNyYy9tb2R1bGVzL2ZzLnRzXG52YXIgaW1wb3J0X2N1aWQyID0gX190b0VTTShyZXF1aXJlX2N1aWQoKSk7XG52YXIgRmlsZVN5c3RlbUFwaSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY2hhbm5lbCkge1xuICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG4gIH1cbiAgYXN5bmMgaW5pdChmaWxlcykge1xuICAgIGF3YWl0IHRoaXMuY2hhbm5lbC5zZW5kKFwiZnMvaW5pdFwiLCB7IGZpbGVzIH0pO1xuICB9XG4gIGFzeW5jIHJlYWRGaWxlKHBhdGgsIGVuY29kaW5nKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNoYW5uZWwuc2VuZChcImZzL3JlYWRGaWxlXCIsIHsgcGF0aCwgZW5jb2RpbmcgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZm9ybWF0KCdGYWlsZWQgdG8gcmVhZCBmaWxlIGF0IHBhdGggXCIlc1wiJywgcGF0aCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkZpbGUgbm90IGZvdW5kXCIpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxuICBhc3luYyB3cml0ZUZpbGUocGF0aCwgY29udGVudCwgb3B0aW9ucykge1xuICAgIGxldCBlbmNvZGluZyA9IHZvaWQgMDtcbiAgICBsZXQgcmVjdXJzaXZlID0gZmFsc2U7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBlbmNvZGluZyA9IG9wdGlvbnMuZW5jb2Rpbmc7XG4gICAgICByZWN1cnNpdmUgPSAhIW9wdGlvbnMucmVjdXJzaXZlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGVuY29kaW5nID0gb3B0aW9ucztcbiAgICB9XG4gICAgYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy93cml0ZUZpbGVcIiwgeyBwYXRoLCBjb250ZW50LCBlbmNvZGluZywgcmVjdXJzaXZlIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIHdyaXRlIGZpbGUgYXQgcGF0aCBcIiVzXCInLCBwYXRoKSwgeyBjYXVzZTogZXJyb3IgfSk7XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgcmVhZGRpcihwYXRoKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNoYW5uZWwuc2VuZChcImZzL3JlYWRkaXJcIiwgeyBwYXRoIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIHJlYWQgZGlyZWN0b3J5IGF0IHBhdGggXCIlc1wiJywgcGF0aCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICAgIGlmICghcmVzcG9uc2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkRpcmVjdG9yeSBub3QgZm91bmRcIik7XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICB9XG4gIGFzeW5jIG1rZGlyKHBhdGgsIG9wdGlvbnMpIHtcbiAgICBjb25zdCByZWN1cnNpdmUgPSAhIW9wdGlvbnM/LnJlY3Vyc2l2ZTtcbiAgICBhd2FpdCB0aGlzLmNoYW5uZWwuc2VuZChcImZzL21rZGlyXCIsIHsgcGF0aCwgcmVjdXJzaXZlIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnRmFpbGVkIHRvIG1ha2UgZGlyZWN0b3J5IGF0IHBhdGggXCIlc1wiJywgcGF0aCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICB9XG4gIGFzeW5jIHN0YXQocGF0aCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy9zdGF0XCIsIHsgcGF0aCB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihmb3JtYXQoJ0ZhaWxlZCB0byBzdGF0IGZpbGUgYXQgcGF0aCBcIiVzXCInLCBwYXRoKSwgeyBjYXVzZTogZXJyb3IgfSk7XG4gICAgfSk7XG4gICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmlsZSBub3QgZm91bmRcIik7XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICB9XG4gIGFzeW5jIHJtKHBhdGgsIG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGZvcmNlLCByZWN1cnNpdmUgfSA9IG9wdGlvbnMgfHwge307XG4gICAgYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJmcy9ybVwiLCB7IHBhdGgsIGZvcmNlLCByZWN1cnNpdmUgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZm9ybWF0KCdGYWlsZWQgdG8gcmVtb3ZlIGZpbGUgYXQgcGF0aCBcIiVzXCInLCBwYXRoKSwgeyBjYXVzZTogZXJyb3IgfSk7XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgd2F0Y2goaW5jbHVkZXMsIGV4Y2x1ZGVzLCBsaXN0ZW5lcikge1xuICAgIGNvbnN0IHdhdGNoZXJJZCA9ICgwLCBpbXBvcnRfY3VpZDIuZGVmYXVsdCkoKTtcbiAgICBhd2FpdCB0aGlzLmNoYW5uZWwuc2VuZChcImZzL3dhdGNoXCIsIHsgd2F0Y2hlcklkLCBpbmNsdWRlcywgZXhjbHVkZXMgfSk7XG4gICAgdGhpcy5jaGFubmVsLm9uKFwiZnMvd2F0Y2gtZXZlbnRcIiwgKHsgZGF0YSB9KSA9PiB7XG4gICAgICBpZiAoZGF0YS53YXRjaGVySWQgPT09IHdhdGNoZXJJZCAmJiBsaXN0ZW5lcikge1xuICAgICAgICBjb25zdCBldnQgPSB7IC4uLmRhdGEgfTtcbiAgICAgICAgZGVsZXRlIGV2dC53YXRjaGVySWQ7XG4gICAgICAgIGxpc3RlbmVyKGV2dCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRpc3Bvc2U6ICgpID0+IHRoaXMuY2hhbm5lbC5zZW5kKFwiZnMvdW53YXRjaFwiLCB7IHdhdGNoZXJJZCB9KVxuICAgIH07XG4gIH1cbn07XG5cbi8vIHNyYy9tb2R1bGVzL3NoZWxsLnRzXG52YXIgaW1wb3J0X3N0cmljdF9ldmVudF9lbWl0dGVyID0gX190b0VTTShyZXF1aXJlX2xpYigpKTtcbnZhciBTaGVsbEFwaSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY2hhbm5lbCkge1xuICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG4gIH1cbiAgY3JlYXRlKCkge1xuICAgIHJldHVybiBuZXcgU2hlbGxQcm9jZXNzKHRoaXMuY2hhbm5lbCk7XG4gIH1cbn07XG52YXIgU2hlbGxQcm9jZXNzID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihjaGFubmVsKSB7XG4gICAgdGhpcy5jaGFubmVsID0gY2hhbm5lbDtcbiAgICB0aGlzLnN0YXRlID0gXCJydW5uaW5nXCI7XG4gICAgdGhpcy5zdGRvdXQgPSBuZXcgaW1wb3J0X3N0cmljdF9ldmVudF9lbWl0dGVyLkVtaXR0ZXIoKTtcbiAgICB0aGlzLnN0ZGVyciA9IG5ldyBpbXBvcnRfc3RyaWN0X2V2ZW50X2VtaXR0ZXIuRW1pdHRlcigpO1xuICAgIHRoaXMuc3RkaW4gPSB7XG4gICAgICB3cml0ZTogKGRhdGEpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmlkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHdyaXRlIHRvIHN0ZGluLCBubyBwcm9jZXNzIGlzIGN1cnJlbnRseSBydW5uaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWwuc2VuZChcInNoZWxsL3N0ZGluXCIsIHsgZGF0YSwgd29ya2VySWQ6IHRoaXMuaWQgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmZvcndhcmRTdGRFdmVudHMoKTtcbiAgfVxuICBpZDtcbiAgc3RhdGU7XG4gIHN0ZG91dDtcbiAgc3RkZXJyO1xuICBzdGRpbjtcbiAgZm9yd2FyZFN0ZEV2ZW50cygpIHtcbiAgICB0aGlzLmNoYW5uZWwub24oXCJ3b3JrZXIvdHR5XCIsIChtZXNzYWdlKSA9PiB7XG4gICAgICBjb25zdCB7IGRhdGEgfSA9IG1lc3NhZ2U7XG4gICAgICBpZiAoZGF0YS53b3JrZXJJZCAhPT0gdGhpcy5pZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzd2l0Y2ggKGRhdGEucGF5bG9hZC50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJvdXRcIjoge1xuICAgICAgICAgIHRoaXMuc3Rkb3V0LmVtaXQoXCJkYXRhXCIsIGRhdGEucGF5bG9hZC5kYXRhKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlIFwiZXJyXCI6IHtcbiAgICAgICAgICB0aGlzLnN0ZGVyci5lbWl0KFwiZGF0YVwiLCBkYXRhLnBheWxvYWQuZGF0YSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBhc3luYyBydW5Db21tYW5kKGNvbW1hbmQsIGFyZ3MsIG9wdGlvbnMgPSB7fSkge1xuICAgIGludmFyaWFudCghdGhpcy5pZCwgJ0ZhaWxlZCB0byBydW4gXCJydW5Db21tYW5kXCIgb24gYSBTaGVsbFByb2Nlc3M6IHRoZXJlIGlzIGFscmVhZHkgYSBwcm9jZXNzIHJ1bm5pbmcuJyk7XG4gICAgY29uc3Qgc2hlbGxJbmZvID0gYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJzaGVsbC9ydW5Db21tYW5kXCIsIHsgY29tbWFuZCwgYXJncywgb3B0aW9ucyB9KTtcbiAgICBpbnZhcmlhbnQoc2hlbGxJbmZvLCAnRmFpbGVkIHRvIHJ1biBcInJ1bkNvbW1hbmRcIiBvbiBhIFNoZWxsUHJvY2Vzczogd2FzIG5vdCBhYmxlIHRvIHJldHJpZXZlIGEgcnVubmluZyBwcm9jZXNzLicpO1xuICAgIHRoaXMuaWQgPSBzaGVsbEluZm8uaWQ7XG4gICAgdGhpcy5zdGF0ZSA9IFwicnVubmluZ1wiO1xuICAgIHJldHVybiBzaGVsbEluZm87XG4gIH1cbiAgYXN5bmMgb24obWVzc2FnZSwgbGlzdGVuZXIpIHtcbiAgICBzd2l0Y2ggKG1lc3NhZ2UpIHtcbiAgICAgIGNhc2UgXCJwcm9ncmVzc1wiOiB7XG4gICAgICAgIHRoaXMuY2hhbm5lbC5vbihcIndvcmtlci9wcm9ncmVzc1wiLCAoeyBkYXRhIH0pID0+IHtcbiAgICAgICAgICBsaXN0ZW5lcihkYXRhLnN0YXR1cyk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjYXNlIFwiZXhpdFwiOiB7XG4gICAgICAgIHRoaXMuY2hhbm5lbC5vbihcIndvcmtlci9leGl0XCIsICh7IGRhdGEgfSkgPT4ge1xuICAgICAgICAgIGlmIChkYXRhLndvcmtlcklkID09PSB0aGlzLmlkKSB7XG4gICAgICAgICAgICBsaXN0ZW5lcihkYXRhLmV4aXRDb2RlLCBkYXRhLmVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGFzeW5jIGtpbGwoKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5pZCxcbiAgICAgICdGYWlsZWQgdG8gcnVuIFwia2lsbFwiIG9uIGEgU2hlbGxQcm9jZXNzOiB0aGVyZSBpcyBubyBwcm9jZXNzIHJ1bm5pbmcuIERpZCB5b3UgZm9yZ2V0IHRvIHJ1biBpdD8nXG4gICAgKTtcbiAgICB0aGlzLnN0YXRlID0gXCJpZGxlXCI7XG4gICAgYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJzaGVsbC9leGl0XCIsIHsgaWQ6IHRoaXMuaWQgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZm9ybWF0KCdGYWlsZWQgdG8ga2lsbCBzaGVsbCB3aXRoIElEIFwiJXNcIicsIHRoaXMuaWQpLCB7IGNhdXNlOiBlcnJvciB9KTtcbiAgICB9KTtcbiAgICB0aGlzLmlkID0gdm9pZCAwO1xuICB9XG59O1xuXG4vLyBzcmMvbW9kdWxlcy9wcmV2aWV3LnRzXG52YXIgaW1wb3J0X2RlZmVycmVkX3Byb21pc2UyID0gX190b0VTTShyZXF1aXJlX2J1aWxkKCkpO1xudmFyIFRJTUVPVVQgPSAyZTQ7XG52YXIgUHJldmlld0FwaSA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoY2hhbm5lbCkge1xuICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG4gIH1cbiAgYXN5bmMgd2FpdEZvcihwYXlsb2FkLCBwcmVkaWNhdGUsIHRpbWVvdXQgPSBUSU1FT1VUKSB7XG4gICAgY29uc3QgcmVhZHlQcm9taXNlID0gbmV3IGltcG9ydF9kZWZlcnJlZF9wcm9taXNlMi5EZWZlcnJlZFByb21pc2UoKTtcbiAgICBjb25zdCByZWplY3RUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZWFkeVByb21pc2UucmVqZWN0KCk7XG4gICAgfSwgdGltZW91dCk7XG4gICAgY29uc3QgcHJldmlld0luZm9ybWF0aW9uID0gYXdhaXQgdGhpcy5jaGFubmVsLnNlbmQoXCJwcmV2aWV3L2dldC9pbmZvXCIsIHBheWxvYWQpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgcmVhZHlQcm9taXNlLnJlamVjdChcbiAgICAgICAgbmV3IEVycm9yKFxuICAgICAgICAgIGZvcm1hdChcbiAgICAgICAgICAgICdGYWlsZWQgdG8gbG9vayB1cCBwcmV2aWV3IGluZm9ybWF0aW9uIGZvciBzaGVsbCBJRCBcIiVzXCIgKHBvcnQ6ICVkKScsXG4gICAgICAgICAgICBwYXlsb2FkLnNvdXJjZVNoZWxsSWQsXG4gICAgICAgICAgICBwYXlsb2FkLnBvcnRcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfSk7XG4gICAgY29uc3QgZm91bmRQcmV2aWV3ID0gcHJldmlld0luZm9ybWF0aW9uICYmIHByZWRpY2F0ZShwcmV2aWV3SW5mb3JtYXRpb24pO1xuICAgIGlmIChmb3VuZFByZXZpZXcpIHtcbiAgICAgIHJlYWR5UHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgdXJsOiBwcmV2aWV3SW5mb3JtYXRpb24udXJsLFxuICAgICAgICBwb3J0OiBwcmV2aWV3SW5mb3JtYXRpb24ucG9ydCxcbiAgICAgICAgc291cmNlU2hlbGxJZDogcHJldmlld0luZm9ybWF0aW9uLnNvdXJjZVNoZWxsSWRcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmNoYW5uZWwub24oXCJwcmV2aWV3L3BvcnQvcmVhZHlcIiwgKHsgZGF0YSB9KSA9PiB7XG4gICAgICBpZiAoIWZvdW5kUHJldmlldyAmJiBwcmVkaWNhdGUoZGF0YSkpIHtcbiAgICAgICAgcmVhZHlQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIHVybDogZGF0YS51cmwsXG4gICAgICAgICAgcG9ydDogZGF0YS5wb3J0LFxuICAgICAgICAgIHNvdXJjZVNoZWxsSWQ6IGRhdGEuc291cmNlU2hlbGxJZFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVhZHlQcm9taXNlLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHJlamVjdFRpbWVvdXQpO1xuICAgIH0pO1xuICB9XG4gIGFzeW5jIGdldEJ5U2hlbGxJZChzb3VyY2VTaGVsbElkLCB0aW1lb3V0KSB7XG4gICAgcmV0dXJuIHRoaXMud2FpdEZvcih7IHNvdXJjZVNoZWxsSWQgfSwgKGRhdGEpID0+IGRhdGEuc291cmNlU2hlbGxJZCA9PT0gc291cmNlU2hlbGxJZCwgdGltZW91dCkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZm9ybWF0KCdGYWlsZWQgdG8gZ2V0IHNoZWxsIGJ5IElEIFwiJXNcIicsIHNvdXJjZVNoZWxsSWQpLCB7IGNhdXNlOiBlcnJvciB9KTtcbiAgICB9KTtcbiAgfVxuICBhc3luYyB3YWl0Rm9yUG9ydChwb3J0LCB0aW1lb3V0KSB7XG4gICAgcmV0dXJuIHRoaXMud2FpdEZvcih7IHBvcnQgfSwgKGRhdGEpID0+IGRhdGEucG9ydCA9PT0gcG9ydCwgdGltZW91dCkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZm9ybWF0KFwiRmFpbGVkIHRvIGF3YWl0IHBvcnQgJWRcIiwgcG9ydCksIHsgY2F1c2U6IGVycm9yIH0pO1xuICAgIH0pO1xuICB9XG59O1xuXG4vLyBzcmMvTm9kZWJveC50c1xudmFyIERFRkFVTFRfUlVOVElNRV9VUkwgPSBcImh0dHBzOi8vbm9kZWJveC1ydW50aW1lLmNvZGVzYW5kYm94LmlvXCI7XG52YXIgZGVidWcyID0gY3JlYXRlRGVidWcoXCJlbXVsYXRvclwiKTtcbnZhciBOb2RlYm94ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBpbnZhcmlhbnQoXG4gICAgICB0aGlzLm9wdGlvbnMuaWZyYW1lLFxuICAgICAgJ0ZhaWxlZCB0byBjcmVhdGUgYSBOb2RlYm94OiBleHBlY3RlZCBcImlmcmFtZVwiIGFyZ3VtZW50IHRvIGJlIGEgcmVmZXJlbmNlIHRvIGFuIDxpZnJhbWU+IGVsZW1lbnQgYnV0IGdvdCAlaicsXG4gICAgICB0aGlzLm9wdGlvbnMuaWZyYW1lXG4gICAgKTtcbiAgICB0aGlzLnVybCA9IHRoaXMub3B0aW9ucy5ydW50aW1lVXJsIHx8IERFRkFVTFRfUlVOVElNRV9VUkw7XG4gICAgdGhpcy5pc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICB9XG4gIGNoYW5uZWwgPSBudWxsO1xuICBpc0Nvbm5lY3RlZDtcbiAgdXJsO1xuICBmaWxlU3lzdGVtQXBpID0gbnVsbDtcbiAgc2hlbGxBcGkgPSBudWxsO1xuICBwcmV2aWV3QXBpID0gbnVsbDtcbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCB7IGlmcmFtZSwgY2RuVXJsIH0gPSB0aGlzLm9wdGlvbnM7XG4gICAgZGVidWcyKFwiW21lc3NhZ2Utc2VuZGVyXTogQ29ubmVjdGluZyB0byBub2RlIGVtdWxhdG9yLi4uXCIpO1xuICAgIGNvbnN0IGNvbm5lY3Rpb25Qcm9taXNlID0gbmV3IGltcG9ydF9kZWZlcnJlZF9wcm9taXNlMy5EZWZlcnJlZFByb21pc2UoKTtcbiAgICBpZiAoIXRoaXMudXJsKSB7XG4gICAgICBjb25uZWN0aW9uUHJvbWlzZS5yZWplY3QoXG4gICAgICAgIG5ldyBFcnJvcihcIk5vZGVib3ggVVJMIGlzIG1pc3NpbmcuIERpZCB5b3UgZm9yZ2V0IHRvIHByb3ZpZGUgaXQgd2hlbiBjcmVhdGluZyB0aGlzIE5vZGVib3ggaW5zdGFuY2U/XCIpXG4gICAgICApO1xuICAgIH1cbiAgICBpbnZhcmlhbnQoXG4gICAgICBpZnJhbWUuY29udGVudFdpbmRvdyxcbiAgICAgIFwiRmFpbGVkIHRvIGNyZWF0ZSBhIE1lc3NhZ2VDaGFubmVsIHdpdGggdGhlIE5vZGVib3ggaWZyYW1lOiBubyBjb250ZW50IHdpbmRvdyBmb3VuZFwiXG4gICAgKTtcbiAgICB0aGlzLmNoYW5uZWwgPSBuZXcgTWVzc2FnZVNlbmRlcihpZnJhbWUuY29udGVudFdpbmRvdyk7XG4gICAgY29uc3QgZnJhbWVMb2FkUHJvbWlzZSA9IG5ldyBpbXBvcnRfZGVmZXJyZWRfcHJvbWlzZTMuRGVmZXJyZWRQcm9taXNlKCk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLnVybCk7XG4gICAgaWZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBcImxvYWRcIixcbiAgICAgICgpID0+IHtcbiAgICAgICAgZnJhbWVMb2FkUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICB9LFxuICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICApO1xuICAgIGlmcmFtZS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJlcnJvclwiLFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIGZyYW1lTG9hZFByb21pc2UucmVqZWN0KGV2ZW50LmVycm9yKTtcbiAgICAgIH0sXG4gICAgICB7IG9uY2U6IHRydWUgfVxuICAgICk7XG4gICAgYXdhaXQgZnJhbWVMb2FkUHJvbWlzZTtcbiAgICBkZWJ1ZzIoXCJbbWVzc2FnZS1zZW5kZXJdOiBJRnJhbWUgbG9hZGVkLi4uXCIpO1xuICAgIGF3YWl0IHRoaXMuY2hhbm5lbC5oYW5kc2hha2UoKTtcbiAgICBkZWJ1ZzIoXCJbbWVzc2FnZS1zZW5kZXJdOiBIYW5kc2hha2UgY29tcGxldGVkLi4uXCIpO1xuICAgIHRoaXMuY2hhbm5lbC5zZW5kKFwiY29ubmVjdFwiLCB7XG4gICAgICBjZG5VcmxcbiAgICB9KTtcbiAgICB0aGlzLmNoYW5uZWwub24oXCJydW50aW1lL3JlYWR5XCIsICgpID0+IHtcbiAgICAgIGNvbm5lY3Rpb25Qcm9taXNlLnJlc29sdmUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gY29ubmVjdGlvblByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICBkZWJ1ZzIoXCJbbWVzc2FnZS1zZW5kZXJdOiBDb25uZWN0ZWQgdG8gcnVudGltZS4uLlwiKTtcbiAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSB0cnVlO1xuICAgIH0pO1xuICB9XG4gIGdldCBmcygpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICB0aGlzLmlzQ29ubmVjdGVkLFxuICAgICAgJ0ZhaWxlZCB0byBhY2Nlc3MgdGhlIEZpbGUgU3lzdGVtIEFQSTogY29uc3VtZXIgaXMgbm90IGNvbm5lY3RlZC4gRGlkIHlvdSBmb3JnZXQgdG8gcnVuIFwiY29ubmVjdCgpXCI/J1xuICAgICk7XG4gICAgaWYgKHRoaXMuZmlsZVN5c3RlbUFwaSkge1xuICAgICAgcmV0dXJuIHRoaXMuZmlsZVN5c3RlbUFwaTtcbiAgICB9XG4gICAgdGhpcy5maWxlU3lzdGVtQXBpID0gbmV3IEZpbGVTeXN0ZW1BcGkodGhpcy5jaGFubmVsKTtcbiAgICByZXR1cm4gdGhpcy5maWxlU3lzdGVtQXBpO1xuICB9XG4gIGdldCBzaGVsbCgpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICB0aGlzLmlzQ29ubmVjdGVkLFxuICAgICAgJ0ZhaWxlZCB0byBhY2Nlc3MgdGhlIFNoZWxsIEFQSTogY29uc3VtZXIgaXMgbm90IGNvbm5lY3RlZC4gRGlkIHlvdSBmb3JnZXQgdG8gcnVuIFwiY29ubmVjdCgpXCI/J1xuICAgICk7XG4gICAgaWYgKHRoaXMuc2hlbGxBcGkpIHtcbiAgICAgIHJldHVybiB0aGlzLnNoZWxsQXBpO1xuICAgIH1cbiAgICB0aGlzLnNoZWxsQXBpID0gbmV3IFNoZWxsQXBpKHRoaXMuY2hhbm5lbCk7XG4gICAgcmV0dXJuIHRoaXMuc2hlbGxBcGk7XG4gIH1cbiAgZ2V0IHByZXZpZXcoKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5pc0Nvbm5lY3RlZCxcbiAgICAgICdGYWlsZWQgdG8gYWNjZXNzIHRoZSBQcmV2aWV3IEFQSTogY29uc3VtZXIgaXMgbm90IGNvbm5lY3RlZC4gRGlkIHlvdSBmb3JnZXQgdG8gcnVuIFwiY29ubmVjdCgpXCI/J1xuICAgICk7XG4gICAgaWYgKHRoaXMucHJldmlld0FwaSkge1xuICAgICAgcmV0dXJuIHRoaXMucHJldmlld0FwaTtcbiAgICB9XG4gICAgdGhpcy5wcmV2aWV3QXBpID0gbmV3IFByZXZpZXdBcGkodGhpcy5jaGFubmVsKTtcbiAgICByZXR1cm4gdGhpcy5wcmV2aWV3QXBpO1xuICB9XG59O1xuXG4vLyBzcmMvcnVudGltZS1wcm90b2NvbC50eXBlcy50c1xudmFyIElOSkVDVF9NRVNTQUdFX1RZUEUgPSBcIklOSkVDVF9BTkRfSU5WT0tFXCI7XG52YXIgUFJFVklFV19MT0FERURfTUVTU0FHRV9UWVBFID0gXCJQUkVWSUVXX0xPQURFRFwiO1xuZXhwb3J0IHtcbiAgSU5KRUNUX01FU1NBR0VfVFlQRSxcbiAgTWVzc2FnZVJlY2VpdmVyLFxuICBNZXNzYWdlU2VuZGVyLFxuICBOb2RlYm94LFxuICBQUkVWSUVXX0xPQURFRF9NRVNTQUdFX1RZUEVcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@codesandbox/nodebox/build/index.mjs\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs":
/*!**************************************************************************!*\
  !*** ./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs ***!
  \**************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   S: function() { return /* binding */ SandpackClient; }\n/* harmony export */ });\n/* harmony import */ var dequal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dequal */ \"(app-pages-browser)/./node_modules/dequal/dist/index.mjs\");\n\n\nvar SandpackClient = /** @class */ (function () {\n    function SandpackClient(iframeSelector, sandboxSetup, options) {\n        if (options === void 0) { options = {}; }\n        this.status = \"idle\";\n        this.options = options;\n        this.sandboxSetup = sandboxSetup;\n        this.iframeSelector = iframeSelector;\n    }\n    /**\n     * Clients handles\n     */\n    SandpackClient.prototype.updateOptions = function (options) {\n        if (!(0,dequal__WEBPACK_IMPORTED_MODULE_0__.dequal)(this.options, options)) {\n            this.options = options;\n            this.updateSandbox();\n        }\n    };\n    SandpackClient.prototype.updateSandbox = function (_sandboxSetup, _isInitializationCompile) {\n        if (_sandboxSetup === void 0) { _sandboxSetup = this.sandboxSetup; }\n        throw Error(\"Method not implemented\");\n    };\n    SandpackClient.prototype.destroy = function () {\n        throw Error(\"Method not implemented\");\n    };\n    /**\n     * Bundler communication\n     */\n    SandpackClient.prototype.dispatch = function (_message) {\n        throw Error(\"Method not implemented\");\n    };\n    SandpackClient.prototype.listen = function (_listener) {\n        throw Error(\"Method not implemented\");\n    };\n    return SandpackClient;\n}());\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvYmFzZS04MGExZjc2MC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBZ0M7O0FBRWhDO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw4Q0FBTTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRThCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvYmFzZS04MGExZjc2MC5tanM/MjQ5ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXF1YWwgfSBmcm9tICdkZXF1YWwnO1xuXG52YXIgU2FuZHBhY2tDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2FuZHBhY2tDbGllbnQoaWZyYW1lU2VsZWN0b3IsIHNhbmRib3hTZXR1cCwgb3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICB0aGlzLnN0YXR1cyA9IFwiaWRsZVwiO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLnNhbmRib3hTZXR1cCA9IHNhbmRib3hTZXR1cDtcbiAgICAgICAgdGhpcy5pZnJhbWVTZWxlY3RvciA9IGlmcmFtZVNlbGVjdG9yO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGllbnRzIGhhbmRsZXNcbiAgICAgKi9cbiAgICBTYW5kcGFja0NsaWVudC5wcm90b3R5cGUudXBkYXRlT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIGlmICghZGVxdWFsKHRoaXMub3B0aW9ucywgb3B0aW9ucykpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNhbmRib3goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2FuZHBhY2tDbGllbnQucHJvdG90eXBlLnVwZGF0ZVNhbmRib3ggPSBmdW5jdGlvbiAoX3NhbmRib3hTZXR1cCwgX2lzSW5pdGlhbGl6YXRpb25Db21waWxlKSB7XG4gICAgICAgIGlmIChfc2FuZGJveFNldHVwID09PSB2b2lkIDApIHsgX3NhbmRib3hTZXR1cCA9IHRoaXMuc2FuZGJveFNldHVwOyB9XG4gICAgICAgIHRocm93IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICB9O1xuICAgIFNhbmRwYWNrQ2xpZW50LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWRcIik7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBCdW5kbGVyIGNvbW11bmljYXRpb25cbiAgICAgKi9cbiAgICBTYW5kcGFja0NsaWVudC5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoX21lc3NhZ2UpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkXCIpO1xuICAgIH07XG4gICAgU2FuZHBhY2tDbGllbnQucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uIChfbGlzdGVuZXIpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkXCIpO1xuICAgIH07XG4gICAgcmV0dXJuIFNhbmRwYWNrQ2xpZW50O1xufSgpKTtcblxuZXhwb3J0IHsgU2FuZHBhY2tDbGllbnQgYXMgUyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs":
/*!*******************************************************************************!*\
  !*** ./node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs ***!
  \*******************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SandpackNode: function() { return /* binding */ SandpackNode; }\n/* harmony export */ });\n/* harmony import */ var _types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../types-0877c553.mjs */ \"(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/types-0877c553.mjs\");\n/* harmony import */ var _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @codesandbox/nodebox */ \"(app-pages-browser)/./node_modules/@codesandbox/nodebox/build/index.mjs\");\n/* harmony import */ var _base_80a1f760_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../base-80a1f760.mjs */ \"(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/base-80a1f760.mjs\");\n/* harmony import */ var _consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../consoleHook-cdbe54ab.mjs */ \"(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs\");\n/* harmony import */ var outvariant__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! outvariant */ \"(app-pages-browser)/./node_modules/outvariant/lib/index.mjs\");\n/* harmony import */ var dequal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dequal */ \"(app-pages-browser)/./node_modules/dequal/dist/index.mjs\");\n\n\n\n\n\n\n\nfunction loadPreviewIframe(iframe, url) {\n    return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n        var contentWindow, TIME_OUT, MAX_MANY_TIRES, tries, timeout;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n            contentWindow = iframe.contentWindow;\n            (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.n)(contentWindow, \"Failed to await preview iframe: no content window found\");\n            TIME_OUT = 90000;\n            MAX_MANY_TIRES = 20;\n            tries = 0;\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n                    var triesToSetUrl = function () {\n                        var onLoadPage = function () {\n                            clearTimeout(timeout);\n                            tries = MAX_MANY_TIRES;\n                            resolve();\n                            iframe.removeEventListener(\"load\", onLoadPage);\n                        };\n                        if (tries >= MAX_MANY_TIRES) {\n                            reject((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.c)(\"Could not able to connect to preview.\"));\n                            return;\n                        }\n                        iframe.setAttribute(\"src\", url);\n                        timeout = setTimeout(function () {\n                            triesToSetUrl();\n                            iframe.removeEventListener(\"load\", onLoadPage);\n                        }, TIME_OUT);\n                        tries = tries + 1;\n                        iframe.addEventListener(\"load\", onLoadPage);\n                    };\n                    iframe.addEventListener(\"error\", function () { return reject(new Error(\"Iframe error\")); });\n                    iframe.addEventListener(\"abort\", function () { return reject(new Error(\"Aborted\")); });\n                    triesToSetUrl();\n                })];\n        });\n    });\n}\nvar setPreviewIframeProperties = function (iframe, options) {\n    iframe.style.border = \"0\";\n    iframe.style.width = options.width || \"100%\";\n    iframe.style.height = options.height || \"100%\";\n    iframe.style.overflow = \"hidden\";\n    iframe.allow = \"cross-origin-isolated\";\n};\n\n/* eslint-disable @typescript-eslint/ban-ts-comment, @typescript-eslint/explicit-function-return-type, no-restricted-globals, @typescript-eslint/no-explicit-any  */\nfunction setupHistoryListeners(_a) {\n    var scope = _a.scope;\n    // @ts-ignore\n    var origHistoryProto = window.history.__proto__;\n    var historyList = [];\n    var historyPosition = 0;\n    var dispatchMessage = function (url) {\n        parent.postMessage({\n            type: \"urlchange\",\n            url: url,\n            back: historyPosition > 0,\n            forward: historyPosition < historyList.length - 1,\n            channelId: scope.channelId,\n        }, \"*\");\n    };\n    function pushHistory(url, state) {\n        // remove \"future\" locations\n        historyList.splice(historyPosition + 1);\n        historyList.push({ url: url, state: state });\n        historyPosition = historyList.length - 1;\n    }\n    Object.assign(window.history, {\n        go: function (delta) {\n            var newPos = historyPosition + delta;\n            if (newPos >= 0 && newPos <= historyList.length - 1) {\n                historyPosition = newPos;\n                var _a = historyList[historyPosition], url = _a.url, state = _a.state;\n                origHistoryProto.replaceState.call(window.history, state, \"\", url);\n                var newURL = document.location.href;\n                dispatchMessage(newURL);\n                window.dispatchEvent(new PopStateEvent(\"popstate\", { state: state }));\n            }\n        },\n        back: function () {\n            window.history.go(-1);\n        },\n        forward: function () {\n            window.history.go(1);\n        },\n        pushState: function (state, title, url) {\n            origHistoryProto.replaceState.call(window.history, state, title, url);\n            pushHistory(url, state);\n            dispatchMessage(document.location.href);\n        },\n        replaceState: function (state, title, url) {\n            origHistoryProto.replaceState.call(window.history, state, title, url);\n            historyList[historyPosition] = { state: state, url: url };\n            dispatchMessage(document.location.href);\n        },\n    });\n    function handleMessage(_a) {\n        var data = _a.data;\n        if (data.type === \"urlback\") {\n            history.back();\n        }\n        else if (data.type === \"urlforward\") {\n            history.forward();\n        }\n        else if (data.type === \"refresh\") {\n            document.location.reload();\n        }\n    }\n    window.addEventListener(\"message\", handleMessage);\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction watchResize(_a) {\n    var scope = _a.scope;\n    var lastHeight = 0;\n    function getDocumentHeight() {\n        if (typeof window === \"undefined\")\n            return 0;\n        var body = document.body;\n        var html = document.documentElement;\n        return Math.max(body.scrollHeight, body.offsetHeight, html.offsetHeight);\n    }\n    function sendResizeEvent() {\n        var height = getDocumentHeight();\n        if (lastHeight !== height) {\n            window.parent.postMessage({\n                type: \"resize\",\n                height: height,\n                codesandbox: true,\n                channelId: scope.channelId,\n            }, \"*\");\n        }\n        lastHeight = height;\n    }\n    sendResizeEvent();\n    var throttle;\n    var observer = new MutationObserver(function () {\n        if (throttle === undefined) {\n            sendResizeEvent();\n            throttle = setTimeout(function () {\n                throttle = undefined;\n            }, 300);\n        }\n    });\n    observer.observe(document, {\n        attributes: true,\n        childList: true,\n        subtree: true,\n    });\n    /**\n     * Ideally we should only use a `MutationObserver` to trigger a resize event,\n     * however, we noted that it's not 100% reliable, so we went for polling strategy as well\n     */\n    setInterval(sendResizeEvent, 300);\n}\n\n/* eslint-disable @typescript-eslint/ban-ts-comment */\nvar scripts = [\n    { code: setupHistoryListeners.toString(), id: \"historyListener\" },\n    {\n        code: \"function consoleHook({ scope }) {\" + _consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.c + \"\\n};\",\n        id: \"consoleHook\",\n    },\n    { code: watchResize.toString(), id: \"watchResize\" },\n];\nvar injectScriptToIframe = function (iframe, channelId) {\n    scripts.forEach(function (_a) {\n        var _b;\n        var code = _a.code, id = _a.id;\n        var message = {\n            uid: id,\n            type: _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__.INJECT_MESSAGE_TYPE,\n            code: \"exports.activate = \".concat(code),\n            scope: { channelId: channelId },\n        };\n        (_b = iframe.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage(message, \"*\");\n    });\n};\n\n/* eslint-disable no-console,@typescript-eslint/no-explicit-any,prefer-rest-params,@typescript-eslint/explicit-module-boundary-types */\nvar SandpackNode = /** @class */ (function (_super) {\n    (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.g)(SandpackNode, _super);\n    function SandpackNode(selector, sandboxInfo, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, selector, sandboxInfo, (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)({}, options), { bundlerURL: options.bundlerURL })) || this;\n        _this._modulesCache = new Map();\n        _this.messageChannelId = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.g)();\n        _this._initPromise = null;\n        _this.emitter = new _consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.E();\n        // Assign iframes\n        _this.manageIframes(selector);\n        // Init emulator\n        _this.emulator = new _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__.Nodebox({\n            iframe: _this.emulatorIframe,\n            runtimeUrl: _this.options.bundlerURL,\n        });\n        // Trigger initial compile\n        _this.updateSandbox(sandboxInfo);\n        return _this;\n    }\n    // Initialize nodebox, should only ever be called once\n    SandpackNode.prototype._init = function (files) {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.emulator.connect()];\n                    case 1:\n                        _a.sent();\n                        // 2. Setup\n                        return [4 /*yield*/, this.emulator.fs.init(files)];\n                    case 2:\n                        // 2. Setup\n                        _a.sent();\n                        // 2.1 Other dependencies\n                        return [4 /*yield*/, this.globalListeners()];\n                    case 3:\n                        // 2.1 Other dependencies\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * It initializes the emulator and provide it with files, template and script to run\n     */\n    SandpackNode.prototype.compile = function (files) {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var shellId, err_1;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 5, , 6]);\n                        // 1. Init\n                        this.status = \"initializing\";\n                        this.dispatch({ type: \"start\", firstLoad: true });\n                        if (!this._initPromise) {\n                            this._initPromise = this._init(files);\n                        }\n                        return [4 /*yield*/, this._initPromise];\n                    case 1:\n                        _a.sent();\n                        this.dispatch({ type: \"connected\" });\n                        return [4 /*yield*/, this.createShellProcessFromTask(files)];\n                    case 2:\n                        shellId = (_a.sent()).id;\n                        // 4. Launch Preview\n                        return [4 /*yield*/, this.createPreviewURLFromId(shellId)];\n                    case 3:\n                        // 4. Launch Preview\n                        _a.sent();\n                        return [4 /*yield*/, this.setLocationURLIntoIFrame()];\n                    case 4:\n                        _a.sent();\n                        // 5. Returns to consumer\n                        this.dispatchDoneMessage();\n                        return [3 /*break*/, 6];\n                    case 5:\n                        err_1 = _a.sent();\n                        this.dispatch({\n                            type: \"action\",\n                            action: \"notification\",\n                            notificationType: \"error\",\n                            title: (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.a)(err_1),\n                        });\n                        this.dispatch({ type: \"done\", compilatonError: true });\n                        return [3 /*break*/, 6];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * It creates a new shell and run the starting task\n     */\n    SandpackNode.prototype.createShellProcessFromTask = function (files) {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var packageJsonContent;\n            var _a;\n            var _this = this;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        packageJsonContent = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.r)(files[\"/package.json\"]);\n                        this.emulatorCommand = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.b)(packageJsonContent);\n                        this.emulatorShellProcess = this.emulator.shell.create();\n                        // Shell listeners\n                        return [4 /*yield*/, this.emulatorShellProcess.on(\"exit\", function (exitCode) {\n                                _this.dispatch({\n                                    type: \"action\",\n                                    action: \"notification\",\n                                    notificationType: \"error\",\n                                    title: (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.c)(\"Error: process.exit(\".concat(exitCode, \") called.\")),\n                                });\n                            })];\n                    case 1:\n                        // Shell listeners\n                        _b.sent();\n                        return [4 /*yield*/, this.emulatorShellProcess.on(\"progress\", function (data) {\n                                var _a, _b;\n                                if (data.state === \"command_running\" ||\n                                    data.state === \"starting_command\") {\n                                    _this.dispatch({\n                                        type: \"shell/progress\",\n                                        data: (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)((0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.h)({}, data), { command: [\n                                                (_a = _this.emulatorCommand) === null || _a === void 0 ? void 0 : _a[0],\n                                                (_b = _this.emulatorCommand) === null || _b === void 0 ? void 0 : _b[1].join(\" \"),\n                                            ].join(\" \") }),\n                                    });\n                                    _this.status = \"installing-dependencies\";\n                                    return;\n                                }\n                                _this.dispatch({ type: \"shell/progress\", data: data });\n                            })];\n                    case 2:\n                        _b.sent();\n                        this.emulatorShellProcess.stdout.on(\"data\", function (data) {\n                            _this.dispatch({ type: \"stdout\", payload: { data: data, type: \"out\" } });\n                        });\n                        this.emulatorShellProcess.stderr.on(\"data\", function (data) {\n                            _this.dispatch({ type: \"stdout\", payload: { data: data, type: \"err\" } });\n                        });\n                        return [4 /*yield*/, (_a = this.emulatorShellProcess).runCommand.apply(_a, this.emulatorCommand)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.createPreviewURLFromId = function (id) {\n        var _a;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var url;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        this.iframePreviewUrl = undefined;\n                        return [4 /*yield*/, this.emulator.preview.getByShellId(id)];\n                    case 1:\n                        url = (_b.sent()).url;\n                        this.iframePreviewUrl = url + ((_a = this.options.startRoute) !== null && _a !== void 0 ? _a : \"\");\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Nodebox needs to handle two types of iframes at the same time:\n     *\n     * 1. Runtime iframe: where the emulator process runs, which is responsible\n     *    for creating the other iframes (hidden);\n     * 2. Preview iframes: any other node process that contains a PORT (public);\n     */\n    SandpackNode.prototype.manageIframes = function (selector) {\n        var _a;\n        /**\n         * Pick the preview iframe\n         */\n        if (typeof selector === \"string\") {\n            var element = document.querySelector(selector);\n            (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.n)(element, \"The element '\".concat(selector, \"' was not found\"));\n            this.iframe = document.createElement(\"iframe\");\n        }\n        else {\n            this.iframe = selector;\n        }\n        // Set preview iframe styles\n        setPreviewIframeProperties(this.iframe, this.options);\n        (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.n)(this.iframe.parentNode, \"The given iframe does not have a parent.\");\n        /**\n         * Create the runtime iframe, which is hidden sibling\n         * from the preview one\n         */\n        this.emulatorIframe = document.createElement(\"iframe\");\n        this.emulatorIframe.classList.add(\"sp-bridge-frame\");\n        (_a = this.iframe.parentNode) === null || _a === void 0 ? void 0 : _a.appendChild(this.emulatorIframe);\n    };\n    SandpackNode.prototype.setLocationURLIntoIFrame = function () {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.iframePreviewUrl) return [3 /*break*/, 2];\n                        return [4 /*yield*/, loadPreviewIframe(this.iframe, this.iframePreviewUrl)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Send all messages and events to tell to the\n     * consumer that the bundler is ready without any error\n     */\n    SandpackNode.prototype.dispatchDoneMessage = function () {\n        this.status = \"done\";\n        this.dispatch({ type: \"done\", compilatonError: false });\n        if (this.iframePreviewUrl) {\n            this.dispatch({\n                type: \"urlchange\",\n                url: this.iframePreviewUrl,\n                back: false,\n                forward: false,\n            });\n        }\n    };\n    SandpackNode.prototype.globalListeners = function () {\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var _this = this;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        window.addEventListener(\"message\", function (event) {\n                            if (event.data.type === _codesandbox_nodebox__WEBPACK_IMPORTED_MODULE_0__.PREVIEW_LOADED_MESSAGE_TYPE) {\n                                injectScriptToIframe(_this.iframe, _this.messageChannelId);\n                            }\n                            if (event.data.type === \"urlchange\" &&\n                                event.data.channelId === _this.messageChannelId) {\n                                _this.dispatch({\n                                    type: \"urlchange\",\n                                    url: event.data.url,\n                                    back: event.data.back,\n                                    forward: event.data.forward,\n                                });\n                            }\n                            else if (event.data.channelId === _this.messageChannelId) {\n                                _this.dispatch(event.data);\n                            }\n                        });\n                        return [4 /*yield*/, this.emulator.fs.watch([\"*\"], [\n                                \".next\",\n                                \"node_modules\",\n                                \"build\",\n                                \"dist\",\n                                \"vendor\",\n                                \".config\",\n                                \".vuepress\",\n                            ], function (message) { return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(_this, void 0, void 0, function () {\n                                var event, path, type, _a, content, newContent, err_2;\n                                return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                                    switch (_b.label) {\n                                        case 0:\n                                            if (!message)\n                                                return [2 /*return*/];\n                                            event = message;\n                                            path = \"newPath\" in event\n                                                ? event.newPath\n                                                : \"path\" in event\n                                                    ? event.path\n                                                    : \"\";\n                                            return [4 /*yield*/, this.emulator.fs.stat(path)];\n                                        case 1:\n                                            type = (_b.sent()).type;\n                                            if (type !== \"file\")\n                                                return [2 /*return*/, null];\n                                            _b.label = 2;\n                                        case 2:\n                                            _b.trys.push([2, 10, , 11]);\n                                            _a = event.type;\n                                            switch (_a) {\n                                                case \"change\": return [3 /*break*/, 3];\n                                                case \"create\": return [3 /*break*/, 3];\n                                                case \"remove\": return [3 /*break*/, 5];\n                                                case \"rename\": return [3 /*break*/, 6];\n                                                case \"close\": return [3 /*break*/, 8];\n                                            }\n                                            return [3 /*break*/, 9];\n                                        case 3: return [4 /*yield*/, this.emulator.fs.readFile(event.path, \"utf8\")];\n                                        case 4:\n                                            content = _b.sent();\n                                            this.dispatch({\n                                                type: \"fs/change\",\n                                                path: event.path,\n                                                content: content,\n                                            });\n                                            this._modulesCache.set(event.path, (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.w)(content));\n                                            return [3 /*break*/, 9];\n                                        case 5:\n                                            this.dispatch({\n                                                type: \"fs/remove\",\n                                                path: event.path,\n                                            });\n                                            this._modulesCache.delete(event.path);\n                                            return [3 /*break*/, 9];\n                                        case 6:\n                                            this.dispatch({\n                                                type: \"fs/remove\",\n                                                path: event.oldPath,\n                                            });\n                                            this._modulesCache.delete(event.oldPath);\n                                            return [4 /*yield*/, this.emulator.fs.readFile(event.newPath, \"utf8\")];\n                                        case 7:\n                                            newContent = _b.sent();\n                                            this.dispatch({\n                                                type: \"fs/change\",\n                                                path: event.newPath,\n                                                content: newContent,\n                                            });\n                                            this._modulesCache.set(event.newPath, (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.w)(newContent));\n                                            return [3 /*break*/, 9];\n                                        case 8: return [3 /*break*/, 9];\n                                        case 9: return [3 /*break*/, 11];\n                                        case 10:\n                                            err_2 = _b.sent();\n                                            this.dispatch({\n                                                type: \"action\",\n                                                action: \"notification\",\n                                                notificationType: \"error\",\n                                                title: (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.a)(err_2),\n                                            });\n                                            return [3 /*break*/, 11];\n                                        case 11: return [2 /*return*/];\n                                    }\n                                });\n                            }); })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * PUBLIC Methods\n     */\n    SandpackNode.prototype.restartShellProcess = function () {\n        var _a;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!(this.emulatorShellProcess && this.emulatorCommand)) return [3 /*break*/, 3];\n                        // 1. Set the loading state and clean the URL\n                        this.dispatch({ type: \"start\", firstLoad: true });\n                        this.status = \"initializing\";\n                        // 2. Exit shell\n                        return [4 /*yield*/, this.emulatorShellProcess.kill()];\n                    case 1:\n                        // 2. Exit shell\n                        _b.sent();\n                        (_a = this.iframe) === null || _a === void 0 ? void 0 : _a.removeAttribute(\"attr\");\n                        this.emulator.fs.rm(\"/node_modules/.vite\", {\n                            recursive: true,\n                            force: true,\n                        });\n                        // 3 Run command again\n                        return [4 /*yield*/, this.compile(Object.fromEntries(this._modulesCache))];\n                    case 2:\n                        // 3 Run command again\n                        _b.sent();\n                        _b.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.updateSandbox = function (setup) {\n        var _this = this;\n        var _a;\n        var modules = (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.f)(setup.files);\n        /**\n         * Update file changes\n         */\n        if (((_a = this.emulatorShellProcess) === null || _a === void 0 ? void 0 : _a.state) === \"running\") {\n            Object.entries(modules).forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                if (!_this._modulesCache.get(key) ||\n                    (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.r)(value) !== (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.r)(_this._modulesCache.get(key))) {\n                    _this.emulator.fs.writeFile(key, value, { recursive: true });\n                }\n            });\n            return;\n        }\n        /**\n         * Pass init files to the bundler\n         */\n        this.dispatch({\n            codesandbox: true,\n            modules: modules,\n            template: setup.template,\n            type: \"compile\",\n        });\n        /**\n         * Add modules to cache, this will ensure uniqueness changes\n         *\n         * Keep it after the compile action, in order to update the cache at the right moment\n         */\n        Object.entries(modules).forEach(function (_a) {\n            var key = _a[0], value = _a[1];\n            _this._modulesCache.set(key, (0,_consoleHook_cdbe54ab_mjs__WEBPACK_IMPORTED_MODULE_4__.w)(value));\n        });\n    };\n    SandpackNode.prototype.dispatch = function (message) {\n        var _a, _b;\n        return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__._)(this, void 0, void 0, function () {\n            var _c;\n            return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _c = message.type;\n                        switch (_c) {\n                            case \"compile\": return [3 /*break*/, 1];\n                            case \"refresh\": return [3 /*break*/, 2];\n                            case \"urlback\": return [3 /*break*/, 4];\n                            case \"urlforward\": return [3 /*break*/, 4];\n                            case \"shell/restart\": return [3 /*break*/, 5];\n                            case \"shell/openPreview\": return [3 /*break*/, 6];\n                        }\n                        return [3 /*break*/, 7];\n                    case 1:\n                        this.compile(message.modules);\n                        return [3 /*break*/, 8];\n                    case 2: return [4 /*yield*/, this.setLocationURLIntoIFrame()];\n                    case 3:\n                        _d.sent();\n                        return [3 /*break*/, 8];\n                    case 4:\n                        (_b = (_a = this.iframe) === null || _a === void 0 ? void 0 : _a.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage(message, \"*\");\n                        return [3 /*break*/, 8];\n                    case 5:\n                        this.restartShellProcess();\n                        return [3 /*break*/, 8];\n                    case 6:\n                        window.open(this.iframePreviewUrl, \"_blank\");\n                        return [3 /*break*/, 8];\n                    case 7:\n                        this.emitter.dispatch(message);\n                        _d.label = 8;\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SandpackNode.prototype.listen = function (listener) {\n        return this.emitter.listener(listener);\n    };\n    SandpackNode.prototype.destroy = function () {\n        this.emulatorIframe.remove();\n        this.emitter.cleanup();\n    };\n    return SandpackNode;\n}(_base_80a1f760_mjs__WEBPACK_IMPORTED_MODULE_5__.S));\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvY2xpZW50cy9ub2RlL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQThJO0FBQzdDO0FBQ25DO0FBQ3VLO0FBQ2pOO0FBQ0o7O0FBRWhCO0FBQ0EsV0FBVyxzREFBUztBQUNwQjtBQUNBLGVBQWUsc0RBQVc7QUFDMUI7QUFDQSxZQUFZLHNEQUFVO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxzREFBVztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLDJDQUEyQztBQUM5RyxtRUFBbUUsc0NBQXNDO0FBQ3pHO0FBQ0EsaUJBQWlCO0FBQ2pCLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHdCQUF3QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLGNBQWM7QUFDbkY7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLGlEQUFjOztBQUVRIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvY2xpZW50cy9ub2RlL2luZGV4Lm1qcz8wNDM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF8gYXMgX19hd2FpdGVyLCBhIGFzIF9fZ2VuZXJhdG9yLCBuIGFzIG51bGx0aHJvd3MsIGMgYXMgY3JlYXRlRXJyb3IsIGcgYXMgX19leHRlbmRzLCBoIGFzIF9fYXNzaWduIH0gZnJvbSAnLi4vLi4vdHlwZXMtMDg3N2M1NTMubWpzJztcbmltcG9ydCB7IElOSkVDVF9NRVNTQUdFX1RZUEUsIE5vZGVib3gsIFBSRVZJRVdfTE9BREVEX01FU1NBR0VfVFlQRSB9IGZyb20gJ0Bjb2Rlc2FuZGJveC9ub2RlYm94JztcbmltcG9ydCB7IFMgYXMgU2FuZHBhY2tDbGllbnQgfSBmcm9tICcuLi8uLi9iYXNlLTgwYTFmNzYwLm1qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbnNvbGVIb29rLCBmIGFzIGZyb21CdW5kbGVyRmlsZXNUb0ZTLCByIGFzIHJlYWRCdWZmZXIsIHcgYXMgd3JpdGVCdWZmZXIsIGcgYXMgZ2VuZXJhdGVSYW5kb21JZCwgRSBhcyBFdmVudEVtaXR0ZXIsIGEgYXMgZ2V0TWVzc2FnZUZyb21FcnJvciwgYiBhcyBmaW5kU3RhcnRTY3JpcHRQYWNrYWdlSnNvbiB9IGZyb20gJy4uLy4uL2NvbnNvbGVIb29rLWNkYmU1NGFiLm1qcyc7XG5pbXBvcnQgJ291dHZhcmlhbnQnO1xuaW1wb3J0ICdkZXF1YWwnO1xuXG5mdW5jdGlvbiBsb2FkUHJldmlld0lmcmFtZShpZnJhbWUsIHVybCkge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbnRlbnRXaW5kb3csIFRJTUVfT1VULCBNQVhfTUFOWV9USVJFUywgdHJpZXMsIHRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIGNvbnRlbnRXaW5kb3cgPSBpZnJhbWUuY29udGVudFdpbmRvdztcbiAgICAgICAgICAgIG51bGx0aHJvd3MoY29udGVudFdpbmRvdywgXCJGYWlsZWQgdG8gYXdhaXQgcHJldmlldyBpZnJhbWU6IG5vIGNvbnRlbnQgd2luZG93IGZvdW5kXCIpO1xuICAgICAgICAgICAgVElNRV9PVVQgPSA5MDAwMDtcbiAgICAgICAgICAgIE1BWF9NQU5ZX1RJUkVTID0gMjA7XG4gICAgICAgICAgICB0cmllcyA9IDA7XG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJpZXNUb1NldFVybCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbkxvYWRQYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmllcyA9IE1BWF9NQU5ZX1RJUkVTO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZnJhbWUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgb25Mb2FkUGFnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyaWVzID49IE1BWF9NQU5ZX1RJUkVTKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGNyZWF0ZUVycm9yKFwiQ291bGQgbm90IGFibGUgdG8gY29ubmVjdCB0byBwcmV2aWV3LlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCB1cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyaWVzVG9TZXRVcmwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZnJhbWUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgb25Mb2FkUGFnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBUSU1FX09VVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmllcyA9IHRyaWVzICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmcmFtZS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBvbkxvYWRQYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZWplY3QobmV3IEVycm9yKFwiSWZyYW1lIGVycm9yXCIpKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmcmFtZS5hZGRFdmVudExpc3RlbmVyKFwiYWJvcnRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcihcIkFib3J0ZWRcIikpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgdHJpZXNUb1NldFVybCgpO1xuICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG52YXIgc2V0UHJldmlld0lmcmFtZVByb3BlcnRpZXMgPSBmdW5jdGlvbiAoaWZyYW1lLCBvcHRpb25zKSB7XG4gICAgaWZyYW1lLnN0eWxlLmJvcmRlciA9IFwiMFwiO1xuICAgIGlmcmFtZS5zdHlsZS53aWR0aCA9IG9wdGlvbnMud2lkdGggfHwgXCIxMDAlXCI7XG4gICAgaWZyYW1lLnN0eWxlLmhlaWdodCA9IG9wdGlvbnMuaGVpZ2h0IHx8IFwiMTAwJVwiO1xuICAgIGlmcmFtZS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG4gICAgaWZyYW1lLmFsbG93ID0gXCJjcm9zcy1vcmlnaW4taXNvbGF0ZWRcIjtcbn07XG5cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudCwgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LWZ1bmN0aW9uLXJldHVybi10eXBlLCBuby1yZXN0cmljdGVkLWdsb2JhbHMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgICovXG5mdW5jdGlvbiBzZXR1cEhpc3RvcnlMaXN0ZW5lcnMoX2EpIHtcbiAgICB2YXIgc2NvcGUgPSBfYS5zY29wZTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdmFyIG9yaWdIaXN0b3J5UHJvdG8gPSB3aW5kb3cuaGlzdG9yeS5fX3Byb3RvX187XG4gICAgdmFyIGhpc3RvcnlMaXN0ID0gW107XG4gICAgdmFyIGhpc3RvcnlQb3NpdGlvbiA9IDA7XG4gICAgdmFyIGRpc3BhdGNoTWVzc2FnZSA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIHR5cGU6IFwidXJsY2hhbmdlXCIsXG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIGJhY2s6IGhpc3RvcnlQb3NpdGlvbiA+IDAsXG4gICAgICAgICAgICBmb3J3YXJkOiBoaXN0b3J5UG9zaXRpb24gPCBoaXN0b3J5TGlzdC5sZW5ndGggLSAxLFxuICAgICAgICAgICAgY2hhbm5lbElkOiBzY29wZS5jaGFubmVsSWQsXG4gICAgICAgIH0sIFwiKlwiKTtcbiAgICB9O1xuICAgIGZ1bmN0aW9uIHB1c2hIaXN0b3J5KHVybCwgc3RhdGUpIHtcbiAgICAgICAgLy8gcmVtb3ZlIFwiZnV0dXJlXCIgbG9jYXRpb25zXG4gICAgICAgIGhpc3RvcnlMaXN0LnNwbGljZShoaXN0b3J5UG9zaXRpb24gKyAxKTtcbiAgICAgICAgaGlzdG9yeUxpc3QucHVzaCh7IHVybDogdXJsLCBzdGF0ZTogc3RhdGUgfSk7XG4gICAgICAgIGhpc3RvcnlQb3NpdGlvbiA9IGhpc3RvcnlMaXN0Lmxlbmd0aCAtIDE7XG4gICAgfVxuICAgIE9iamVjdC5hc3NpZ24od2luZG93Lmhpc3RvcnksIHtcbiAgICAgICAgZ286IGZ1bmN0aW9uIChkZWx0YSkge1xuICAgICAgICAgICAgdmFyIG5ld1BvcyA9IGhpc3RvcnlQb3NpdGlvbiArIGRlbHRhO1xuICAgICAgICAgICAgaWYgKG5ld1BvcyA+PSAwICYmIG5ld1BvcyA8PSBoaXN0b3J5TGlzdC5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgaGlzdG9yeVBvc2l0aW9uID0gbmV3UG9zO1xuICAgICAgICAgICAgICAgIHZhciBfYSA9IGhpc3RvcnlMaXN0W2hpc3RvcnlQb3NpdGlvbl0sIHVybCA9IF9hLnVybCwgc3RhdGUgPSBfYS5zdGF0ZTtcbiAgICAgICAgICAgICAgICBvcmlnSGlzdG9yeVByb3RvLnJlcGxhY2VTdGF0ZS5jYWxsKHdpbmRvdy5oaXN0b3J5LCBzdGF0ZSwgXCJcIiwgdXJsKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3VVJMID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZjtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaE1lc3NhZ2UobmV3VVJMKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgUG9wU3RhdGVFdmVudChcInBvcHN0YXRlXCIsIHsgc3RhdGU6IHN0YXRlIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgYmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuZ28oLTEpO1xuICAgICAgICB9LFxuICAgICAgICBmb3J3YXJkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5nbygxKTtcbiAgICAgICAgfSxcbiAgICAgICAgcHVzaFN0YXRlOiBmdW5jdGlvbiAoc3RhdGUsIHRpdGxlLCB1cmwpIHtcbiAgICAgICAgICAgIG9yaWdIaXN0b3J5UHJvdG8ucmVwbGFjZVN0YXRlLmNhbGwod2luZG93Lmhpc3RvcnksIHN0YXRlLCB0aXRsZSwgdXJsKTtcbiAgICAgICAgICAgIHB1c2hIaXN0b3J5KHVybCwgc3RhdGUpO1xuICAgICAgICAgICAgZGlzcGF0Y2hNZXNzYWdlKGRvY3VtZW50LmxvY2F0aW9uLmhyZWYpO1xuICAgICAgICB9LFxuICAgICAgICByZXBsYWNlU3RhdGU6IGZ1bmN0aW9uIChzdGF0ZSwgdGl0bGUsIHVybCkge1xuICAgICAgICAgICAgb3JpZ0hpc3RvcnlQcm90by5yZXBsYWNlU3RhdGUuY2FsbCh3aW5kb3cuaGlzdG9yeSwgc3RhdGUsIHRpdGxlLCB1cmwpO1xuICAgICAgICAgICAgaGlzdG9yeUxpc3RbaGlzdG9yeVBvc2l0aW9uXSA9IHsgc3RhdGU6IHN0YXRlLCB1cmw6IHVybCB9O1xuICAgICAgICAgICAgZGlzcGF0Y2hNZXNzYWdlKGRvY3VtZW50LmxvY2F0aW9uLmhyZWYpO1xuICAgICAgICB9LFxuICAgIH0pO1xuICAgIGZ1bmN0aW9uIGhhbmRsZU1lc3NhZ2UoX2EpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBfYS5kYXRhO1xuICAgICAgICBpZiAoZGF0YS50eXBlID09PSBcInVybGJhY2tcIikge1xuICAgICAgICAgICAgaGlzdG9yeS5iYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YS50eXBlID09PSBcInVybGZvcndhcmRcIikge1xuICAgICAgICAgICAgaGlzdG9yeS5mb3J3YXJkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YS50eXBlID09PSBcInJlZnJlc2hcIikge1xuICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGhhbmRsZU1lc3NhZ2UpO1xufVxuXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5mdW5jdGlvbiB3YXRjaFJlc2l6ZShfYSkge1xuICAgIHZhciBzY29wZSA9IF9hLnNjb3BlO1xuICAgIHZhciBsYXN0SGVpZ2h0ID0gMDtcbiAgICBmdW5jdGlvbiBnZXREb2N1bWVudEhlaWdodCgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5O1xuICAgICAgICB2YXIgaHRtbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KGJvZHkuc2Nyb2xsSGVpZ2h0LCBib2R5Lm9mZnNldEhlaWdodCwgaHRtbC5vZmZzZXRIZWlnaHQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZW5kUmVzaXplRXZlbnQoKSB7XG4gICAgICAgIHZhciBoZWlnaHQgPSBnZXREb2N1bWVudEhlaWdodCgpO1xuICAgICAgICBpZiAobGFzdEhlaWdodCAhPT0gaGVpZ2h0KSB7XG4gICAgICAgICAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInJlc2l6ZVwiLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgICAgIGNvZGVzYW5kYm94OiB0cnVlLFxuICAgICAgICAgICAgICAgIGNoYW5uZWxJZDogc2NvcGUuY2hhbm5lbElkLFxuICAgICAgICAgICAgfSwgXCIqXCIpO1xuICAgICAgICB9XG4gICAgICAgIGxhc3RIZWlnaHQgPSBoZWlnaHQ7XG4gICAgfVxuICAgIHNlbmRSZXNpemVFdmVudCgpO1xuICAgIHZhciB0aHJvdHRsZTtcbiAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aHJvdHRsZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZW5kUmVzaXplRXZlbnQoKTtcbiAgICAgICAgICAgIHRocm90dGxlID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3R0bGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9LCAzMDApO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudCwge1xuICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgIHN1YnRyZWU6IHRydWUsXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogSWRlYWxseSB3ZSBzaG91bGQgb25seSB1c2UgYSBgTXV0YXRpb25PYnNlcnZlcmAgdG8gdHJpZ2dlciBhIHJlc2l6ZSBldmVudCxcbiAgICAgKiBob3dldmVyLCB3ZSBub3RlZCB0aGF0IGl0J3Mgbm90IDEwMCUgcmVsaWFibGUsIHNvIHdlIHdlbnQgZm9yIHBvbGxpbmcgc3RyYXRlZ3kgYXMgd2VsbFxuICAgICAqL1xuICAgIHNldEludGVydmFsKHNlbmRSZXNpemVFdmVudCwgMzAwKTtcbn1cblxuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50ICovXG52YXIgc2NyaXB0cyA9IFtcbiAgICB7IGNvZGU6IHNldHVwSGlzdG9yeUxpc3RlbmVycy50b1N0cmluZygpLCBpZDogXCJoaXN0b3J5TGlzdGVuZXJcIiB9LFxuICAgIHtcbiAgICAgICAgY29kZTogXCJmdW5jdGlvbiBjb25zb2xlSG9vayh7IHNjb3BlIH0pIHtcIiArIGNvbnNvbGVIb29rICsgXCJcXG59O1wiLFxuICAgICAgICBpZDogXCJjb25zb2xlSG9va1wiLFxuICAgIH0sXG4gICAgeyBjb2RlOiB3YXRjaFJlc2l6ZS50b1N0cmluZygpLCBpZDogXCJ3YXRjaFJlc2l6ZVwiIH0sXG5dO1xudmFyIGluamVjdFNjcmlwdFRvSWZyYW1lID0gZnVuY3Rpb24gKGlmcmFtZSwgY2hhbm5lbElkKSB7XG4gICAgc2NyaXB0cy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgX2I7XG4gICAgICAgIHZhciBjb2RlID0gX2EuY29kZSwgaWQgPSBfYS5pZDtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XG4gICAgICAgICAgICB1aWQ6IGlkLFxuICAgICAgICAgICAgdHlwZTogSU5KRUNUX01FU1NBR0VfVFlQRSxcbiAgICAgICAgICAgIGNvZGU6IFwiZXhwb3J0cy5hY3RpdmF0ZSA9IFwiLmNvbmNhdChjb2RlKSxcbiAgICAgICAgICAgIHNjb3BlOiB7IGNoYW5uZWxJZDogY2hhbm5lbElkIH0sXG4gICAgICAgIH07XG4gICAgICAgIChfYiA9IGlmcmFtZS5jb250ZW50V2luZG93KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IucG9zdE1lc3NhZ2UobWVzc2FnZSwgXCIqXCIpO1xuICAgIH0pO1xufTtcblxuLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSxAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55LHByZWZlci1yZXN0LXBhcmFtcyxAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtbW9kdWxlLWJvdW5kYXJ5LXR5cGVzICovXG52YXIgU2FuZHBhY2tOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTYW5kcGFja05vZGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2FuZHBhY2tOb2RlKHNlbGVjdG9yLCBzYW5kYm94SW5mbywgb3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBzZWxlY3Rvciwgc2FuZGJveEluZm8sIF9fYXNzaWduKF9fYXNzaWduKHt9LCBvcHRpb25zKSwgeyBidW5kbGVyVVJMOiBvcHRpb25zLmJ1bmRsZXJVUkwgfSkpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9tb2R1bGVzQ2FjaGUgPSBuZXcgTWFwKCk7XG4gICAgICAgIF90aGlzLm1lc3NhZ2VDaGFubmVsSWQgPSBnZW5lcmF0ZVJhbmRvbUlkKCk7XG4gICAgICAgIF90aGlzLl9pbml0UHJvbWlzZSA9IG51bGw7XG4gICAgICAgIF90aGlzLmVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8vIEFzc2lnbiBpZnJhbWVzXG4gICAgICAgIF90aGlzLm1hbmFnZUlmcmFtZXMoc2VsZWN0b3IpO1xuICAgICAgICAvLyBJbml0IGVtdWxhdG9yXG4gICAgICAgIF90aGlzLmVtdWxhdG9yID0gbmV3IE5vZGVib3goe1xuICAgICAgICAgICAgaWZyYW1lOiBfdGhpcy5lbXVsYXRvcklmcmFtZSxcbiAgICAgICAgICAgIHJ1bnRpbWVVcmw6IF90aGlzLm9wdGlvbnMuYnVuZGxlclVSTCxcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFRyaWdnZXIgaW5pdGlhbCBjb21waWxlXG4gICAgICAgIF90aGlzLnVwZGF0ZVNhbmRib3goc2FuZGJveEluZm8pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIC8vIEluaXRpYWxpemUgbm9kZWJveCwgc2hvdWxkIG9ubHkgZXZlciBiZSBjYWxsZWQgb25jZVxuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuX2luaXQgPSBmdW5jdGlvbiAoZmlsZXMpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLmNvbm5lY3QoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuIFNldHVwXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLmZzLmluaXQoZmlsZXMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4gU2V0dXBcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuMSBPdGhlciBkZXBlbmRlbmNpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZ2xvYmFsTGlzdGVuZXJzKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLjEgT3RoZXIgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSXQgaW5pdGlhbGl6ZXMgdGhlIGVtdWxhdG9yIGFuZCBwcm92aWRlIGl0IHdpdGggZmlsZXMsIHRlbXBsYXRlIGFuZCBzY3JpcHQgdG8gcnVuXG4gICAgICovXG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5jb21waWxlID0gZnVuY3Rpb24gKGZpbGVzKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzaGVsbElkLCBlcnJfMTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgNSwgLCA2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiBJbml0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiaW5pdGlhbGl6aW5nXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHsgdHlwZTogXCJzdGFydFwiLCBmaXJzdExvYWQ6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2luaXRQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5pdFByb21pc2UgPSB0aGlzLl9pbml0KGZpbGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2luaXRQcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwiY29ubmVjdGVkXCIgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNyZWF0ZVNoZWxsUHJvY2Vzc0Zyb21UYXNrKGZpbGVzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoZWxsSWQgPSAoX2Euc2VudCgpKS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDQuIExhdW5jaCBQcmV2aWV3XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNyZWF0ZVByZXZpZXdVUkxGcm9tSWQoc2hlbGxJZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyA0LiBMYXVuY2ggUHJldmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zZXRMb2NhdGlvblVSTEludG9JRnJhbWUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDUuIFJldHVybnMgdG8gY29uc3VtZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hEb25lTWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwibm90aWZpY2F0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uVHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBnZXRNZXNzYWdlRnJvbUVycm9yKGVycl8xKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwiZG9uZVwiLCBjb21waWxhdG9uRXJyb3I6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSXQgY3JlYXRlcyBhIG5ldyBzaGVsbCBhbmQgcnVuIHRoZSBzdGFydGluZyB0YXNrXG4gICAgICovXG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5jcmVhdGVTaGVsbFByb2Nlc3NGcm9tVGFzayA9IGZ1bmN0aW9uIChmaWxlcykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcGFja2FnZUpzb25Db250ZW50O1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhY2thZ2VKc29uQ29udGVudCA9IHJlYWRCdWZmZXIoZmlsZXNbXCIvcGFja2FnZS5qc29uXCJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW11bGF0b3JDb21tYW5kID0gZmluZFN0YXJ0U2NyaXB0UGFja2FnZUpzb24ocGFja2FnZUpzb25Db250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW11bGF0b3JTaGVsbFByb2Nlc3MgPSB0aGlzLmVtdWxhdG9yLnNoZWxsLmNyZWF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2hlbGwgbGlzdGVuZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzLm9uKFwiZXhpdFwiLCBmdW5jdGlvbiAoZXhpdENvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJub3RpZmljYXRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBjcmVhdGVFcnJvcihcIkVycm9yOiBwcm9jZXNzLmV4aXQoXCIuY29uY2F0KGV4aXRDb2RlLCBcIikgY2FsbGVkLlwiKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2hlbGwgbGlzdGVuZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzLm9uKFwicHJvZ3Jlc3NcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdGUgPT09IFwiY29tbWFuZF9ydW5uaW5nXCIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdGUgPT09IFwic3RhcnRpbmdfY29tbWFuZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzaGVsbC9wcm9ncmVzc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IF9fYXNzaWduKF9fYXNzaWduKHt9LCBkYXRhKSwgeyBjb21tYW5kOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2EgPSBfdGhpcy5lbXVsYXRvckNvbW1hbmQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYiA9IF90aGlzLmVtdWxhdG9yQ29tbWFuZCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iWzFdLmpvaW4oXCIgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCIgXCIpIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdGF0dXMgPSBcImluc3RhbGxpbmctZGVwZW5kZW5jaWVzXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goeyB0eXBlOiBcInNoZWxsL3Byb2dyZXNzXCIsIGRhdGE6IGRhdGEgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzLnN0ZG91dC5vbihcImRhdGFcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwic3Rkb3V0XCIsIHBheWxvYWQ6IHsgZGF0YTogZGF0YSwgdHlwZTogXCJvdXRcIiB9IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzLnN0ZGVyci5vbihcImRhdGFcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwic3Rkb3V0XCIsIHBheWxvYWQ6IHsgZGF0YTogZGF0YSwgdHlwZTogXCJlcnJcIiB9IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoX2EgPSB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzKS5ydW5Db21tYW5kLmFwcGx5KF9hLCB0aGlzLmVtdWxhdG9yQ29tbWFuZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovLCBfYi5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuY3JlYXRlUHJldmlld1VSTEZyb21JZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB1cmw7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlmcmFtZVByZXZpZXdVcmwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLnByZXZpZXcuZ2V0QnlTaGVsbElkKGlkKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IChfYi5zZW50KCkpLnVybDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lUHJldmlld1VybCA9IHVybCArICgoX2EgPSB0aGlzLm9wdGlvbnMuc3RhcnRSb3V0ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogTm9kZWJveCBuZWVkcyB0byBoYW5kbGUgdHdvIHR5cGVzIG9mIGlmcmFtZXMgYXQgdGhlIHNhbWUgdGltZTpcbiAgICAgKlxuICAgICAqIDEuIFJ1bnRpbWUgaWZyYW1lOiB3aGVyZSB0aGUgZW11bGF0b3IgcHJvY2VzcyBydW5zLCB3aGljaCBpcyByZXNwb25zaWJsZVxuICAgICAqICAgIGZvciBjcmVhdGluZyB0aGUgb3RoZXIgaWZyYW1lcyAoaGlkZGVuKTtcbiAgICAgKiAyLiBQcmV2aWV3IGlmcmFtZXM6IGFueSBvdGhlciBub2RlIHByb2Nlc3MgdGhhdCBjb250YWlucyBhIFBPUlQgKHB1YmxpYyk7XG4gICAgICovXG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5tYW5hZ2VJZnJhbWVzID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBpY2sgdGhlIHByZXZpZXcgaWZyYW1lXG4gICAgICAgICAqL1xuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgICAgICAgICAgbnVsbHRocm93cyhlbGVtZW50LCBcIlRoZSBlbGVtZW50ICdcIi5jb25jYXQoc2VsZWN0b3IsIFwiJyB3YXMgbm90IGZvdW5kXCIpKTtcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lID0gc2VsZWN0b3I7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0IHByZXZpZXcgaWZyYW1lIHN0eWxlc1xuICAgICAgICBzZXRQcmV2aWV3SWZyYW1lUHJvcGVydGllcyh0aGlzLmlmcmFtZSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgbnVsbHRocm93cyh0aGlzLmlmcmFtZS5wYXJlbnROb2RlLCBcIlRoZSBnaXZlbiBpZnJhbWUgZG9lcyBub3QgaGF2ZSBhIHBhcmVudC5cIik7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGUgdGhlIHJ1bnRpbWUgaWZyYW1lLCB3aGljaCBpcyBoaWRkZW4gc2libGluZ1xuICAgICAgICAgKiBmcm9tIHRoZSBwcmV2aWV3IG9uZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5lbXVsYXRvcklmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG4gICAgICAgIHRoaXMuZW11bGF0b3JJZnJhbWUuY2xhc3NMaXN0LmFkZChcInNwLWJyaWRnZS1mcmFtZVwiKTtcbiAgICAgICAgKF9hID0gdGhpcy5pZnJhbWUucGFyZW50Tm9kZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmFwcGVuZENoaWxkKHRoaXMuZW11bGF0b3JJZnJhbWUpO1xuICAgIH07XG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5zZXRMb2NhdGlvblVSTEludG9JRnJhbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pZnJhbWVQcmV2aWV3VXJsKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGxvYWRQcmV2aWV3SWZyYW1lKHRoaXMuaWZyYW1lLCB0aGlzLmlmcmFtZVByZXZpZXdVcmwpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBTZW5kIGFsbCBtZXNzYWdlcyBhbmQgZXZlbnRzIHRvIHRlbGwgdG8gdGhlXG4gICAgICogY29uc3VtZXIgdGhhdCB0aGUgYnVuZGxlciBpcyByZWFkeSB3aXRob3V0IGFueSBlcnJvclxuICAgICAqL1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuZGlzcGF0Y2hEb25lTWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBcImRvbmVcIjtcbiAgICAgICAgdGhpcy5kaXNwYXRjaCh7IHR5cGU6IFwiZG9uZVwiLCBjb21waWxhdG9uRXJyb3I6IGZhbHNlIH0pO1xuICAgICAgICBpZiAodGhpcy5pZnJhbWVQcmV2aWV3VXJsKSB7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcInVybGNoYW5nZVwiLFxuICAgICAgICAgICAgICAgIHVybDogdGhpcy5pZnJhbWVQcmV2aWV3VXJsLFxuICAgICAgICAgICAgICAgIGJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGZvcndhcmQ6IGZhbHNlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuZ2xvYmFsTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5kYXRhLnR5cGUgPT09IFBSRVZJRVdfTE9BREVEX01FU1NBR0VfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmplY3RTY3JpcHRUb0lmcmFtZShfdGhpcy5pZnJhbWUsIF90aGlzLm1lc3NhZ2VDaGFubmVsSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS50eXBlID09PSBcInVybGNoYW5nZVwiICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LmRhdGEuY2hhbm5lbElkID09PSBfdGhpcy5tZXNzYWdlQ2hhbm5lbElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidXJsY2hhbmdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGV2ZW50LmRhdGEudXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFjazogZXZlbnQuZGF0YS5iYWNrLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yd2FyZDogZXZlbnQuZGF0YS5mb3J3YXJkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQuZGF0YS5jaGFubmVsSWQgPT09IF90aGlzLm1lc3NhZ2VDaGFubmVsSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goZXZlbnQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLmZzLndhdGNoKFtcIipcIl0sIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIubmV4dFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vZGVfbW9kdWxlc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJ1aWxkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGlzdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZlbmRvclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIi5jb25maWdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIudnVlcHJlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLCBmdW5jdGlvbiAobWVzc2FnZSkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnQsIHBhdGgsIHR5cGUsIF9hLCBjb250ZW50LCBuZXdDb250ZW50LCBlcnJfMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtZXNzYWdlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IG1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBcIm5ld1BhdGhcIiBpbiBldmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBldmVudC5uZXdQYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwicGF0aFwiIGluIGV2ZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBldmVudC5wYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLmZzLnN0YXQocGF0aCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IChfYi5zZW50KCkpLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlICE9PSBcImZpbGVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBudWxsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsyLCAxMCwgLCAxMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IGV2ZW50LnR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjaGFuZ2VcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3JlYXRlXCI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInJlbW92ZVwiOiByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJyZW5hbWVcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY2xvc2VcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLmZzLnJlYWRGaWxlKGV2ZW50LnBhdGgsIFwidXRmOFwiKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZnMvY2hhbmdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBldmVudC5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vZHVsZXNDYWNoZS5zZXQoZXZlbnQucGF0aCwgd3JpdGVCdWZmZXIoY29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJmcy9yZW1vdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGV2ZW50LnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVzQ2FjaGUuZGVsZXRlKGV2ZW50LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJmcy9yZW1vdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGV2ZW50Lm9sZFBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVzQ2FjaGUuZGVsZXRlKGV2ZW50Lm9sZFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yLmZzLnJlYWRGaWxlKGV2ZW50Lm5ld1BhdGgsIFwidXRmOFwiKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50ID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZnMvY2hhbmdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBldmVudC5uZXdQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbmV3Q29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21vZHVsZXNDYWNoZS5zZXQoZXZlbnQubmV3UGF0aCwgd3JpdGVCdWZmZXIobmV3Q29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6IHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOTogcmV0dXJuIFszIC8qYnJlYWsqLywgMTFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycl8yID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwibm90aWZpY2F0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25UeXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZ2V0TWVzc2FnZUZyb21FcnJvcihlcnJfMiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUFVCTElDIE1ldGhvZHNcbiAgICAgKi9cbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLnJlc3RhcnRTaGVsbFByb2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5lbXVsYXRvclNoZWxsUHJvY2VzcyAmJiB0aGlzLmVtdWxhdG9yQ29tbWFuZCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gU2V0IHRoZSBsb2FkaW5nIHN0YXRlIGFuZCBjbGVhbiB0aGUgVVJMXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKHsgdHlwZTogXCJzdGFydFwiLCBmaXJzdExvYWQ6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiaW5pdGlhbGl6aW5nXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiBFeGl0IHNoZWxsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzLmtpbGwoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuIEV4aXQgc2hlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIChfYSA9IHRoaXMuaWZyYW1lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVtb3ZlQXR0cmlidXRlKFwiYXR0clwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW11bGF0b3IuZnMucm0oXCIvbm9kZV9tb2R1bGVzLy52aXRlXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMgUnVuIGNvbW1hbmQgYWdhaW5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY29tcGlsZShPYmplY3QuZnJvbUVudHJpZXModGhpcy5fbW9kdWxlc0NhY2hlKSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAzIFJ1biBjb21tYW5kIGFnYWluXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUudXBkYXRlU2FuZGJveCA9IGZ1bmN0aW9uIChzZXR1cCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBtb2R1bGVzID0gZnJvbUJ1bmRsZXJGaWxlc1RvRlMoc2V0dXAuZmlsZXMpO1xuICAgICAgICAvKipcbiAgICAgICAgICogVXBkYXRlIGZpbGUgY2hhbmdlc1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCgoX2EgPSB0aGlzLmVtdWxhdG9yU2hlbGxQcm9jZXNzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3RhdGUpID09PSBcInJ1bm5pbmdcIikge1xuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMobW9kdWxlcykuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gX2FbMF0sIHZhbHVlID0gX2FbMV07XG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5fbW9kdWxlc0NhY2hlLmdldChrZXkpIHx8XG4gICAgICAgICAgICAgICAgICAgIHJlYWRCdWZmZXIodmFsdWUpICE9PSByZWFkQnVmZmVyKF90aGlzLl9tb2R1bGVzQ2FjaGUuZ2V0KGtleSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmVtdWxhdG9yLmZzLndyaXRlRmlsZShrZXksIHZhbHVlLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogUGFzcyBpbml0IGZpbGVzIHRvIHRoZSBidW5kbGVyXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRpc3BhdGNoKHtcbiAgICAgICAgICAgIGNvZGVzYW5kYm94OiB0cnVlLFxuICAgICAgICAgICAgbW9kdWxlczogbW9kdWxlcyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiBzZXR1cC50ZW1wbGF0ZSxcbiAgICAgICAgICAgIHR5cGU6IFwiY29tcGlsZVwiLFxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBtb2R1bGVzIHRvIGNhY2hlLCB0aGlzIHdpbGwgZW5zdXJlIHVuaXF1ZW5lc3MgY2hhbmdlc1xuICAgICAgICAgKlxuICAgICAgICAgKiBLZWVwIGl0IGFmdGVyIHRoZSBjb21waWxlIGFjdGlvbiwgaW4gb3JkZXIgdG8gdXBkYXRlIHRoZSBjYWNoZSBhdCB0aGUgcmlnaHQgbW9tZW50XG4gICAgICAgICAqL1xuICAgICAgICBPYmplY3QuZW50cmllcyhtb2R1bGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgdmFyIGtleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xuICAgICAgICAgICAgX3RoaXMuX21vZHVsZXNDYWNoZS5zZXQoa2V5LCB3cml0ZUJ1ZmZlcih2YWx1ZSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNhbmRwYWNrTm9kZS5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2M7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9kKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfZC5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IG1lc3NhZ2UudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY29tcGlsZVwiOiByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicmVmcmVzaFwiOiByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidXJsYmFja1wiOiByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidXJsZm9yd2FyZFwiOiByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2hlbGwvcmVzdGFydFwiOiByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2hlbGwvb3BlblByZXZpZXdcIjogcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21waWxlKG1lc3NhZ2UubW9kdWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnNldExvY2F0aW9uVVJMSW50b0lGcmFtZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Quc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIChfYiA9IChfYSA9IHRoaXMuaWZyYW1lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY29udGVudFdpbmRvdykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIFwiKlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3RhcnRTaGVsbFByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3Blbih0aGlzLmlmcmFtZVByZXZpZXdVcmwsIFwiX2JsYW5rXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdHRlci5kaXNwYXRjaChtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kLmxhYmVsID0gODtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU2FuZHBhY2tOb2RlLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW1pdHRlci5saXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgfTtcbiAgICBTYW5kcGFja05vZGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZW11bGF0b3JJZnJhbWUucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuZW1pdHRlci5jbGVhbnVwKCk7XG4gICAgfTtcbiAgICByZXR1cm4gU2FuZHBhY2tOb2RlO1xufShTYW5kcGFja0NsaWVudCkpO1xuXG5leHBvcnQgeyBTYW5kcGFja05vZGUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/clients/node/index.mjs\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs":
/*!*********************************************************************************!*\
  !*** ./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: function() { return /* binding */ EventEmitter; },\n/* harmony export */   a: function() { return /* binding */ getMessageFromError; },\n/* harmony export */   b: function() { return /* binding */ findStartScriptPackageJson; },\n/* harmony export */   c: function() { return /* binding */ consoleHook; },\n/* harmony export */   f: function() { return /* binding */ fromBundlerFilesToFS; },\n/* harmony export */   g: function() { return /* binding */ generateRandomId; },\n/* harmony export */   r: function() { return /* binding */ readBuffer; },\n/* harmony export */   w: function() { return /* binding */ writeBuffer; }\n/* harmony export */ });\n/* harmony import */ var outvariant__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! outvariant */ \"(app-pages-browser)/./node_modules/outvariant/lib/index.mjs\");\n/* harmony import */ var _types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./types-0877c553.mjs */ \"(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/types-0877c553.mjs\");\n\n\n\nvar EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.listeners = {};\n        this.listenersCount = 0;\n        this.channelId = Math.floor(Math.random() * 1000000);\n        this.listeners = [];\n    }\n    EventEmitter.prototype.cleanup = function () {\n        this.listeners = {};\n        this.listenersCount = 0;\n    };\n    EventEmitter.prototype.dispatch = function (message) {\n        Object.values(this.listeners).forEach(function (listener) { return listener(message); });\n    };\n    EventEmitter.prototype.listener = function (listener) {\n        var _this = this;\n        if (typeof listener !== \"function\") {\n            return function () {\n                return;\n            };\n        }\n        var listenerId = this.listenersCount;\n        this.listeners[listenerId] = listener;\n        this.listenersCount++;\n        return function () {\n            delete _this.listeners[listenerId];\n        };\n    };\n    return EventEmitter;\n}());\n\nfunction isCommand(char) {\n    return /[a-zA-Z.]/.test(char);\n}\nfunction isAlpha(char) {\n    return /[a-zA-Z]/.test(char);\n}\nfunction isWhitespace(char) {\n    return /\\s/.test(char);\n}\nfunction isOperator(char) {\n    return /[&|]/.test(char);\n}\nfunction isArgument(char) {\n    return /-/.test(char);\n}\nfunction isString(char) {\n    return /[\"']/.test(char);\n}\nfunction isEnvVar(char) {\n    return isAlpha(char) && char === char.toUpperCase();\n}\nvar TokenType;\n(function (TokenType) {\n    TokenType[\"OR\"] = \"OR\";\n    TokenType[\"AND\"] = \"AND\";\n    TokenType[\"PIPE\"] = \"PIPE\";\n    TokenType[\"Command\"] = \"Command\";\n    TokenType[\"Argument\"] = \"Argument\";\n    TokenType[\"String\"] = \"String\";\n    TokenType[\"EnvVar\"] = \"EnvVar\";\n})(TokenType || (TokenType = {}));\nvar operators = new Map([\n    [\"&&\", { type: TokenType.AND }],\n    [\"||\", { type: TokenType.OR }],\n    [\"|\", { type: TokenType.PIPE }],\n    [\"-\", { type: TokenType.Argument }],\n]);\nfunction tokenize(input) {\n    var current = 0;\n    var tokens = [];\n    function parseCommand() {\n        var value = \"\";\n        while (isCommand(input[current]) && current < input.length) {\n            value += input[current];\n            current++;\n        }\n        return { type: TokenType.Command, value: value };\n    }\n    function parseOperator() {\n        var value = \"\";\n        while (isOperator(input[current]) && current < input.length) {\n            value += input[current];\n            current++;\n        }\n        return operators.get(value);\n    }\n    function parseArgument() {\n        var value = \"\";\n        while ((isArgument(input[current]) || isAlpha(input[current])) &&\n            current < input.length) {\n            value += input[current];\n            current++;\n        }\n        return { type: TokenType.Argument, value: value };\n    }\n    function parseString() {\n        var openCloseQuote = input[current];\n        var value = input[current];\n        current++;\n        while (input[current] !== openCloseQuote && current < input.length) {\n            value += input[current];\n            current++;\n        }\n        value += input[current];\n        current++;\n        return { type: TokenType.String, value: value };\n    }\n    function parseEnvVars() {\n        var value = {};\n        var parseSingleEnv = function () {\n            var key = \"\";\n            var pair = \"\";\n            while (input[current] !== \"=\" && current < input.length) {\n                key += input[current];\n                current++;\n            }\n            // Skip equal\n            if (input[current] === \"=\") {\n                current++;\n            }\n            while (input[current] !== \" \" && current < input.length) {\n                pair += input[current];\n                current++;\n            }\n            value[key] = pair;\n        };\n        while (isEnvVar(input[current]) && current < input.length) {\n            parseSingleEnv();\n            current++;\n        }\n        return { type: TokenType.EnvVar, value: value };\n    }\n    while (current < input.length) {\n        var currentChar = input[current];\n        if (isWhitespace(currentChar)) {\n            current++;\n            continue;\n        }\n        switch (true) {\n            case isEnvVar(currentChar):\n                tokens.push(parseEnvVars());\n                break;\n            case isCommand(currentChar):\n                tokens.push(parseCommand());\n                break;\n            case isOperator(currentChar):\n                tokens.push(parseOperator());\n                break;\n            case isArgument(currentChar):\n                tokens.push(parseArgument());\n                break;\n            case isString(currentChar):\n                tokens.push(parseString());\n                break;\n            default:\n                throw new Error(\"Unknown character: \".concat(currentChar));\n        }\n    }\n    return tokens;\n}\n\nvar counter = 0;\nfunction generateRandomId() {\n    var now = Date.now();\n    var randomNumber = Math.round(Math.random() * 10000);\n    var count = (counter += 1);\n    return (+\"\".concat(now).concat(randomNumber).concat(count)).toString(16);\n}\nvar writeBuffer = function (content) {\n    if (typeof content === \"string\") {\n        return new TextEncoder().encode(content);\n    }\n    else {\n        return content;\n    }\n};\nvar readBuffer = function (content) {\n    if (typeof content === \"string\") {\n        return content;\n    }\n    else {\n        return new TextDecoder().decode(content);\n    }\n};\nvar fromBundlerFilesToFS = function (files) {\n    return Object.entries(files).reduce(function (acc, _a) {\n        var key = _a[0], value = _a[1];\n        acc[key] = writeBuffer(value.code);\n        return acc;\n    }, {});\n};\n/**\n * Figure out which script it must run to start a server\n */\nvar findStartScriptPackageJson = function (packageJson) {\n    var scripts = {};\n    // TODO: support postinstall\n    var possibleKeys = [\"dev\", \"start\"];\n    try {\n        scripts = JSON.parse(packageJson).scripts;\n    }\n    catch (e) {\n        throw (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\"Could not parse package.json file: \" + e.message);\n    }\n    (0,outvariant__WEBPACK_IMPORTED_MODULE_0__.invariant)(scripts, \"Failed to start. Please provide a `start` or `dev` script on the package.json\");\n    var _loop_1 = function (index) {\n        if (possibleKeys[index] in scripts) {\n            var script = possibleKeys[index];\n            var candidate = scripts[script];\n            var env_1 = {};\n            var command_1 = \"\";\n            var args_1 = [];\n            tokenize(candidate).forEach(function (item) {\n                var commandNotFoundYet = command_1 === \"\";\n                if (item.type === TokenType.EnvVar) {\n                    env_1 = item.value;\n                }\n                if (item.type === TokenType.Command && commandNotFoundYet) {\n                    command_1 = item.value;\n                }\n                if (item.type === TokenType.Argument ||\n                    (!commandNotFoundYet && item.type === TokenType.Command)) {\n                    args_1.push(item.value);\n                }\n                // TODO: support TokenType.AND, TokenType.OR, TokenType.PIPE\n            });\n            return { value: [command_1, args_1, { env: env_1 }] };\n        }\n    };\n    for (var index = 0; index < possibleKeys.length; index++) {\n        var state_1 = _loop_1(index);\n        if (typeof state_1 === \"object\")\n            return state_1.value;\n    }\n    throw (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\"Failed to start. Please provide a `start` or `dev` script on the package.json\");\n};\nvar getMessageFromError = function (error) {\n    if (typeof error === \"string\")\n        return error;\n    if (typeof error === \"object\" && \"message\" in error) {\n        return error.message;\n    }\n    return (0,_types_0877c553_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(\"The server could not be reached. Make sure that the node script is running and that a port has been started.\");\n};\n\nvar consoleHook = \"var t=\\\"undefined\\\"!=typeof globalThis?globalThis:\\\"undefined\\\"!=typeof window?window:\\\"undefined\\\"!=typeof globalThis?globalThis:\\\"undefined\\\"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,\\\"default\\\")?t.default:t}var e={},n={};!function(t){t.__esModule=!0,t.default=[\\\"log\\\",\\\"debug\\\",\\\"info\\\",\\\"warn\\\",\\\"error\\\",\\\"table\\\",\\\"clear\\\",\\\"time\\\",\\\"timeEnd\\\",\\\"count\\\",\\\"assert\\\",\\\"command\\\",\\\"result\\\"]}(n);var a,o={},i={};(a=i).__esModule=!0,a.default=function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+\\\"-\\\"+t()+\\\"-\\\"+t()+\\\"-\\\"+t()+\\\"-\\\"+t()+\\\"-\\\"+Date.now()};var u={},s={__esModule:!0};s.update=s.state=void 0,s.update=function(t){s.state=t};var f={},c={};!function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)};r.__esModule=!0,r.initialState=void 0,r.initialState={timings:{},count:{}};var n=function(){return\\\"undefined\\\"!=typeof performance&&performance.now?performance.now():Date.now()};r.default=function(t,a){var o,i,u;switch(void 0===t&&(t=r.initialState),a.type){case\\\"COUNT\\\":var s=t.count[a.name]||0;return e(e({},t),{count:e(e({},t.count),(o={},o[a.name]=s+1,o))});case\\\"TIME_START\\\":return e(e({},t),{timings:e(e({},t.timings),(i={},i[a.name]={start:n()},i))});case\\\"TIME_END\\\":var f=t.timings[a.name],c=n(),l=c-f.start;return e(e({},t),{timings:e(e({},t.timings),(u={},u[a.name]=e(e({},f),{end:c,time:l}),u))});default:return t}}}(c),function(r){var e=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var n=e(c),a=s;r.default=function(t){a.update(n.default(a.state,t))}}(f);var l={__esModule:!0};l.timeEnd=l.timeStart=l.count=void 0,l.count=function(t){return{type:\\\"COUNT\\\",name:t}},l.timeStart=function(t){return{type:\\\"TIME_START\\\",name:t}},l.timeEnd=function(t){return{type:\\\"TIME_END\\\",name:t}};var d=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};u.__esModule=!0,u.stop=u.start=void 0;var p=s,h=d(f),m=l;u.start=function(t){h.default(m.timeStart(t))},u.stop=function(t){var r=null===p.state||void 0===p.state?void 0:p.state.timings[t];return r&&!r.end?(h.default(m.timeEnd(t)),{method:\\\"log\\\",data:[t+\\\": \\\"+p.state.timings[t].time+\\\"ms\\\"]}):{method:\\\"warn\\\",data:[\\\"Timer '\\\"+t+\\\"' does not exist\\\"]}};var y={},v=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};y.__esModule=!0,y.increment=void 0;var _=s,b=v(f),g=l;y.increment=function(t){return b.default(g.count(t)),{method:\\\"log\\\",data:[t+\\\": \\\"+_.state.count[t]]}};var M={},T=t&&t.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),a=0;for(r=0;r<e;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n};M.__esModule=!0,M.test=void 0,M.test=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return!t&&(0===r.length&&r.push(\\\"console.assert\\\"),{method:\\\"error\\\",data:T([\\\"Assertion failed:\\\"],r)})},function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)},n=t&&t.__createBinding||(Object.create?function(t,r,e,n){void 0===n&&(n=e),Object.defineProperty(t,n,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,n){void 0===n&&(n=e),t[n]=r[e]}),a=t&&t.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,\\\"default\\\",{enumerable:!0,value:r})}:function(t,r){t.default=r}),o=t&&t.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)\\\"default\\\"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&n(r,t,e);return a(r,t),r},s=t&&t.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),a=0;for(r=0;r<e;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n},f=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var c=f(i),l=o(u),d=o(y),p=o(M);r.default=function(t,r,n){var a=n||c.default();switch(t){case\\\"clear\\\":return{method:t,id:a};case\\\"count\\\":return!!(o=\\\"string\\\"==typeof r[0]?r[0]:\\\"default\\\")&&e(e({},d.increment(o)),{id:a});case\\\"time\\\":case\\\"timeEnd\\\":var o;return!!(o=\\\"string\\\"==typeof r[0]?r[0]:\\\"default\\\")&&(\\\"time\\\"===t?(l.start(o),!1):e(e({},l.stop(o)),{id:a}));case\\\"assert\\\":if(0!==r.length){var i=p.test.apply(p,s([r[0]],r.slice(1)));if(i)return e(e({},i),{id:a})}return!1;case\\\"error\\\":return{method:t,id:a,data:r.map((function(t){try{return t.stack||t}catch(r){return t}}))};default:return{method:t,id:a,data:r}}}}(o);var S={},O={};!function(t){var r;t.__esModule=!0,function(t){t[t.infinity=0]=\\\"infinity\\\",t[t.minusInfinity=1]=\\\"minusInfinity\\\",t[t.minusZero=2]=\\\"minusZero\\\"}(r||(r={})),t.default={type:\\\"Arithmetic\\\",lookup:Number,shouldTransform:function(t,r){return\\\"number\\\"===t&&(r===1/0||r===-1/0||function(t){return 1/t==-1/0}(r))},toSerializable:function(t){return t===1/0?r.infinity:t===-1/0?r.minusInfinity:r.minusZero},fromSerializable:function(t){return t===r.infinity?1/0:t===r.minusInfinity?-1/0:t===r.minusZero?-0:t}}}(O);var w={};!function(t){t.__esModule=!0,t.default={type:\\\"Function\\\",lookup:Function,shouldTransform:function(t,r){return\\\"function\\\"==typeof r},toSerializable:function(t){var r=\\\"\\\";try{r=t.toString().substring(r.indexOf(\\\"{\\\")+1,r.lastIndexOf(\\\"}\\\"))}catch(t){}return{name:t.name,body:r,proto:Object.getPrototypeOf(t).constructor.name}},fromSerializable:function(t){try{var r=function(){};return\\\"string\\\"==typeof t.name&&Object.defineProperty(r,\\\"name\\\",{value:t.name,writable:!1}),\\\"string\\\"==typeof t.body&&Object.defineProperty(r,\\\"body\\\",{value:t.body,writable:!1}),\\\"string\\\"==typeof t.proto&&(r.constructor={name:t.proto}),r}catch(r){return t}}}}(w);var A={};!function(t){var r;function e(t){for(var r={},e=0,n=t.attributes;e<n.length;e++){var a=n[e];r[a.name]=a.value}return r}t.__esModule=!0,t.default={type:\\\"HTMLElement\\\",shouldTransform:function(t,r){return r&&r.children&&\\\"string\\\"==typeof r.innerHTML&&\\\"string\\\"==typeof r.tagName},toSerializable:function(t){return{tagName:t.tagName.toLowerCase(),attributes:e(t),innerHTML:t.innerHTML}},fromSerializable:function(t){try{var e=(r||(r=document.implementation.createHTMLDocument(\\\"sandbox\\\"))).createElement(t.tagName);e.innerHTML=t.innerHTML;for(var n=0,a=Object.keys(t.attributes);n<a.length;n++){var o=a[n];try{e.setAttribute(o,t.attributes[o])}catch(t){}}return e}catch(r){return t}}}}(A);var j={};!function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)};r.__esModule=!0,r.default={type:\\\"Map\\\",shouldTransform:function(t,r){return r&&r.constructor&&\\\"Map\\\"===r.constructor.name},toSerializable:function(t){var r={};return t.forEach((function(t,e){var n=\\\"object\\\"==typeof e?JSON.stringify(e):e;r[n]=t})),{name:\\\"Map\\\",body:r,proto:Object.getPrototypeOf(t).constructor.name}},fromSerializable:function(t){var r=t.body,n=e({},r);return\\\"string\\\"==typeof t.proto&&(n.constructor={name:t.proto}),n}}}(j);var z={};!function(t){t.__esModule=!0;var r=\\\"@t\\\",e=/^#*@(t|r)$/,n=(0,eval)(\\\"this\\\"),a=\\\"function\\\"==typeof ArrayBuffer,o=\\\"function\\\"==typeof Map,i=\\\"function\\\"==typeof Set,u=[\\\"Int8Array\\\",\\\"Uint8Array\\\",\\\"Uint8ClampedArray\\\",\\\"Int16Array\\\",\\\"Uint16Array\\\",\\\"Int32Array\\\",\\\"Uint32Array\\\",\\\"Float32Array\\\",\\\"Float64Array\\\"],s=Array.prototype.slice,f={serialize:function(t){return JSON.stringify(t)},deserialize:function(t){return JSON.parse(t)}},c=function(){function t(t,r){this.references=t,this.transforms=r,this.transformsMap=this._makeTransformsMap(),this.circularCandidates=[],this.circularCandidatesDescrs=[],this.circularRefCount=0}return t._createRefMark=function(t){var r=Object.create(null);return r[\\\"@r\\\"]=t,r},t.prototype._createCircularCandidate=function(t,r,e){this.circularCandidates.push(t),this.circularCandidatesDescrs.push({parent:r,key:e,refIdx:-1})},t.prototype._applyTransform=function(t,e,n,a){var o=Object.create(null),i=a.toSerializable(t);return\\\"object\\\"==typeof i&&this._createCircularCandidate(t,e,n),o[r]=a.type,o.data=this._handleValue((function(){return i}),e,n),o},t.prototype._handleArray=function(t){for(var r=[],e=function(e){r[e]=n._handleValue((function(){return t[e]}),r,e)},n=this,a=0;a<t.length;a++)e(a);return r},t.prototype._handlePlainObject=function(t){var r,n,a=Object.create(null),o=function(r){if(Reflect.has(t,r)){var n=e.test(r)?\\\"#\\\"+r:r;a[n]=i._handleValue((function(){return t[r]}),a,n)}},i=this;for(var u in t)o(u);var s=null===(n=null===(r=null==t?void 0:t.__proto__)||void 0===r?void 0:r.constructor)||void 0===n?void 0:n.name;return s&&\\\"Object\\\"!==s&&(a.constructor={name:s}),a},t.prototype._handleObject=function(t,r,e){return this._createCircularCandidate(t,r,e),Array.isArray(t)?this._handleArray(t):this._handlePlainObject(t)},t.prototype._ensureCircularReference=function(r){var e=this.circularCandidates.indexOf(r);if(e>-1){var n=this.circularCandidatesDescrs[e];return-1===n.refIdx&&(n.refIdx=n.parent?++this.circularRefCount:0),t._createRefMark(n.refIdx)}return null},t.prototype._handleValue=function(t,r,e){try{var n=t(),a=typeof n,o=\\\"object\\\"===a&&null!==n;if(o){var i=this._ensureCircularReference(n);if(i)return i}var u=this._findTransform(a,n);return u?this._applyTransform(n,r,e,u):o?this._handleObject(n,r,e):n}catch(t){try{return this._handleValue((function(){return t instanceof Error?t:new Error(t)}),r,e)}catch(t){return null}}},t.prototype._makeTransformsMap=function(){if(o){var t=new Map;return this.transforms.forEach((function(r){r.lookup&&t.set(r.lookup,r)})),t}},t.prototype._findTransform=function(t,r){if(o&&r&&r.constructor&&(null==(a=this.transformsMap.get(r.constructor))?void 0:a.shouldTransform(t,r)))return a;for(var e=0,n=this.transforms;e<n.length;e++){var a;if((a=n[e]).shouldTransform(t,r))return a}},t.prototype.transform=function(){for(var r=this,e=[this._handleValue((function(){return r.references}),null,null)],n=0,a=this.circularCandidatesDescrs;n<a.length;n++){var o=a[n];o.refIdx>0&&(e[o.refIdx]=o.parent[o.key],o.parent[o.key]=t._createRefMark(o.refIdx))}return e},t}(),l=function(){function t(t,r){this.activeTransformsStack=[],this.visitedRefs=Object.create(null),this.references=t,this.transformMap=r}return t.prototype._handlePlainObject=function(t){var r=Object.create(null);for(var n in\\\"constructor\\\"in t&&(t.constructor&&\\\"string\\\"==typeof t.constructor.name||(t.constructor={name:\\\"Object\\\"})),t)t.hasOwnProperty(n)&&(this._handleValue(t[n],t,n),e.test(n)&&(r[n.substring(1)]=t[n],delete t[n]));for(var a in r)t[a]=r[a]},t.prototype._handleTransformedObject=function(t,e,n){var a=t[r],o=this.transformMap[a];if(!o)throw new Error(\\\"Can't find transform for \\\\\\\"\\\"+a+'\\\" type.');this.activeTransformsStack.push(t),this._handleValue(t.data,t,\\\"data\\\"),this.activeTransformsStack.pop(),e[n]=o.fromSerializable(t.data)},t.prototype._handleCircularSelfRefDuringTransform=function(t,r,e){var n=this.references;Object.defineProperty(r,e,{val:void 0,configurable:!0,enumerable:!0,get:function(){return void 0===this.val&&(this.val=n[t]),this.val},set:function(t){this.val=t}})},t.prototype._handleCircularRef=function(t,r,e){this.activeTransformsStack.includes(this.references[t])?this._handleCircularSelfRefDuringTransform(t,r,e):(this.visitedRefs[t]||(this.visitedRefs[t]=!0,this._handleValue(this.references[t],this.references,t)),r[e]=this.references[t])},t.prototype._handleValue=function(t,e,n){if(\\\"object\\\"==typeof t&&null!==t){var a=t[\\\"@r\\\"];if(void 0!==a)this._handleCircularRef(a,e,n);else if(t[r])this._handleTransformedObject(t,e,n);else if(Array.isArray(t))for(var o=0;o<t.length;o++)this._handleValue(t[o],t,o);else this._handlePlainObject(t)}},t.prototype.transform=function(){return this.visitedRefs[0]=!0,this._handleValue(this.references[0],this.references,0),this.references[0]},t}(),d=[{type:\\\"[[NaN]]\\\",shouldTransform:function(t,r){return\\\"number\\\"===t&&isNaN(r)},toSerializable:function(){return\\\"\\\"},fromSerializable:function(){return NaN}},{type:\\\"[[undefined]]\\\",shouldTransform:function(t){return\\\"undefined\\\"===t},toSerializable:function(){return\\\"\\\"},fromSerializable:function(){}},{type:\\\"[[Date]]\\\",lookup:Date,shouldTransform:function(t,r){return r instanceof Date},toSerializable:function(t){return t.getTime()},fromSerializable:function(t){var r=new Date;return r.setTime(t),r}},{type:\\\"[[RegExp]]\\\",lookup:RegExp,shouldTransform:function(t,r){return r instanceof RegExp},toSerializable:function(t){var r={src:t.source,flags:\\\"\\\"};return t.globalThis&&(r.flags+=\\\"g\\\"),t.ignoreCase&&(r.flags+=\\\"i\\\"),t.multiline&&(r.flags+=\\\"m\\\"),r},fromSerializable:function(t){return new RegExp(t.src,t.flags)}},{type:\\\"[[Error]]\\\",lookup:Error,shouldTransform:function(t,r){return r instanceof Error},toSerializable:function(t){var r,e;return t.stack||null===(e=(r=Error).captureStackTrace)||void 0===e||e.call(r,t),{name:t.name,message:t.message,stack:t.stack}},fromSerializable:function(t){var r=new(n[t.name]||Error)(t.message);return r.stack=t.stack,r}},{type:\\\"[[ArrayBuffer]]\\\",lookup:a&&ArrayBuffer,shouldTransform:function(t,r){return a&&r instanceof ArrayBuffer},toSerializable:function(t){var r=new Int8Array(t);return s.call(r)},fromSerializable:function(t){if(a){var r=new ArrayBuffer(t.length);return new Int8Array(r).set(t),r}return t}},{type:\\\"[[TypedArray]]\\\",shouldTransform:function(t,r){if(a)return ArrayBuffer.isView(r)&&!(r instanceof DataView);for(var e=0,o=u;e<o.length;e++){var i=o[e];if(\\\"function\\\"==typeof n[i]&&r instanceof n[i])return!0}return!1},toSerializable:function(t){return{ctorName:t.constructor.name,arr:s.call(t)}},fromSerializable:function(t){return\\\"function\\\"==typeof n[t.ctorName]?new n[t.ctorName](t.arr):t.arr}},{type:\\\"[[Map]]\\\",lookup:o&&Map,shouldTransform:function(t,r){return o&&r instanceof Map},toSerializable:function(t){var r=[];return t.forEach((function(t,e){r.push(e),r.push(t)})),r},fromSerializable:function(t){if(o){for(var r=new Map,e=0;e<t.length;e+=2)r.set(t[e],t[e+1]);return r}for(var n=[],a=0;a<t.length;a+=2)n.push([t[e],t[e+1]]);return n}},{type:\\\"[[Set]]\\\",lookup:i&&Set,shouldTransform:function(t,r){return i&&r instanceof Set},toSerializable:function(t){var r=[];return t.forEach((function(t){r.push(t)})),r},fromSerializable:function(t){if(i){for(var r=new Set,e=0;e<t.length;e++)r.add(t[e]);return r}return t}}],p=function(){function t(t){this.transforms=[],this.transformsMap=Object.create(null),this.serializer=t||f,this.addTransforms(d)}return t.prototype.addTransforms=function(t){for(var r=0,e=t=Array.isArray(t)?t:[t];r<e.length;r++){var n=e[r];if(this.transformsMap[n.type])throw new Error('Transform with type \\\"'+n.type+'\\\" was already added.');this.transforms.push(n),this.transformsMap[n.type]=n}return this},t.prototype.removeTransforms=function(t){for(var r=0,e=t=Array.isArray(t)?t:[t];r<e.length;r++){var n=e[r],a=this.transforms.indexOf(n);a>-1&&this.transforms.splice(a,1),delete this.transformsMap[n.type]}return this},t.prototype.encode=function(t){var r=new c(t,this.transforms).transform();return this.serializer.serialize(r)},t.prototype.decode=function(t){var r=this.serializer.deserialize(t);return new l(r,this.transformsMap).transform()},t}();t.default=p}(z);var E=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};S.__esModule=!0,S.Decode=P=S.Encode=void 0;var k=E(O),C=E(w),D=E(A),I=E(j),N=E(z),R=[D.default,C.default,k.default,I.default],x=new N.default;x.addTransforms(R);var P=S.Encode=function(t){return JSON.parse(x.encode(t))};S.Decode=function(t){return x.decode(JSON.stringify(t))},function(r){var e=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var a=e(n),i=e(o),u=S;r.default=function(t,r,e){void 0===e&&(e=!0);for(var n=t,o={pointers:{},src:{npm:\\\"https://npmjs.com/package/console-feed\\\",github:\\\"https://github.com/samdenty99/console-feed\\\"}},s=function(t){var a=n[t];n[t]=function(){a.apply(this,arguments);var n=[].slice.call(arguments);setTimeout((function(){var a=i.default(t,n);if(a){var o=a;e&&(o=u.Encode(a)),r(o,a)}}))},o.pointers[t]=a},f=0,c=a.default;f<c.length;f++)s(c[f]);return n.feed=o,n}}(e),r(e)(window.console,(function(t){var r=P(t);parent.postMessage({type:\\\"console\\\",codesandbox:!0,log:Array.isArray(r)?r[0]:r,channelId:scope.channelId},\\\"*\\\")}));\\n\";\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvY29uc29sZUhvb2stY2RiZTU0YWIubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBdUM7QUFDaUI7O0FBRXhEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSwyQkFBMkI7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsOEJBQThCO0FBQy9CO0FBQ0EsYUFBYSxxQkFBcUI7QUFDbEMsYUFBYSxvQkFBb0I7QUFDakMsWUFBWSxzQkFBc0I7QUFDbEMsWUFBWSwwQkFBMEI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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LDhCQUE4QixNQUFNLGdDQUFnQyxpQ0FBaUMsVUFBVSxFQUFFLHNEQUFzRCw0REFBNEQsZ0JBQWdCLFdBQVcsS0FBSyxXQUFXLHlEQUF5RCxTQUFTLDRCQUE0QixPQUFPLDJDQUEyQyw4QkFBOEIseUVBQXlFLEVBQUUsNkRBQTZELDJCQUEyQiw0QkFBNEIsU0FBUyxnQ0FBZ0Msb0JBQW9CLEtBQUssOEJBQThCLE1BQU0sc0JBQXNCLFdBQVcsd0JBQXdCLFNBQVMsaUJBQWlCLFdBQVcsMkJBQTJCLFVBQVUsRUFBRSw2REFBNkQsMkJBQTJCLDRCQUE0QixTQUFTLDhCQUE4QixVQUFVLEtBQUssOEJBQThCLE1BQU0sc0JBQXNCLFdBQVcsZ0JBQWdCLFNBQVMsVUFBVSxlQUFlLGNBQWMscUdBQXFHLDZDQUE2Qyx1Q0FBdUMsV0FBVyxLQUFLLFdBQVcsdUdBQXVHLHFEQUFxRCxZQUFZLDBDQUEwQyx1Q0FBdUMsV0FBVyxLQUFLLHdDQUF3QyxvRUFBb0UsWUFBWSxnQ0FBZ0MsMkNBQTJDLG9DQUFvQyxnQ0FBZ0MscUNBQXFDLCtDQUErQyxHQUFHLEdBQUcsWUFBWSxJQUFJLHdDQUF3QywwQkFBMEIsWUFBWSwyQ0FBMkMsbUdBQW1HLG1CQUFtQiwyQkFBMkIsZ0NBQWdDLHFCQUFxQixtQ0FBbUMsYUFBYSx3Q0FBd0MsMEJBQTBCLFlBQVksZ0JBQWdCLHNCQUFzQiwwQkFBMEIsbUJBQW1CLGVBQWUsV0FBVyxNQUFNLHNHQUFzRyxlQUFlLFdBQVcsZ0JBQWdCLHdCQUF3QiwrQkFBK0IsdUJBQXVCLHFCQUFxQixNQUFNLFFBQVEsMkJBQTJCLEdBQUcsaUJBQWlCLGlCQUFpQixXQUFXLFlBQVksbUJBQW1CLHFDQUFxQyxXQUFXLG9CQUFvQixzRkFBc0YsUUFBUSxHQUFHOztBQUVyb2dCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AY29kZXNhbmRib3gvc2FuZHBhY2stY2xpZW50L2Rpc3QvY29uc29sZUhvb2stY2RiZTU0YWIubWpzPzFjOWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW52YXJpYW50IH0gZnJvbSAnb3V0dmFyaWFudCc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZUVycm9yIH0gZnJvbSAnLi90eXBlcy0wODc3YzU1My5tanMnO1xuXG52YXIgRXZlbnRFbWl0dGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSB7fTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuY2hhbm5lbElkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMCk7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgfVxuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUuY2xlYW51cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSB7fTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNDb3VudCA9IDA7XG4gICAgfTtcbiAgICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgT2JqZWN0LnZhbHVlcyh0aGlzLmxpc3RlbmVycykuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHsgcmV0dXJuIGxpc3RlbmVyKG1lc3NhZ2UpOyB9KTtcbiAgICB9O1xuICAgIEV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVvZiBsaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpc3RlbmVySWQgPSB0aGlzLmxpc3RlbmVyc0NvdW50O1xuICAgICAgICB0aGlzLmxpc3RlbmVyc1tsaXN0ZW5lcklkXSA9IGxpc3RlbmVyO1xuICAgICAgICB0aGlzLmxpc3RlbmVyc0NvdW50Kys7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWxldGUgX3RoaXMubGlzdGVuZXJzW2xpc3RlbmVySWRdO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgcmV0dXJuIEV2ZW50RW1pdHRlcjtcbn0oKSk7XG5cbmZ1bmN0aW9uIGlzQ29tbWFuZChjaGFyKSB7XG4gICAgcmV0dXJuIC9bYS16QS1aLl0vLnRlc3QoY2hhcik7XG59XG5mdW5jdGlvbiBpc0FscGhhKGNoYXIpIHtcbiAgICByZXR1cm4gL1thLXpBLVpdLy50ZXN0KGNoYXIpO1xufVxuZnVuY3Rpb24gaXNXaGl0ZXNwYWNlKGNoYXIpIHtcbiAgICByZXR1cm4gL1xccy8udGVzdChjaGFyKTtcbn1cbmZ1bmN0aW9uIGlzT3BlcmF0b3IoY2hhcikge1xuICAgIHJldHVybiAvWyZ8XS8udGVzdChjaGFyKTtcbn1cbmZ1bmN0aW9uIGlzQXJndW1lbnQoY2hhcikge1xuICAgIHJldHVybiAvLS8udGVzdChjaGFyKTtcbn1cbmZ1bmN0aW9uIGlzU3RyaW5nKGNoYXIpIHtcbiAgICByZXR1cm4gL1tcIiddLy50ZXN0KGNoYXIpO1xufVxuZnVuY3Rpb24gaXNFbnZWYXIoY2hhcikge1xuICAgIHJldHVybiBpc0FscGhhKGNoYXIpICYmIGNoYXIgPT09IGNoYXIudG9VcHBlckNhc2UoKTtcbn1cbnZhciBUb2tlblR5cGU7XG4oZnVuY3Rpb24gKFRva2VuVHlwZSkge1xuICAgIFRva2VuVHlwZVtcIk9SXCJdID0gXCJPUlwiO1xuICAgIFRva2VuVHlwZVtcIkFORFwiXSA9IFwiQU5EXCI7XG4gICAgVG9rZW5UeXBlW1wiUElQRVwiXSA9IFwiUElQRVwiO1xuICAgIFRva2VuVHlwZVtcIkNvbW1hbmRcIl0gPSBcIkNvbW1hbmRcIjtcbiAgICBUb2tlblR5cGVbXCJBcmd1bWVudFwiXSA9IFwiQXJndW1lbnRcIjtcbiAgICBUb2tlblR5cGVbXCJTdHJpbmdcIl0gPSBcIlN0cmluZ1wiO1xuICAgIFRva2VuVHlwZVtcIkVudlZhclwiXSA9IFwiRW52VmFyXCI7XG59KShUb2tlblR5cGUgfHwgKFRva2VuVHlwZSA9IHt9KSk7XG52YXIgb3BlcmF0b3JzID0gbmV3IE1hcChbXG4gICAgW1wiJiZcIiwgeyB0eXBlOiBUb2tlblR5cGUuQU5EIH1dLFxuICAgIFtcInx8XCIsIHsgdHlwZTogVG9rZW5UeXBlLk9SIH1dLFxuICAgIFtcInxcIiwgeyB0eXBlOiBUb2tlblR5cGUuUElQRSB9XSxcbiAgICBbXCItXCIsIHsgdHlwZTogVG9rZW5UeXBlLkFyZ3VtZW50IH1dLFxuXSk7XG5mdW5jdGlvbiB0b2tlbml6ZShpbnB1dCkge1xuICAgIHZhciBjdXJyZW50ID0gMDtcbiAgICB2YXIgdG9rZW5zID0gW107XG4gICAgZnVuY3Rpb24gcGFyc2VDb21tYW5kKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBcIlwiO1xuICAgICAgICB3aGlsZSAoaXNDb21tYW5kKGlucHV0W2N1cnJlbnRdKSAmJiBjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YWx1ZSArPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB0eXBlOiBUb2tlblR5cGUuQ29tbWFuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlT3BlcmF0b3IoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IFwiXCI7XG4gICAgICAgIHdoaWxlIChpc09wZXJhdG9yKGlucHV0W2N1cnJlbnRdKSAmJiBjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YWx1ZSArPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3BlcmF0b3JzLmdldCh2YWx1ZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlQXJndW1lbnQoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IFwiXCI7XG4gICAgICAgIHdoaWxlICgoaXNBcmd1bWVudChpbnB1dFtjdXJyZW50XSkgfHwgaXNBbHBoYShpbnB1dFtjdXJyZW50XSkpICYmXG4gICAgICAgICAgICBjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YWx1ZSArPSBpbnB1dFtjdXJyZW50XTtcbiAgICAgICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB0eXBlOiBUb2tlblR5cGUuQXJndW1lbnQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBwYXJzZVN0cmluZygpIHtcbiAgICAgICAgdmFyIG9wZW5DbG9zZVF1b3RlID0gaW5wdXRbY3VycmVudF07XG4gICAgICAgIHZhciB2YWx1ZSA9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIHdoaWxlIChpbnB1dFtjdXJyZW50XSAhPT0gb3BlbkNsb3NlUXVvdGUgJiYgY3VycmVudCA8IGlucHV0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFsdWUgKz0gaW5wdXRbY3VycmVudF07XG4gICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWUgKz0gaW5wdXRbY3VycmVudF07XG4gICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogVG9rZW5UeXBlLlN0cmluZywgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlRW52VmFycygpIHtcbiAgICAgICAgdmFyIHZhbHVlID0ge307XG4gICAgICAgIHZhciBwYXJzZVNpbmdsZUVudiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIHBhaXIgPSBcIlwiO1xuICAgICAgICAgICAgd2hpbGUgKGlucHV0W2N1cnJlbnRdICE9PSBcIj1cIiAmJiBjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAga2V5ICs9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICAgICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFNraXAgZXF1YWxcbiAgICAgICAgICAgIGlmIChpbnB1dFtjdXJyZW50XSA9PT0gXCI9XCIpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZSAoaW5wdXRbY3VycmVudF0gIT09IFwiIFwiICYmIGN1cnJlbnQgPCBpbnB1dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwYWlyICs9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICAgICAgICAgIGN1cnJlbnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbHVlW2tleV0gPSBwYWlyO1xuICAgICAgICB9O1xuICAgICAgICB3aGlsZSAoaXNFbnZWYXIoaW5wdXRbY3VycmVudF0pICYmIGN1cnJlbnQgPCBpbnB1dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHBhcnNlU2luZ2xlRW52KCk7XG4gICAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogVG9rZW5UeXBlLkVudlZhciwgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIHdoaWxlIChjdXJyZW50IDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgIHZhciBjdXJyZW50Q2hhciA9IGlucHV0W2N1cnJlbnRdO1xuICAgICAgICBpZiAoaXNXaGl0ZXNwYWNlKGN1cnJlbnRDaGFyKSkge1xuICAgICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgICBjYXNlIGlzRW52VmFyKGN1cnJlbnRDaGFyKTpcbiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaChwYXJzZUVudlZhcnMoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGlzQ29tbWFuZChjdXJyZW50Q2hhcik6XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2gocGFyc2VDb21tYW5kKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBpc09wZXJhdG9yKGN1cnJlbnRDaGFyKTpcbiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaChwYXJzZU9wZXJhdG9yKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBpc0FyZ3VtZW50KGN1cnJlbnRDaGFyKTpcbiAgICAgICAgICAgICAgICB0b2tlbnMucHVzaChwYXJzZUFyZ3VtZW50KCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBpc1N0cmluZyhjdXJyZW50Q2hhcik6XG4gICAgICAgICAgICAgICAgdG9rZW5zLnB1c2gocGFyc2VTdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVua25vd24gY2hhcmFjdGVyOiBcIi5jb25jYXQoY3VycmVudENoYXIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG9rZW5zO1xufVxuXG52YXIgY291bnRlciA9IDA7XG5mdW5jdGlvbiBnZW5lcmF0ZVJhbmRvbUlkKCkge1xuICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xuICAgIHZhciByYW5kb21OdW1iZXIgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7XG4gICAgdmFyIGNvdW50ID0gKGNvdW50ZXIgKz0gMSk7XG4gICAgcmV0dXJuICgrXCJcIi5jb25jYXQobm93KS5jb25jYXQocmFuZG9tTnVtYmVyKS5jb25jYXQoY291bnQpKS50b1N0cmluZygxNik7XG59XG52YXIgd3JpdGVCdWZmZXIgPSBmdW5jdGlvbiAoY29udGVudCkge1xuICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGNvbnRlbnQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxufTtcbnZhciByZWFkQnVmZmVyID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGNvbnRlbnQpO1xuICAgIH1cbn07XG52YXIgZnJvbUJ1bmRsZXJGaWxlc1RvRlMgPSBmdW5jdGlvbiAoZmlsZXMpIHtcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMoZmlsZXMpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBfYSkge1xuICAgICAgICB2YXIga2V5ID0gX2FbMF0sIHZhbHVlID0gX2FbMV07XG4gICAgICAgIGFjY1trZXldID0gd3JpdGVCdWZmZXIodmFsdWUuY29kZSk7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xufTtcbi8qKlxuICogRmlndXJlIG91dCB3aGljaCBzY3JpcHQgaXQgbXVzdCBydW4gdG8gc3RhcnQgYSBzZXJ2ZXJcbiAqL1xudmFyIGZpbmRTdGFydFNjcmlwdFBhY2thZ2VKc29uID0gZnVuY3Rpb24gKHBhY2thZ2VKc29uKSB7XG4gICAgdmFyIHNjcmlwdHMgPSB7fTtcbiAgICAvLyBUT0RPOiBzdXBwb3J0IHBvc3RpbnN0YWxsXG4gICAgdmFyIHBvc3NpYmxlS2V5cyA9IFtcImRldlwiLCBcInN0YXJ0XCJdO1xuICAgIHRyeSB7XG4gICAgICAgIHNjcmlwdHMgPSBKU09OLnBhcnNlKHBhY2thZ2VKc29uKS5zY3JpcHRzO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBjcmVhdGVFcnJvcihcIkNvdWxkIG5vdCBwYXJzZSBwYWNrYWdlLmpzb24gZmlsZTogXCIgKyBlLm1lc3NhZ2UpO1xuICAgIH1cbiAgICBpbnZhcmlhbnQoc2NyaXB0cywgXCJGYWlsZWQgdG8gc3RhcnQuIFBsZWFzZSBwcm92aWRlIGEgYHN0YXJ0YCBvciBgZGV2YCBzY3JpcHQgb24gdGhlIHBhY2thZ2UuanNvblwiKTtcbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAocG9zc2libGVLZXlzW2luZGV4XSBpbiBzY3JpcHRzKSB7XG4gICAgICAgICAgICB2YXIgc2NyaXB0ID0gcG9zc2libGVLZXlzW2luZGV4XTtcbiAgICAgICAgICAgIHZhciBjYW5kaWRhdGUgPSBzY3JpcHRzW3NjcmlwdF07XG4gICAgICAgICAgICB2YXIgZW52XzEgPSB7fTtcbiAgICAgICAgICAgIHZhciBjb21tYW5kXzEgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGFyZ3NfMSA9IFtdO1xuICAgICAgICAgICAgdG9rZW5pemUoY2FuZGlkYXRlKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbW1hbmROb3RGb3VuZFlldCA9IGNvbW1hbmRfMSA9PT0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS50eXBlID09PSBUb2tlblR5cGUuRW52VmFyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudl8xID0gaXRlbS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gVG9rZW5UeXBlLkNvbW1hbmQgJiYgY29tbWFuZE5vdEZvdW5kWWV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRfMSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnR5cGUgPT09IFRva2VuVHlwZS5Bcmd1bWVudCB8fFxuICAgICAgICAgICAgICAgICAgICAoIWNvbW1hbmROb3RGb3VuZFlldCAmJiBpdGVtLnR5cGUgPT09IFRva2VuVHlwZS5Db21tYW5kKSkge1xuICAgICAgICAgICAgICAgICAgICBhcmdzXzEucHVzaChpdGVtLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogc3VwcG9ydCBUb2tlblR5cGUuQU5ELCBUb2tlblR5cGUuT1IsIFRva2VuVHlwZS5QSVBFXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBbY29tbWFuZF8xLCBhcmdzXzEsIHsgZW52OiBlbnZfMSB9XSB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgcG9zc2libGVLZXlzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEoaW5kZXgpO1xuICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcbiAgICB9XG4gICAgdGhyb3cgY3JlYXRlRXJyb3IoXCJGYWlsZWQgdG8gc3RhcnQuIFBsZWFzZSBwcm92aWRlIGEgYHN0YXJ0YCBvciBgZGV2YCBzY3JpcHQgb24gdGhlIHBhY2thZ2UuanNvblwiKTtcbn07XG52YXIgZ2V0TWVzc2FnZUZyb21FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgIGlmICh0eXBlb2YgZXJyb3IgPT09IFwic3RyaW5nXCIpXG4gICAgICAgIHJldHVybiBlcnJvcjtcbiAgICBpZiAodHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIFwibWVzc2FnZVwiIGluIGVycm9yKSB7XG4gICAgICAgIHJldHVybiBlcnJvci5tZXNzYWdlO1xuICAgIH1cbiAgICByZXR1cm4gY3JlYXRlRXJyb3IoXCJUaGUgc2VydmVyIGNvdWxkIG5vdCBiZSByZWFjaGVkLiBNYWtlIHN1cmUgdGhhdCB0aGUgbm9kZSBzY3JpcHQgaXMgcnVubmluZyBhbmQgdGhhdCBhIHBvcnQgaGFzIGJlZW4gc3RhcnRlZC5cIik7XG59O1xuXG52YXIgY29uc29sZUhvb2sgPSBcInZhciB0PVxcXCJ1bmRlZmluZWRcXFwiIT10eXBlb2YgZ2xvYmFsVGhpcz9nbG9iYWxUaGlzOlxcXCJ1bmRlZmluZWRcXFwiIT10eXBlb2Ygd2luZG93P3dpbmRvdzpcXFwidW5kZWZpbmVkXFxcIiE9dHlwZW9mIGdsb2JhbFRoaXM/Z2xvYmFsVGhpczpcXFwidW5kZWZpbmVkXFxcIiE9dHlwZW9mIHNlbGY/c2VsZjp7fTtmdW5jdGlvbiByKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGUmJk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LFxcXCJkZWZhdWx0XFxcIik/dC5kZWZhdWx0OnR9dmFyIGU9e30sbj17fTshZnVuY3Rpb24odCl7dC5fX2VzTW9kdWxlPSEwLHQuZGVmYXVsdD1bXFxcImxvZ1xcXCIsXFxcImRlYnVnXFxcIixcXFwiaW5mb1xcXCIsXFxcIndhcm5cXFwiLFxcXCJlcnJvclxcXCIsXFxcInRhYmxlXFxcIixcXFwiY2xlYXJcXFwiLFxcXCJ0aW1lXFxcIixcXFwidGltZUVuZFxcXCIsXFxcImNvdW50XFxcIixcXFwiYXNzZXJ0XFxcIixcXFwiY29tbWFuZFxcXCIsXFxcInJlc3VsdFxcXCJdfShuKTt2YXIgYSxvPXt9LGk9e307KGE9aSkuX19lc01vZHVsZT0hMCxhLmRlZmF1bHQ9ZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbigpe3JldHVybig2NTUzNiooMStNYXRoLnJhbmRvbSgpKXwwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpfTtyZXR1cm4gdCgpK3QoKStcXFwiLVxcXCIrdCgpK1xcXCItXFxcIit0KCkrXFxcIi1cXFwiK3QoKStcXFwiLVxcXCIrdCgpK1xcXCItXFxcIitEYXRlLm5vdygpfTt2YXIgdT17fSxzPXtfX2VzTW9kdWxlOiEwfTtzLnVwZGF0ZT1zLnN0YXRlPXZvaWQgMCxzLnVwZGF0ZT1mdW5jdGlvbih0KXtzLnN0YXRlPXR9O3ZhciBmPXt9LGM9e307IWZ1bmN0aW9uKHIpe3ZhciBlPXQmJnQuX19hc3NpZ258fGZ1bmN0aW9uKCl7cmV0dXJuIGU9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24odCl7Zm9yKHZhciByLGU9MSxuPWFyZ3VtZW50cy5sZW5ndGg7ZTxuO2UrKylmb3IodmFyIGEgaW4gcj1hcmd1bWVudHNbZV0pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHIsYSkmJih0W2FdPXJbYV0pO3JldHVybiB0fSxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07ci5fX2VzTW9kdWxlPSEwLHIuaW5pdGlhbFN0YXRlPXZvaWQgMCxyLmluaXRpYWxTdGF0ZT17dGltaW5nczp7fSxjb3VudDp7fX07dmFyIG49ZnVuY3Rpb24oKXtyZXR1cm5cXFwidW5kZWZpbmVkXFxcIiE9dHlwZW9mIHBlcmZvcm1hbmNlJiZwZXJmb3JtYW5jZS5ub3c/cGVyZm9ybWFuY2Uubm93KCk6RGF0ZS5ub3coKX07ci5kZWZhdWx0PWZ1bmN0aW9uKHQsYSl7dmFyIG8saSx1O3N3aXRjaCh2b2lkIDA9PT10JiYodD1yLmluaXRpYWxTdGF0ZSksYS50eXBlKXtjYXNlXFxcIkNPVU5UXFxcIjp2YXIgcz10LmNvdW50W2EubmFtZV18fDA7cmV0dXJuIGUoZSh7fSx0KSx7Y291bnQ6ZShlKHt9LHQuY291bnQpLChvPXt9LG9bYS5uYW1lXT1zKzEsbykpfSk7Y2FzZVxcXCJUSU1FX1NUQVJUXFxcIjpyZXR1cm4gZShlKHt9LHQpLHt0aW1pbmdzOmUoZSh7fSx0LnRpbWluZ3MpLChpPXt9LGlbYS5uYW1lXT17c3RhcnQ6bigpfSxpKSl9KTtjYXNlXFxcIlRJTUVfRU5EXFxcIjp2YXIgZj10LnRpbWluZ3NbYS5uYW1lXSxjPW4oKSxsPWMtZi5zdGFydDtyZXR1cm4gZShlKHt9LHQpLHt0aW1pbmdzOmUoZSh7fSx0LnRpbWluZ3MpLCh1PXt9LHVbYS5uYW1lXT1lKGUoe30sZikse2VuZDpjLHRpbWU6bH0pLHUpKX0pO2RlZmF1bHQ6cmV0dXJuIHR9fX0oYyksZnVuY3Rpb24ocil7dmFyIGU9dCYmdC5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX07ci5fX2VzTW9kdWxlPSEwO3ZhciBuPWUoYyksYT1zO3IuZGVmYXVsdD1mdW5jdGlvbih0KXthLnVwZGF0ZShuLmRlZmF1bHQoYS5zdGF0ZSx0KSl9fShmKTt2YXIgbD17X19lc01vZHVsZTohMH07bC50aW1lRW5kPWwudGltZVN0YXJ0PWwuY291bnQ9dm9pZCAwLGwuY291bnQ9ZnVuY3Rpb24odCl7cmV0dXJue3R5cGU6XFxcIkNPVU5UXFxcIixuYW1lOnR9fSxsLnRpbWVTdGFydD1mdW5jdGlvbih0KXtyZXR1cm57dHlwZTpcXFwiVElNRV9TVEFSVFxcXCIsbmFtZTp0fX0sbC50aW1lRW5kPWZ1bmN0aW9uKHQpe3JldHVybnt0eXBlOlxcXCJUSU1FX0VORFxcXCIsbmFtZTp0fX07dmFyIGQ9dCYmdC5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX07dS5fX2VzTW9kdWxlPSEwLHUuc3RvcD11LnN0YXJ0PXZvaWQgMDt2YXIgcD1zLGg9ZChmKSxtPWw7dS5zdGFydD1mdW5jdGlvbih0KXtoLmRlZmF1bHQobS50aW1lU3RhcnQodCkpfSx1LnN0b3A9ZnVuY3Rpb24odCl7dmFyIHI9bnVsbD09PXAuc3RhdGV8fHZvaWQgMD09PXAuc3RhdGU/dm9pZCAwOnAuc3RhdGUudGltaW5nc1t0XTtyZXR1cm4gciYmIXIuZW5kPyhoLmRlZmF1bHQobS50aW1lRW5kKHQpKSx7bWV0aG9kOlxcXCJsb2dcXFwiLGRhdGE6W3QrXFxcIjogXFxcIitwLnN0YXRlLnRpbWluZ3NbdF0udGltZStcXFwibXNcXFwiXX0pOnttZXRob2Q6XFxcIndhcm5cXFwiLGRhdGE6W1xcXCJUaW1lciAnXFxcIit0K1xcXCInIGRvZXMgbm90IGV4aXN0XFxcIl19fTt2YXIgeT17fSx2PXQmJnQuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19O3kuX19lc01vZHVsZT0hMCx5LmluY3JlbWVudD12b2lkIDA7dmFyIF89cyxiPXYoZiksZz1sO3kuaW5jcmVtZW50PWZ1bmN0aW9uKHQpe3JldHVybiBiLmRlZmF1bHQoZy5jb3VudCh0KSkse21ldGhvZDpcXFwibG9nXFxcIixkYXRhOlt0K1xcXCI6IFxcXCIrXy5zdGF0ZS5jb3VudFt0XV19fTt2YXIgTT17fSxUPXQmJnQuX19zcHJlYWRBcnJheXN8fGZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAscj0wLGU9YXJndW1lbnRzLmxlbmd0aDtyPGU7cisrKXQrPWFyZ3VtZW50c1tyXS5sZW5ndGg7dmFyIG49QXJyYXkodCksYT0wO2ZvcihyPTA7cjxlO3IrKylmb3IodmFyIG89YXJndW1lbnRzW3JdLGk9MCx1PW8ubGVuZ3RoO2k8dTtpKyssYSsrKW5bYV09b1tpXTtyZXR1cm4gbn07TS5fX2VzTW9kdWxlPSEwLE0udGVzdD12b2lkIDAsTS50ZXN0PWZ1bmN0aW9uKHQpe2Zvcih2YXIgcj1bXSxlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKylyW2UtMV09YXJndW1lbnRzW2VdO3JldHVybiF0JiYoMD09PXIubGVuZ3RoJiZyLnB1c2goXFxcImNvbnNvbGUuYXNzZXJ0XFxcIikse21ldGhvZDpcXFwiZXJyb3JcXFwiLGRhdGE6VChbXFxcIkFzc2VydGlvbiBmYWlsZWQ6XFxcIl0scil9KX0sZnVuY3Rpb24ocil7dmFyIGU9dCYmdC5fX2Fzc2lnbnx8ZnVuY3Rpb24oKXtyZXR1cm4gZT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIHIsZT0xLG49YXJndW1lbnRzLmxlbmd0aDtlPG47ZSsrKWZvcih2YXIgYSBpbiByPWFyZ3VtZW50c1tlXSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocixhKSYmKHRbYV09clthXSk7cmV0dXJuIHR9LGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxuPXQmJnQuX19jcmVhdGVCaW5kaW5nfHwoT2JqZWN0LmNyZWF0ZT9mdW5jdGlvbih0LHIsZSxuKXt2b2lkIDA9PT1uJiYobj1lKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiByW2VdfX0pfTpmdW5jdGlvbih0LHIsZSxuKXt2b2lkIDA9PT1uJiYobj1lKSx0W25dPXJbZV19KSxhPXQmJnQuX19zZXRNb2R1bGVEZWZhdWx0fHwoT2JqZWN0LmNyZWF0ZT9mdW5jdGlvbih0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFxcXCJkZWZhdWx0XFxcIix7ZW51bWVyYWJsZTohMCx2YWx1ZTpyfSl9OmZ1bmN0aW9uKHQscil7dC5kZWZhdWx0PXJ9KSxvPXQmJnQuX19pbXBvcnRTdGFyfHxmdW5jdGlvbih0KXtpZih0JiZ0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIHI9e307aWYobnVsbCE9dClmb3IodmFyIGUgaW4gdClcXFwiZGVmYXVsdFxcXCIhPT1lJiZPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxlKSYmbihyLHQsZSk7cmV0dXJuIGEocix0KSxyfSxzPXQmJnQuX19zcHJlYWRBcnJheXN8fGZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAscj0wLGU9YXJndW1lbnRzLmxlbmd0aDtyPGU7cisrKXQrPWFyZ3VtZW50c1tyXS5sZW5ndGg7dmFyIG49QXJyYXkodCksYT0wO2ZvcihyPTA7cjxlO3IrKylmb3IodmFyIG89YXJndW1lbnRzW3JdLGk9MCx1PW8ubGVuZ3RoO2k8dTtpKyssYSsrKW5bYV09b1tpXTtyZXR1cm4gbn0sZj10JiZ0Ll9faW1wb3J0RGVmYXVsdHx8ZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQuX19lc01vZHVsZT90OntkZWZhdWx0OnR9fTtyLl9fZXNNb2R1bGU9ITA7dmFyIGM9ZihpKSxsPW8odSksZD1vKHkpLHA9byhNKTtyLmRlZmF1bHQ9ZnVuY3Rpb24odCxyLG4pe3ZhciBhPW58fGMuZGVmYXVsdCgpO3N3aXRjaCh0KXtjYXNlXFxcImNsZWFyXFxcIjpyZXR1cm57bWV0aG9kOnQsaWQ6YX07Y2FzZVxcXCJjb3VudFxcXCI6cmV0dXJuISEobz1cXFwic3RyaW5nXFxcIj09dHlwZW9mIHJbMF0/clswXTpcXFwiZGVmYXVsdFxcXCIpJiZlKGUoe30sZC5pbmNyZW1lbnQobykpLHtpZDphfSk7Y2FzZVxcXCJ0aW1lXFxcIjpjYXNlXFxcInRpbWVFbmRcXFwiOnZhciBvO3JldHVybiEhKG89XFxcInN0cmluZ1xcXCI9PXR5cGVvZiByWzBdP3JbMF06XFxcImRlZmF1bHRcXFwiKSYmKFxcXCJ0aW1lXFxcIj09PXQ/KGwuc3RhcnQobyksITEpOmUoZSh7fSxsLnN0b3AobykpLHtpZDphfSkpO2Nhc2VcXFwiYXNzZXJ0XFxcIjppZigwIT09ci5sZW5ndGgpe3ZhciBpPXAudGVzdC5hcHBseShwLHMoW3JbMF1dLHIuc2xpY2UoMSkpKTtpZihpKXJldHVybiBlKGUoe30saSkse2lkOmF9KX1yZXR1cm4hMTtjYXNlXFxcImVycm9yXFxcIjpyZXR1cm57bWV0aG9kOnQsaWQ6YSxkYXRhOnIubWFwKChmdW5jdGlvbih0KXt0cnl7cmV0dXJuIHQuc3RhY2t8fHR9Y2F0Y2gocil7cmV0dXJuIHR9fSkpfTtkZWZhdWx0OnJldHVybnttZXRob2Q6dCxpZDphLGRhdGE6cn19fX0obyk7dmFyIFM9e30sTz17fTshZnVuY3Rpb24odCl7dmFyIHI7dC5fX2VzTW9kdWxlPSEwLGZ1bmN0aW9uKHQpe3RbdC5pbmZpbml0eT0wXT1cXFwiaW5maW5pdHlcXFwiLHRbdC5taW51c0luZmluaXR5PTFdPVxcXCJtaW51c0luZmluaXR5XFxcIix0W3QubWludXNaZXJvPTJdPVxcXCJtaW51c1plcm9cXFwifShyfHwocj17fSkpLHQuZGVmYXVsdD17dHlwZTpcXFwiQXJpdGhtZXRpY1xcXCIsbG9va3VwOk51bWJlcixzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm5cXFwibnVtYmVyXFxcIj09PXQmJihyPT09MS8wfHxyPT09LTEvMHx8ZnVuY3Rpb24odCl7cmV0dXJuIDEvdD09LTEvMH0ocikpfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtyZXR1cm4gdD09PTEvMD9yLmluZmluaXR5OnQ9PT0tMS8wP3IubWludXNJbmZpbml0eTpyLm1pbnVzWmVyb30sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtyZXR1cm4gdD09PXIuaW5maW5pdHk/MS8wOnQ9PT1yLm1pbnVzSW5maW5pdHk/LTEvMDp0PT09ci5taW51c1plcm8/LTA6dH19fShPKTt2YXIgdz17fTshZnVuY3Rpb24odCl7dC5fX2VzTW9kdWxlPSEwLHQuZGVmYXVsdD17dHlwZTpcXFwiRnVuY3Rpb25cXFwiLGxvb2t1cDpGdW5jdGlvbixzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm5cXFwiZnVuY3Rpb25cXFwiPT10eXBlb2Ygcn0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHI9XFxcIlxcXCI7dHJ5e3I9dC50b1N0cmluZygpLnN1YnN0cmluZyhyLmluZGV4T2YoXFxcIntcXFwiKSsxLHIubGFzdEluZGV4T2YoXFxcIn1cXFwiKSl9Y2F0Y2godCl7fXJldHVybntuYW1lOnQubmFtZSxib2R5OnIscHJvdG86T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpLmNvbnN0cnVjdG9yLm5hbWV9fSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3RyeXt2YXIgcj1mdW5jdGlvbigpe307cmV0dXJuXFxcInN0cmluZ1xcXCI9PXR5cGVvZiB0Lm5hbWUmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFxcXCJuYW1lXFxcIix7dmFsdWU6dC5uYW1lLHdyaXRhYmxlOiExfSksXFxcInN0cmluZ1xcXCI9PXR5cGVvZiB0LmJvZHkmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFxcXCJib2R5XFxcIix7dmFsdWU6dC5ib2R5LHdyaXRhYmxlOiExfSksXFxcInN0cmluZ1xcXCI9PXR5cGVvZiB0LnByb3RvJiYoci5jb25zdHJ1Y3Rvcj17bmFtZTp0LnByb3RvfSkscn1jYXRjaChyKXtyZXR1cm4gdH19fX0odyk7dmFyIEE9e307IWZ1bmN0aW9uKHQpe3ZhciByO2Z1bmN0aW9uIGUodCl7Zm9yKHZhciByPXt9LGU9MCxuPXQuYXR0cmlidXRlcztlPG4ubGVuZ3RoO2UrKyl7dmFyIGE9bltlXTtyW2EubmFtZV09YS52YWx1ZX1yZXR1cm4gcn10Ll9fZXNNb2R1bGU9ITAsdC5kZWZhdWx0PXt0eXBlOlxcXCJIVE1MRWxlbWVudFxcXCIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHImJnIuY2hpbGRyZW4mJlxcXCJzdHJpbmdcXFwiPT10eXBlb2Ygci5pbm5lckhUTUwmJlxcXCJzdHJpbmdcXFwiPT10eXBlb2Ygci50YWdOYW1lfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtyZXR1cm57dGFnTmFtZTp0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSxhdHRyaWJ1dGVzOmUodCksaW5uZXJIVE1MOnQuaW5uZXJIVE1MfX0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt0cnl7dmFyIGU9KHJ8fChyPWRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudChcXFwic2FuZGJveFxcXCIpKSkuY3JlYXRlRWxlbWVudCh0LnRhZ05hbWUpO2UuaW5uZXJIVE1MPXQuaW5uZXJIVE1MO2Zvcih2YXIgbj0wLGE9T2JqZWN0LmtleXModC5hdHRyaWJ1dGVzKTtuPGEubGVuZ3RoO24rKyl7dmFyIG89YVtuXTt0cnl7ZS5zZXRBdHRyaWJ1dGUobyx0LmF0dHJpYnV0ZXNbb10pfWNhdGNoKHQpe319cmV0dXJuIGV9Y2F0Y2gocil7cmV0dXJuIHR9fX19KEEpO3ZhciBqPXt9OyFmdW5jdGlvbihyKXt2YXIgZT10JiZ0Ll9fYXNzaWdufHxmdW5jdGlvbigpe3JldHVybiBlPU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKHQpe2Zvcih2YXIgcixlPTEsbj1hcmd1bWVudHMubGVuZ3RoO2U8bjtlKyspZm9yKHZhciBhIGluIHI9YXJndW1lbnRzW2VdKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyLGEpJiYodFthXT1yW2FdKTtyZXR1cm4gdH0sZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3IuX19lc01vZHVsZT0hMCxyLmRlZmF1bHQ9e3R5cGU6XFxcIk1hcFxcXCIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHImJnIuY29uc3RydWN0b3ImJlxcXCJNYXBcXFwiPT09ci5jb25zdHJ1Y3Rvci5uYW1lfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcj17fTtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbih0LGUpe3ZhciBuPVxcXCJvYmplY3RcXFwiPT10eXBlb2YgZT9KU09OLnN0cmluZ2lmeShlKTplO3Jbbl09dH0pKSx7bmFtZTpcXFwiTWFwXFxcIixib2R5OnIscHJvdG86T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpLmNvbnN0cnVjdG9yLm5hbWV9fSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3ZhciByPXQuYm9keSxuPWUoe30scik7cmV0dXJuXFxcInN0cmluZ1xcXCI9PXR5cGVvZiB0LnByb3RvJiYobi5jb25zdHJ1Y3Rvcj17bmFtZTp0LnByb3RvfSksbn19fShqKTt2YXIgej17fTshZnVuY3Rpb24odCl7dC5fX2VzTW9kdWxlPSEwO3ZhciByPVxcXCJAdFxcXCIsZT0vXiMqQCh0fHIpJC8sbj0oMCxldmFsKShcXFwidGhpc1xcXCIpLGE9XFxcImZ1bmN0aW9uXFxcIj09dHlwZW9mIEFycmF5QnVmZmVyLG89XFxcImZ1bmN0aW9uXFxcIj09dHlwZW9mIE1hcCxpPVxcXCJmdW5jdGlvblxcXCI9PXR5cGVvZiBTZXQsdT1bXFxcIkludDhBcnJheVxcXCIsXFxcIlVpbnQ4QXJyYXlcXFwiLFxcXCJVaW50OENsYW1wZWRBcnJheVxcXCIsXFxcIkludDE2QXJyYXlcXFwiLFxcXCJVaW50MTZBcnJheVxcXCIsXFxcIkludDMyQXJyYXlcXFwiLFxcXCJVaW50MzJBcnJheVxcXCIsXFxcIkZsb2F0MzJBcnJheVxcXCIsXFxcIkZsb2F0NjRBcnJheVxcXCJdLHM9QXJyYXkucHJvdG90eXBlLnNsaWNlLGY9e3NlcmlhbGl6ZTpmdW5jdGlvbih0KXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkodCl9LGRlc2VyaWFsaXplOmZ1bmN0aW9uKHQpe3JldHVybiBKU09OLnBhcnNlKHQpfX0sYz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxyKXt0aGlzLnJlZmVyZW5jZXM9dCx0aGlzLnRyYW5zZm9ybXM9cix0aGlzLnRyYW5zZm9ybXNNYXA9dGhpcy5fbWFrZVRyYW5zZm9ybXNNYXAoKSx0aGlzLmNpcmN1bGFyQ2FuZGlkYXRlcz1bXSx0aGlzLmNpcmN1bGFyQ2FuZGlkYXRlc0Rlc2Nycz1bXSx0aGlzLmNpcmN1bGFyUmVmQ291bnQ9MH1yZXR1cm4gdC5fY3JlYXRlUmVmTWFyaz1mdW5jdGlvbih0KXt2YXIgcj1PYmplY3QuY3JlYXRlKG51bGwpO3JldHVybiByW1xcXCJAclxcXCJdPXQscn0sdC5wcm90b3R5cGUuX2NyZWF0ZUNpcmN1bGFyQ2FuZGlkYXRlPWZ1bmN0aW9uKHQscixlKXt0aGlzLmNpcmN1bGFyQ2FuZGlkYXRlcy5wdXNoKHQpLHRoaXMuY2lyY3VsYXJDYW5kaWRhdGVzRGVzY3JzLnB1c2goe3BhcmVudDpyLGtleTplLHJlZklkeDotMX0pfSx0LnByb3RvdHlwZS5fYXBwbHlUcmFuc2Zvcm09ZnVuY3Rpb24odCxlLG4sYSl7dmFyIG89T2JqZWN0LmNyZWF0ZShudWxsKSxpPWEudG9TZXJpYWxpemFibGUodCk7cmV0dXJuXFxcIm9iamVjdFxcXCI9PXR5cGVvZiBpJiZ0aGlzLl9jcmVhdGVDaXJjdWxhckNhbmRpZGF0ZSh0LGUsbiksb1tyXT1hLnR5cGUsby5kYXRhPXRoaXMuX2hhbmRsZVZhbHVlKChmdW5jdGlvbigpe3JldHVybiBpfSksZSxuKSxvfSx0LnByb3RvdHlwZS5faGFuZGxlQXJyYXk9ZnVuY3Rpb24odCl7Zm9yKHZhciByPVtdLGU9ZnVuY3Rpb24oZSl7cltlXT1uLl9oYW5kbGVWYWx1ZSgoZnVuY3Rpb24oKXtyZXR1cm4gdFtlXX0pLHIsZSl9LG49dGhpcyxhPTA7YTx0Lmxlbmd0aDthKyspZShhKTtyZXR1cm4gcn0sdC5wcm90b3R5cGUuX2hhbmRsZVBsYWluT2JqZWN0PWZ1bmN0aW9uKHQpe3ZhciByLG4sYT1PYmplY3QuY3JlYXRlKG51bGwpLG89ZnVuY3Rpb24ocil7aWYoUmVmbGVjdC5oYXModCxyKSl7dmFyIG49ZS50ZXN0KHIpP1xcXCIjXFxcIityOnI7YVtuXT1pLl9oYW5kbGVWYWx1ZSgoZnVuY3Rpb24oKXtyZXR1cm4gdFtyXX0pLGEsbil9fSxpPXRoaXM7Zm9yKHZhciB1IGluIHQpbyh1KTt2YXIgcz1udWxsPT09KG49bnVsbD09PShyPW51bGw9PXQ/dm9pZCAwOnQuX19wcm90b19fKXx8dm9pZCAwPT09cj92b2lkIDA6ci5jb25zdHJ1Y3Rvcil8fHZvaWQgMD09PW4/dm9pZCAwOm4ubmFtZTtyZXR1cm4gcyYmXFxcIk9iamVjdFxcXCIhPT1zJiYoYS5jb25zdHJ1Y3Rvcj17bmFtZTpzfSksYX0sdC5wcm90b3R5cGUuX2hhbmRsZU9iamVjdD1mdW5jdGlvbih0LHIsZSl7cmV0dXJuIHRoaXMuX2NyZWF0ZUNpcmN1bGFyQ2FuZGlkYXRlKHQscixlKSxBcnJheS5pc0FycmF5KHQpP3RoaXMuX2hhbmRsZUFycmF5KHQpOnRoaXMuX2hhbmRsZVBsYWluT2JqZWN0KHQpfSx0LnByb3RvdHlwZS5fZW5zdXJlQ2lyY3VsYXJSZWZlcmVuY2U9ZnVuY3Rpb24ocil7dmFyIGU9dGhpcy5jaXJjdWxhckNhbmRpZGF0ZXMuaW5kZXhPZihyKTtpZihlPi0xKXt2YXIgbj10aGlzLmNpcmN1bGFyQ2FuZGlkYXRlc0Rlc2Nyc1tlXTtyZXR1cm4tMT09PW4ucmVmSWR4JiYobi5yZWZJZHg9bi5wYXJlbnQ/Kyt0aGlzLmNpcmN1bGFyUmVmQ291bnQ6MCksdC5fY3JlYXRlUmVmTWFyayhuLnJlZklkeCl9cmV0dXJuIG51bGx9LHQucHJvdG90eXBlLl9oYW5kbGVWYWx1ZT1mdW5jdGlvbih0LHIsZSl7dHJ5e3ZhciBuPXQoKSxhPXR5cGVvZiBuLG89XFxcIm9iamVjdFxcXCI9PT1hJiZudWxsIT09bjtpZihvKXt2YXIgaT10aGlzLl9lbnN1cmVDaXJjdWxhclJlZmVyZW5jZShuKTtpZihpKXJldHVybiBpfXZhciB1PXRoaXMuX2ZpbmRUcmFuc2Zvcm0oYSxuKTtyZXR1cm4gdT90aGlzLl9hcHBseVRyYW5zZm9ybShuLHIsZSx1KTpvP3RoaXMuX2hhbmRsZU9iamVjdChuLHIsZSk6bn1jYXRjaCh0KXt0cnl7cmV0dXJuIHRoaXMuX2hhbmRsZVZhbHVlKChmdW5jdGlvbigpe3JldHVybiB0IGluc3RhbmNlb2YgRXJyb3I/dDpuZXcgRXJyb3IodCl9KSxyLGUpfWNhdGNoKHQpe3JldHVybiBudWxsfX19LHQucHJvdG90eXBlLl9tYWtlVHJhbnNmb3Jtc01hcD1mdW5jdGlvbigpe2lmKG8pe3ZhciB0PW5ldyBNYXA7cmV0dXJuIHRoaXMudHJhbnNmb3Jtcy5mb3JFYWNoKChmdW5jdGlvbihyKXtyLmxvb2t1cCYmdC5zZXQoci5sb29rdXAscil9KSksdH19LHQucHJvdG90eXBlLl9maW5kVHJhbnNmb3JtPWZ1bmN0aW9uKHQscil7aWYobyYmciYmci5jb25zdHJ1Y3RvciYmKG51bGw9PShhPXRoaXMudHJhbnNmb3Jtc01hcC5nZXQoci5jb25zdHJ1Y3RvcikpP3ZvaWQgMDphLnNob3VsZFRyYW5zZm9ybSh0LHIpKSlyZXR1cm4gYTtmb3IodmFyIGU9MCxuPXRoaXMudHJhbnNmb3JtcztlPG4ubGVuZ3RoO2UrKyl7dmFyIGE7aWYoKGE9bltlXSkuc2hvdWxkVHJhbnNmb3JtKHQscikpcmV0dXJuIGF9fSx0LnByb3RvdHlwZS50cmFuc2Zvcm09ZnVuY3Rpb24oKXtmb3IodmFyIHI9dGhpcyxlPVt0aGlzLl9oYW5kbGVWYWx1ZSgoZnVuY3Rpb24oKXtyZXR1cm4gci5yZWZlcmVuY2VzfSksbnVsbCxudWxsKV0sbj0wLGE9dGhpcy5jaXJjdWxhckNhbmRpZGF0ZXNEZXNjcnM7bjxhLmxlbmd0aDtuKyspe3ZhciBvPWFbbl07by5yZWZJZHg+MCYmKGVbby5yZWZJZHhdPW8ucGFyZW50W28ua2V5XSxvLnBhcmVudFtvLmtleV09dC5fY3JlYXRlUmVmTWFyayhvLnJlZklkeCkpfXJldHVybiBlfSx0fSgpLGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQscil7dGhpcy5hY3RpdmVUcmFuc2Zvcm1zU3RhY2s9W10sdGhpcy52aXNpdGVkUmVmcz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMucmVmZXJlbmNlcz10LHRoaXMudHJhbnNmb3JtTWFwPXJ9cmV0dXJuIHQucHJvdG90eXBlLl9oYW5kbGVQbGFpbk9iamVjdD1mdW5jdGlvbih0KXt2YXIgcj1PYmplY3QuY3JlYXRlKG51bGwpO2Zvcih2YXIgbiBpblxcXCJjb25zdHJ1Y3RvclxcXCJpbiB0JiYodC5jb25zdHJ1Y3RvciYmXFxcInN0cmluZ1xcXCI9PXR5cGVvZiB0LmNvbnN0cnVjdG9yLm5hbWV8fCh0LmNvbnN0cnVjdG9yPXtuYW1lOlxcXCJPYmplY3RcXFwifSkpLHQpdC5oYXNPd25Qcm9wZXJ0eShuKSYmKHRoaXMuX2hhbmRsZVZhbHVlKHRbbl0sdCxuKSxlLnRlc3QobikmJihyW24uc3Vic3RyaW5nKDEpXT10W25dLGRlbGV0ZSB0W25dKSk7Zm9yKHZhciBhIGluIHIpdFthXT1yW2FdfSx0LnByb3RvdHlwZS5faGFuZGxlVHJhbnNmb3JtZWRPYmplY3Q9ZnVuY3Rpb24odCxlLG4pe3ZhciBhPXRbcl0sbz10aGlzLnRyYW5zZm9ybU1hcFthXTtpZighbyl0aHJvdyBuZXcgRXJyb3IoXFxcIkNhbid0IGZpbmQgdHJhbnNmb3JtIGZvciBcXFxcXFxcIlxcXCIrYSsnXFxcIiB0eXBlLicpO3RoaXMuYWN0aXZlVHJhbnNmb3Jtc1N0YWNrLnB1c2godCksdGhpcy5faGFuZGxlVmFsdWUodC5kYXRhLHQsXFxcImRhdGFcXFwiKSx0aGlzLmFjdGl2ZVRyYW5zZm9ybXNTdGFjay5wb3AoKSxlW25dPW8uZnJvbVNlcmlhbGl6YWJsZSh0LmRhdGEpfSx0LnByb3RvdHlwZS5faGFuZGxlQ2lyY3VsYXJTZWxmUmVmRHVyaW5nVHJhbnNmb3JtPWZ1bmN0aW9uKHQscixlKXt2YXIgbj10aGlzLnJlZmVyZW5jZXM7T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsZSx7dmFsOnZvaWQgMCxjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdm9pZCAwPT09dGhpcy52YWwmJih0aGlzLnZhbD1uW3RdKSx0aGlzLnZhbH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMudmFsPXR9fSl9LHQucHJvdG90eXBlLl9oYW5kbGVDaXJjdWxhclJlZj1mdW5jdGlvbih0LHIsZSl7dGhpcy5hY3RpdmVUcmFuc2Zvcm1zU3RhY2suaW5jbHVkZXModGhpcy5yZWZlcmVuY2VzW3RdKT90aGlzLl9oYW5kbGVDaXJjdWxhclNlbGZSZWZEdXJpbmdUcmFuc2Zvcm0odCxyLGUpOih0aGlzLnZpc2l0ZWRSZWZzW3RdfHwodGhpcy52aXNpdGVkUmVmc1t0XT0hMCx0aGlzLl9oYW5kbGVWYWx1ZSh0aGlzLnJlZmVyZW5jZXNbdF0sdGhpcy5yZWZlcmVuY2VzLHQpKSxyW2VdPXRoaXMucmVmZXJlbmNlc1t0XSl9LHQucHJvdG90eXBlLl9oYW5kbGVWYWx1ZT1mdW5jdGlvbih0LGUsbil7aWYoXFxcIm9iamVjdFxcXCI9PXR5cGVvZiB0JiZudWxsIT09dCl7dmFyIGE9dFtcXFwiQHJcXFwiXTtpZih2b2lkIDAhPT1hKXRoaXMuX2hhbmRsZUNpcmN1bGFyUmVmKGEsZSxuKTtlbHNlIGlmKHRbcl0pdGhpcy5faGFuZGxlVHJhbnNmb3JtZWRPYmplY3QodCxlLG4pO2Vsc2UgaWYoQXJyYXkuaXNBcnJheSh0KSlmb3IodmFyIG89MDtvPHQubGVuZ3RoO28rKyl0aGlzLl9oYW5kbGVWYWx1ZSh0W29dLHQsbyk7ZWxzZSB0aGlzLl9oYW5kbGVQbGFpbk9iamVjdCh0KX19LHQucHJvdG90eXBlLnRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnZpc2l0ZWRSZWZzWzBdPSEwLHRoaXMuX2hhbmRsZVZhbHVlKHRoaXMucmVmZXJlbmNlc1swXSx0aGlzLnJlZmVyZW5jZXMsMCksdGhpcy5yZWZlcmVuY2VzWzBdfSx0fSgpLGQ9W3t0eXBlOlxcXCJbW05hTl1dXFxcIixzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm5cXFwibnVtYmVyXFxcIj09PXQmJmlzTmFOKHIpfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbigpe3JldHVyblxcXCJcXFwifSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIE5hTn19LHt0eXBlOlxcXCJbW3VuZGVmaW5lZF1dXFxcIixzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCl7cmV0dXJuXFxcInVuZGVmaW5lZFxcXCI9PT10fSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbigpe3JldHVyblxcXCJcXFwifSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKCl7fX0se3R5cGU6XFxcIltbRGF0ZV1dXFxcIixsb29rdXA6RGF0ZSxzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm4gciBpbnN0YW5jZW9mIERhdGV9LHRvU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3JldHVybiB0LmdldFRpbWUoKX0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcj1uZXcgRGF0ZTtyZXR1cm4gci5zZXRUaW1lKHQpLHJ9fSx7dHlwZTpcXFwiW1tSZWdFeHBdXVxcXCIsbG9va3VwOlJlZ0V4cCxzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm4gciBpbnN0YW5jZW9mIFJlZ0V4cH0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHI9e3NyYzp0LnNvdXJjZSxmbGFnczpcXFwiXFxcIn07cmV0dXJuIHQuZ2xvYmFsVGhpcyYmKHIuZmxhZ3MrPVxcXCJnXFxcIiksdC5pZ25vcmVDYXNlJiYoci5mbGFncys9XFxcImlcXFwiKSx0Lm11bHRpbGluZSYmKHIuZmxhZ3MrPVxcXCJtXFxcIikscn0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IFJlZ0V4cCh0LnNyYyx0LmZsYWdzKX19LHt0eXBlOlxcXCJbW0Vycm9yXV1cXFwiLGxvb2t1cDpFcnJvcixzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm4gciBpbnN0YW5jZW9mIEVycm9yfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcixlO3JldHVybiB0LnN0YWNrfHxudWxsPT09KGU9KHI9RXJyb3IpLmNhcHR1cmVTdGFja1RyYWNlKXx8dm9pZCAwPT09ZXx8ZS5jYWxsKHIsdCkse25hbWU6dC5uYW1lLG1lc3NhZ2U6dC5tZXNzYWdlLHN0YWNrOnQuc3RhY2t9fSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyhuW3QubmFtZV18fEVycm9yKSh0Lm1lc3NhZ2UpO3JldHVybiByLnN0YWNrPXQuc3RhY2sscn19LHt0eXBlOlxcXCJbW0FycmF5QnVmZmVyXV1cXFwiLGxvb2t1cDphJiZBcnJheUJ1ZmZlcixzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm4gYSYmciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfSx0b1NlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXt2YXIgcj1uZXcgSW50OEFycmF5KHQpO3JldHVybiBzLmNhbGwocil9LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7aWYoYSl7dmFyIHI9bmV3IEFycmF5QnVmZmVyKHQubGVuZ3RoKTtyZXR1cm4gbmV3IEludDhBcnJheShyKS5zZXQodCkscn1yZXR1cm4gdH19LHt0eXBlOlxcXCJbW1R5cGVkQXJyYXldXVxcXCIsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7aWYoYSlyZXR1cm4gQXJyYXlCdWZmZXIuaXNWaWV3KHIpJiYhKHIgaW5zdGFuY2VvZiBEYXRhVmlldyk7Zm9yKHZhciBlPTAsbz11O2U8by5sZW5ndGg7ZSsrKXt2YXIgaT1vW2VdO2lmKFxcXCJmdW5jdGlvblxcXCI9PXR5cGVvZiBuW2ldJiZyIGluc3RhbmNlb2YgbltpXSlyZXR1cm4hMH1yZXR1cm4hMX0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7cmV0dXJue2N0b3JOYW1lOnQuY29uc3RydWN0b3IubmFtZSxhcnI6cy5jYWxsKHQpfX0sZnJvbVNlcmlhbGl6YWJsZTpmdW5jdGlvbih0KXtyZXR1cm5cXFwiZnVuY3Rpb25cXFwiPT10eXBlb2Ygblt0LmN0b3JOYW1lXT9uZXcgblt0LmN0b3JOYW1lXSh0LmFycik6dC5hcnJ9fSx7dHlwZTpcXFwiW1tNYXBdXVxcXCIsbG9va3VwOm8mJk1hcCxzaG91bGRUcmFuc2Zvcm06ZnVuY3Rpb24odCxyKXtyZXR1cm4gbyYmciBpbnN0YW5jZW9mIE1hcH0sdG9TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7dmFyIHI9W107cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24odCxlKXtyLnB1c2goZSksci5wdXNoKHQpfSkpLHJ9LGZyb21TZXJpYWxpemFibGU6ZnVuY3Rpb24odCl7aWYobyl7Zm9yKHZhciByPW5ldyBNYXAsZT0wO2U8dC5sZW5ndGg7ZSs9MilyLnNldCh0W2VdLHRbZSsxXSk7cmV0dXJuIHJ9Zm9yKHZhciBuPVtdLGE9MDthPHQubGVuZ3RoO2ErPTIpbi5wdXNoKFt0W2VdLHRbZSsxXV0pO3JldHVybiBufX0se3R5cGU6XFxcIltbU2V0XV1cXFwiLGxvb2t1cDppJiZTZXQsc2hvdWxkVHJhbnNmb3JtOmZ1bmN0aW9uKHQscil7cmV0dXJuIGkmJnIgaW5zdGFuY2VvZiBTZXR9LHRvU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe3ZhciByPVtdO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKHQpe3IucHVzaCh0KX0pKSxyfSxmcm9tU2VyaWFsaXphYmxlOmZ1bmN0aW9uKHQpe2lmKGkpe2Zvcih2YXIgcj1uZXcgU2V0LGU9MDtlPHQubGVuZ3RoO2UrKylyLmFkZCh0W2VdKTtyZXR1cm4gcn1yZXR1cm4gdH19XSxwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLnRyYW5zZm9ybXM9W10sdGhpcy50cmFuc2Zvcm1zTWFwPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5zZXJpYWxpemVyPXR8fGYsdGhpcy5hZGRUcmFuc2Zvcm1zKGQpfXJldHVybiB0LnByb3RvdHlwZS5hZGRUcmFuc2Zvcm1zPWZ1bmN0aW9uKHQpe2Zvcih2YXIgcj0wLGU9dD1BcnJheS5pc0FycmF5KHQpP3Q6W3RdO3I8ZS5sZW5ndGg7cisrKXt2YXIgbj1lW3JdO2lmKHRoaXMudHJhbnNmb3Jtc01hcFtuLnR5cGVdKXRocm93IG5ldyBFcnJvcignVHJhbnNmb3JtIHdpdGggdHlwZSBcXFwiJytuLnR5cGUrJ1xcXCIgd2FzIGFscmVhZHkgYWRkZWQuJyk7dGhpcy50cmFuc2Zvcm1zLnB1c2gobiksdGhpcy50cmFuc2Zvcm1zTWFwW24udHlwZV09bn1yZXR1cm4gdGhpc30sdC5wcm90b3R5cGUucmVtb3ZlVHJhbnNmb3Jtcz1mdW5jdGlvbih0KXtmb3IodmFyIHI9MCxlPXQ9QXJyYXkuaXNBcnJheSh0KT90Olt0XTtyPGUubGVuZ3RoO3IrKyl7dmFyIG49ZVtyXSxhPXRoaXMudHJhbnNmb3Jtcy5pbmRleE9mKG4pO2E+LTEmJnRoaXMudHJhbnNmb3Jtcy5zcGxpY2UoYSwxKSxkZWxldGUgdGhpcy50cmFuc2Zvcm1zTWFwW24udHlwZV19cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLmVuY29kZT1mdW5jdGlvbih0KXt2YXIgcj1uZXcgYyh0LHRoaXMudHJhbnNmb3JtcykudHJhbnNmb3JtKCk7cmV0dXJuIHRoaXMuc2VyaWFsaXplci5zZXJpYWxpemUocil9LHQucHJvdG90eXBlLmRlY29kZT1mdW5jdGlvbih0KXt2YXIgcj10aGlzLnNlcmlhbGl6ZXIuZGVzZXJpYWxpemUodCk7cmV0dXJuIG5ldyBsKHIsdGhpcy50cmFuc2Zvcm1zTWFwKS50cmFuc2Zvcm0oKX0sdH0oKTt0LmRlZmF1bHQ9cH0oeik7dmFyIEU9dCYmdC5fX2ltcG9ydERlZmF1bHR8fGZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ZGVmYXVsdDp0fX07Uy5fX2VzTW9kdWxlPSEwLFMuRGVjb2RlPVA9Uy5FbmNvZGU9dm9pZCAwO3ZhciBrPUUoTyksQz1FKHcpLEQ9RShBKSxJPUUoaiksTj1FKHopLFI9W0QuZGVmYXVsdCxDLmRlZmF1bHQsay5kZWZhdWx0LEkuZGVmYXVsdF0seD1uZXcgTi5kZWZhdWx0O3guYWRkVHJhbnNmb3JtcyhSKTt2YXIgUD1TLkVuY29kZT1mdW5jdGlvbih0KXtyZXR1cm4gSlNPTi5wYXJzZSh4LmVuY29kZSh0KSl9O1MuRGVjb2RlPWZ1bmN0aW9uKHQpe3JldHVybiB4LmRlY29kZShKU09OLnN0cmluZ2lmeSh0KSl9LGZ1bmN0aW9uKHIpe3ZhciBlPXQmJnQuX19pbXBvcnREZWZhdWx0fHxmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC5fX2VzTW9kdWxlP3Q6e2RlZmF1bHQ6dH19O3IuX19lc01vZHVsZT0hMDt2YXIgYT1lKG4pLGk9ZShvKSx1PVM7ci5kZWZhdWx0PWZ1bmN0aW9uKHQscixlKXt2b2lkIDA9PT1lJiYoZT0hMCk7Zm9yKHZhciBuPXQsbz17cG9pbnRlcnM6e30sc3JjOntucG06XFxcImh0dHBzOi8vbnBtanMuY29tL3BhY2thZ2UvY29uc29sZS1mZWVkXFxcIixnaXRodWI6XFxcImh0dHBzOi8vZ2l0aHViLmNvbS9zYW1kZW50eTk5L2NvbnNvbGUtZmVlZFxcXCJ9fSxzPWZ1bmN0aW9uKHQpe3ZhciBhPW5bdF07blt0XT1mdW5jdGlvbigpe2EuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBuPVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtzZXRUaW1lb3V0KChmdW5jdGlvbigpe3ZhciBhPWkuZGVmYXVsdCh0LG4pO2lmKGEpe3ZhciBvPWE7ZSYmKG89dS5FbmNvZGUoYSkpLHIobyxhKX19KSl9LG8ucG9pbnRlcnNbdF09YX0sZj0wLGM9YS5kZWZhdWx0O2Y8Yy5sZW5ndGg7ZisrKXMoY1tmXSk7cmV0dXJuIG4uZmVlZD1vLG59fShlKSxyKGUpKHdpbmRvdy5jb25zb2xlLChmdW5jdGlvbih0KXt2YXIgcj1QKHQpO3BhcmVudC5wb3N0TWVzc2FnZSh7dHlwZTpcXFwiY29uc29sZVxcXCIsY29kZXNhbmRib3g6ITAsbG9nOkFycmF5LmlzQXJyYXkocik/clswXTpyLGNoYW5uZWxJZDpzY29wZS5jaGFubmVsSWR9LFxcXCIqXFxcIil9KSk7XFxuXCI7XG5cbmV4cG9ydCB7IEV2ZW50RW1pdHRlciBhcyBFLCBnZXRNZXNzYWdlRnJvbUVycm9yIGFzIGEsIGZpbmRTdGFydFNjcmlwdFBhY2thZ2VKc29uIGFzIGIsIGNvbnNvbGVIb29rIGFzIGMsIGZyb21CdW5kbGVyRmlsZXNUb0ZTIGFzIGYsIGdlbmVyYXRlUmFuZG9tSWQgYXMgZywgcmVhZEJ1ZmZlciBhcyByLCB3cml0ZUJ1ZmZlciBhcyB3IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@codesandbox/sandpack-client/dist/consoleHook-cdbe54ab.mjs\n"));

/***/ })

}]);